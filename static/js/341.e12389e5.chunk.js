(globalThis.webpackChunkjira_assistant=globalThis.webpackChunkjira_assistant||[]).push([[341],{4521:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>y});o(7313);var i=o(816),s=o.n(i),r=o(7446),n=o.n(r),a=o(7174),l=o(9311),c=o(2371),h=o(8933),d=o(7922),u=o(4902),p=o(6444),f=o(4711),g=o(6417);const _="Select an appropriate field for story point in Settings -> General -> Default values tab -> Story point field to enable this option.",v=[{backgroundColor:"#f1c40f4a",borderColor:"#f1c40f",hoverBackgroundColor:"#f1c40f",pointBackgroundColor:"rgba(148,159,177,1)",pointBorderColor:"#fff"},{backgroundColor:"#27ae614a",borderColor:"#27ae61",pointBackgroundColor:"rgba(77,83,96,1)",pointBorderColor:"#fff"},{backgroundColor:"#e84c3d4a",borderColor:"#e84c3d",pointBackgroundColor:"rgba(148,159,177,1)",pointBorderColor:"#fff"},{backgroundColor:"#8f44ad4a",borderColor:"#8f44ad",pointBackgroundColor:"rgba(148,159,177,1)",pointBorderColor:"#fff"},{backgroundColor:"#9a8d2f4a",borderColor:"#9a8d2f",pointBackgroundColor:"rgba(148,159,177,1)",pointBorderColor:"#fff"},{backgroundColor:"#3e95cd94",borderColor:"#3e95cd",hoverBackgroundColor:"#3e95cd",pointBackgroundColor:"rgba(148,159,177,1)",pointBorderColor:"#fff"},{backgroundColor:"#8e5ea27a",borderColor:"#8e5ea2",hoverBackgroundColor:"#8e5ea2",pointBackgroundColor:"rgba(148,159,177,1)",pointBorderColor:"#fff"},{backgroundColor:"#3cba9f7d",borderColor:"#3cba9f",pointBackgroundColor:"rgba(148,159,177,1)",pointBorderColor:"#fff"},{backgroundColor:"#e8c3b987",borderColor:"#e8c3b9",pointBackgroundColor:"rgba(148,159,177,1)",pointBorderColor:"#fff"},{backgroundColor:"#c4585080",borderColor:"#c45850",pointBackgroundColor:"rgba(148,159,177,1)",pointBorderColor:"#fff"},{backgroundColor:"rgba(148,159,177,0.2)",borderColor:"rgba(148,159,177,1)",pointBackgroundColor:"rgba(148,159,177,1)",pointBorderColor:"#fff"}];class m extends l.ZP{constructor(t){super(t,"Estimate vs Actual report","fa fa-list-alt"),this.searchProject=t=>(t=(t||"").toLowerCase(),this.state.projectsList.filter((e=>(e.name.toLowerCase().indexOf(t)>=0||e.key.toLowerCase().startsWith(t)||e.id.toString().startsWith(t))&&(!this.state.projects||!this.state.projects.some((t=>t.id===e.id)))))),this.refreshData=()=>{this.setState({isLoading:!0,chartData:{}});const t=s()(this.state.dateRange.fromDate).startOf("day"),e=s()(this.state.dateRange.toDate).endOf("day"),o=t.toDate(),i=e.toDate(),r=o.getTime(),n=i.getTime(),a=this.state.groups.union((t=>(t.users.forEach((e=>e.groupName=t.name)),t.users))).distinctObj((t=>({name:(0,f.vW)(t,!0),display:t.displayName}))),l=a.map((t=>(0,f.vW)(t))),c=a.map((t=>t.display)),{projects:h}=this.state;let{ticketsList:d}=this.state;d=(d||"").trim().replace(/[\s;]/g,","),this.chartWidth=250*l.length;const u=d?d.split(",").filter((t=>!!t)):[];let g=`(worklogAuthor in ("${l.join('","')}") and worklogDate >= '${t.clone().add(-1,"days").format("YYYY-MM-DD")}' and worklogDate < '${e.clone().add(1,"days").format("YYYY-MM-DD")}') `,_="",v=h&&h.length>0;const m=u.length>0;if(v&&(_+=`project in (${h.map((t=>t.key)).join(",")}) `),m){_&&(_+=" or ");const t=u.join(",");_+=`key in (${t}) or parent in (${t})`}return _&&(g+=` and (${_})`),this.$jira.searchTickets(g,["worklog","project","parent",this.state.estimationField]).then((t=>{this.$analytics.trackEvent("Estimate report viewed",p.Jk.UserActions);const e=t.flattern({key:!0,projectName:"fields.project.name",projectKey:"fields.project.key",parentkey:"fields.parent.key",estimate:t=>{let e=t.fields[this.state.estimationField];return"timeoriginalestimate"===this.state.estimationField?e=e/60/60:this.state.storyPointHour&&(e*=this.state.storyPointHour),e},"~~worklog":{field:"fields.worklog.worklogs",spread:!1,props:{"...author":function(t){return(0,f.vW)(t.author,!0)},date:function(t){return t.started?new Date(t.started):null},"...yyyyMMdd":function(t){return t.started?parseInt(new Date(t.started).format("yyyyMMdd")):null},timespent:function(t){return t.timeSpentSeconds/60/60}}}},(t=>l.includes(t.author)&&t.worklog.date.isBetween(r,n)));if("timeoriginalestimate"!==this.state.estimationField){let t=e.distinct((t=>t.parentkey));if(t=t.filter((t=>t&&!e.some((e=>e.key===t)))),t.length)return this.$jira.searchTickets(`key in (${t.join(",")})`,["project",this.state.estimationField]).then((t=>{const o=t.flattern({key:!0,projectName:"fields.project.name",projectKey:"fields.project.key",estimate:t=>{let e=t.fields[this.state.estimationField];return"timeoriginalestimate"===this.state.estimationField?e=e/60/60:this.state.storyPointHour&&(e*=this.state.storyPointHour),e}}).reduce(((t,e)=>(t[e.key]=e,t)),{});return e.forEach((t=>{const{parentkey:i,key:s}=t;if((!m||!u.includes(s))&&i){let s=o[i];s||(s=e.first((t=>t.key===i)),o[i]=s),t.key=i,delete t.parentkey,t.estimate=s.estimate}})),e}))}return e})).then((t=>{let e=this.state.projects;v||m||(v=!0,e=t.distinctObj((t=>({key:t.projectKey,name:t.projectName}))));const o=[];let i=-1;v&&e.forEach((e=>{i++;const s=t.filter((t=>t.projectKey.toUpperCase()===e.key.toUpperCase()&&(!m||!u.includes(t.key)))),r=[],n=[],a={label:`${e.name} (estimate)`,data:r,...this.chartColours[i]};i++;const c={label:`${e.name} (spent)`,data:n,...this.chartColours[i]};l.forEach((t=>{const e=s.filter((e=>e.author===t)).groupBy((t=>t.key)),o=e.sum((t=>t.values[0].estimate)),i=e.sum((t=>t.values.sum((t=>t.worklog.timespent))));r.push(o),n.push(i)})),o.push(a),o.push(c)})),m&&((t=t.filter((t=>u.includes(t.parentkey)||u.includes(t.key)))).forEach((t=>{u.includes(t.key)||(t.key=t.parentkey)})),t.groupBy((t=>t.key)).forEach((t=>{const e=t.values,i=[],s=[],r={label:`${t.key} (estimate)`,data:i},n={label:`${t.key} (spent)`,data:s};l.forEach((t=>{const o=e.filter((e=>e.author===t)).groupBy((t=>t.key));let r=o.sum((t=>t.values[0].estimate)),n=o.sum((t=>t.values.sum((t=>t.worklog.timespent))));r||(r=null),n||(n=null),i.push(r),s.push(n)})),o.push(r),o.push(n)}))),this.setState({disableRefresh:!1,isLoading:!1,chartData:{labels:c,datasets:o,colors:this.chartColours},selectedTab:1})}))},this.showGroupsPopup=()=>this.setState({showGroupsPopup:!0}),this.groupsChanged=t=>this.setState({showGroupsPopup:!1,groups:t||this.state.groups||[]}),this.onDateChange=t=>this.setState({dateRange:t.date}),this.tabChanged=t=>this.setState({selectedTab:t.index}),this.setChartRef=t=>this.chart=t,(0,a.f3)(this,"SessionService","JiraService","UserGroup","AnalyticsService"),this.hideMenu=!0,this.isGadget=!1,this.chartOptions={animation:!1,maintainAspectRatio:!1,title:{display:!0,text:"Estimate vs Actual"},tooltips:{mode:"index"},scales:{xAxes:[{stacked:!1,ticks:{stepSize:1,min:0,autoSkip:!1},categoryPercentage:1,barPercentage:1,barThickness:"flex"}]}},this.chartColours=v.union((t=>[Object.assign({},t,{hoverBackgroundColor:t.borderColor}),Object.assign({},t,{hoverBackgroundColor:n().draw("zigzag",t.backgroundColor),backgroundColor:n().draw("zigzag",t.borderColor)})])),this.storyPointField=(this.$session.CurrentUser.storyPointField||{}).id,this.state={groups:[],disableRefresh:!0,dateRange:{},chartData:{},estimationField:"timeoriginalestimate",projects:this.$session.CurrentUser.projects}}componentDidMount(){super.componentDidMount(),this.$usergroup.getUserGroups().then((t=>this.setState({groups:t||[]}))),this.$jira.getProjects().then((t=>{t=t.map((t=>({name:t.name,key:t.key,id:t.id}))).orderBy((t=>t.name)),this.setState({projectsList:t})}))}resizeChart(t){t*=100;const e=this.chart.getCanvas();let o=parseInt(e.style.width.replace("px",""));o>0?o>this.chartWidth&&(o=this.chartWidth):o=500,o+=t,e.parentNode.style.width=`${o}px`}validateData(){const{dateRange:t,groups:e}=this.state;return!(null!==t&&void 0!==t&&t.fromDate)||!(null!==e&&void 0!==e&&e.length)}render(){const{storyPointField:t,chartOptions:e,state:{projectsList:o,projects:i,ticketsList:s,groups:r,estimationField:n,storyPointHour:a,dateRange:l,chartData:p,showGroupsPopup:f,selectedTab:v}}=this;return super.renderBase((0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(c.TabView,{activeIndex:v,onTabChange:this.tabChanged,children:[(0,g.jsxs)(c.TabPanel,{header:"Settings",children:[(0,g.jsxs)("div",{className:"pad-15",children:[(0,g.jsx)("strong",{children:"How to use:"})," To generate the estimate vs actual report follow the below steps",(0,g.jsxs)("ul",{children:[(0,g.jsx)("li",{children:"User list: Select the list of users for whom report need to be generated."}),(0,g.jsx)("li",{children:"Date range: Select the date range for which worklog details need to be fetched from jira"}),(0,g.jsx)("li",{children:"Projects: Select one or more projects to be displayed for each users. To auto populate this field, go to Settings -> General -> Default values tab and provide the value for projects field."}),(0,g.jsx)("li",{children:"Tickets list: Add one or more tickets seperated by comma. These tickets will be listed seperately for comparison."}),(0,g.jsx)("li",{children:"Estimate type: Estimation comparison can be done based on Time estimate or Story Point estimate. If story point is selected, then optionally hours per story point can be configured to convert story point to estimated hours."}),(0,g.jsxs)("li",{children:[(0,g.jsx)("b",{children:"Note:"})," If Story Point option under Estimate type is disabled, then go to SETTINGS -> General -> Default values (tab) and select appropriate field for Story Points"]})]})]}),(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{className:"row",children:[(0,g.jsx)("div",{className:"col-sm-12 col-md-2 col-lg-2",children:(0,g.jsx)("strong",{children:"* User list"})}),(0,g.jsx)("div",{className:"col-sm-12 col-md-4 col-lg-4 col-xl-3",children:(0,g.jsx)("div",{className:"form-group",children:(0,g.jsx)("span",{className:"link",onClick:this.showGroupsPopup,children:"Add / remove users"})})}),(0,g.jsx)("div",{className:"col-sm-12 col-md-2 col-lg-2",children:(0,g.jsx)("strong",{children:"* Date range"})}),(0,g.jsx)("div",{className:"col-sm-12 col-md-4 col-lg-4 col-xl-3",children:(0,g.jsx)("div",{className:"form-group",children:(0,g.jsx)(h.Mt,{range:!0,value:l,onChange:t=>this.setState({dateRange:t}),width:200})})})]}),(0,g.jsxs)("div",{className:"row",children:[(0,g.jsx)("div",{className:"col-sm-12 col-md-2 col-lg-2",children:(0,g.jsx)("strong",{children:"Projects"})}),(0,g.jsx)("div",{className:"col-sm-12 col-md-5 col-lg-4 col-xl-3",children:(0,g.jsx)("div",{className:"form-group",children:(0,g.jsx)(h.Qc,{value:i,onChange:t=>this.setState({projects:t}),disabled:!o,dropdown:!0,multiple:!0,forceselection:!0,displayField:"name",placeholder:"add one or more projects",dataset:this.searchProject,size:35,autohighlight:!0,maxLength:25,className:"autocomplete-350"})})}),(0,g.jsx)("div",{className:"col-sm-12 col-md-2 col-lg-2",children:(0,g.jsx)("strong",{children:"Tickets List"})}),(0,g.jsx)("div",{className:"col-sm-12 col-md-5 col-lg-4 col-xl-3",children:(0,g.jsx)("div",{className:"form-group",children:(0,g.jsx)(h.zC,{multiline:!0,value:s,onChange:t=>this.setState({ticketsList:t}),placeholder:"List of tickets to be viewed seperated by comma"})})})]}),(0,g.jsxs)("div",{className:"row",children:[(0,g.jsx)("div",{className:"col-sm-12 col-md-2 col-lg-2",children:(0,g.jsx)("strong",{children:"* Estimate type"})}),(0,g.jsx)("div",{className:"col-sm-12 col-md-5 col-lg-4 col-xl-3",children:(0,g.jsxs)("div",{className:"form-group estimate-type",children:[(0,g.jsx)(h.EU,{name:"estimateType",onChange:t=>this.setState({estimationField:t}),defaultValue:"timeoriginalestimate",value:n,label:"Time estimate"}),(0,g.jsx)(h.EU,{name:"estimateType",defaultValue:t,value:n,label:"Story Point",title:t?"":_,onChange:t=>this.setState({estimationField:t}),disabled:!t}),!t&&(0,g.jsx)("span",{className:"fa fa-question-circle",title:_})]})}),n===t&&(0,g.jsx)("div",{className:"col-sm-12 col-md-2 col-lg-2",children:(0,g.jsx)("strong",{children:"Hours per Story point"})}),n===t&&(0,g.jsx)("div",{className:"col-sm-12 col-md-5 col-lg-4 col-xl-3",children:(0,g.jsx)("div",{className:"form-group",children:(0,g.jsx)(h.zC,{value:a,onChange:t=>this.setState({storyPointHour:t}),maxLength:5,keyfilter:"num",placeholder:"Specify hours per story point in average"})})})]}),(0,g.jsx)("div",{className:"row",children:(0,g.jsx)("div",{className:"col-sm-12 col-md-3 col-lg-3 col-xl-2",children:(0,g.jsx)(h.zx,{className:"col-button-primary",disabled:this.validateData(),icon:"fa fa-play-circle",label:"Generate report",onClick:this.refreshData})})})]})]}),(0,g.jsx)(c.TabPanel,{header:"Chart",disabled:!p.datasets,children:(0,g.jsxs)("div",{className:"chart-container",children:[(0,g.jsxs)("div",{className:"magnifier",children:[(0,g.jsx)("i",{className:"fa fa-search-minus",onClick:()=>this.resizeChart(-1),title:"Decrease the width of the chart"}),(0,g.jsx)("i",{className:"fa fa-search-plus",onClick:()=>this.resizeChart(1),title:"Increase the width of the chart"})]}),(0,g.jsx)("div",{className:"canvas-block",children:(0,g.jsx)("div",{className:"canvas-container",children:(0,g.jsx)(d.Chart,{ref:this.setChartRef,className:"chart",type:"bar",data:p,options:e})})})]})})]}),f&&(0,g.jsx)(u.Z,{groups:r,onHide:this.groupsChanged})]}))}}const y=m},7446:function(t){t.exports=function(){"use strict";var t="rgba(100, 100, 100, 0.7)",e="rgba(255, 255, 255, 0.8)",o="round",i=(function(){function t(t){this.value=t}function e(e){var o,i;function s(t,e){return new Promise((function(s,n){var a={key:t,arg:e,resolve:s,reject:n,next:null};i?i=i.next=a:(o=i=a,r(t,e))}))}function r(o,i){try{var s=e[o](i),a=s.value;a instanceof t?Promise.resolve(a.value).then((function(t){r("next",t)}),(function(t){r("throw",t)})):n(s.done?"return":"normal",s.value)}catch(l){n("throw",l)}}function n(t,e){switch(t){case"return":o.resolve({value:e,done:!0});break;case"throw":o.reject(e);break;default:o.resolve({value:e,done:!1})}(o=o.next)?r(o.key,o.arg):i=null}this._invoke=s,"function"!==typeof e.return&&(this.return=void 0)}"function"===typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)}}(),function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}),s=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])}return t},n=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e},l=function(){function r(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return i(this,r),this._canvas=document.createElement("canvas"),this._context=this._canvas.getContext("2d"),this._canvas.width=o,this._canvas.height=o,this._context.fillStyle=s,this._context.fillRect(0,0,this._canvas.width,this._canvas.height),this._size=o,this._patternColor=n,this}return s(r,[{key:"setStrokeProps",value:function(){this._context.strokeStyle=this._patternColor,this._context.lineWidth=this._size/10,this._context.lineJoin=o,this._context.lineCap=o}},{key:"setFillProps",value:function(){this._context.fillStyle=this._patternColor}}]),r}(),c=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){var t=this._size/2;return this._context.beginPath(),this.setStrokeProps(),this.drawPlus(),this.drawPlus(t,t),this._context.stroke(),this._canvas}},{key:"drawPlus",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this._size,i=o/2,s=o/4;this._context.moveTo(s+t,0+e),this._context.lineTo(s+t,i+e),this._context.moveTo(0+t,s+e),this._context.lineTo(i+t,s+e),this._context.closePath()}}]),e}(l),h=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){var t=this._size/2;return this._context.beginPath(),this.setStrokeProps(),this.drawCross(),this.drawCross(t,t),this._context.stroke(),this._canvas}},{key:"drawCross",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this._size/2,i=2;this._context.moveTo(t+i,e+i),this._context.lineTo(o-i+t,o-i+e),this._context.moveTo(t+i,o-i+e),this._context.lineTo(o-i+t,e+i),this._context.closePath()}}]),e}(l),d=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){var t=this._size/2;return this._context.beginPath(),this.setStrokeProps(),this.drawDash(),this.drawDash(t,t),this._context.stroke(),this._canvas}},{key:"drawDash",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this._size/2,i=2;this._context.moveTo(t+i,e+i),this._context.lineTo(o-i+t,o-i+e),this._context.closePath()}}]),e}(l),u=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){var t=this._size/2;return this._context.beginPath(),this.setStrokeProps(),(new h).drawCross.call(this),(new d).drawDash.call(this,t,t),this._context.stroke(),this._canvas}}]),e}(l),p=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){var t=this._size/2;return this._context.beginPath(),this.setFillProps(),this.drawDot(),this.drawDot(t,t),this._context.fill(),this._canvas}},{key:"drawDot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._size/10,i=this._size/4,s=i+t,r=i+e;this._context.moveTo(s+i,r),this._context.arc(s,r,o,0,2*Math.PI),this._context.closePath()}}]),e}(l),f=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){var t=this._size/2;return this._context.beginPath(),this.setStrokeProps(),(new d).drawDash.call(this,t,t),this._context.closePath(),this._context.stroke(),this.setFillProps(),(new p).drawDot.call(this),this._context.fill(),this._canvas}}]),e}(l),g=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){var t=this._size/2,e=this._size/5;return this._context.beginPath(),this.setFillProps(),this.drawDot(0,0,e),this.drawDot(t,t,e),this._context.fill(),this._canvas}}]),e}(p),_=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){var t=this._size/2,e=this._size/5;return this._context.beginPath(),this.setStrokeProps(),this.drawDot(0,0,e),this.drawDot(t,t,e),this._context.stroke(),this._canvas}}]),e}(p),v=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){var t=this._size/2;return this._context.beginPath(),this.setStrokeProps(),this.drawLine(),this.drawLine(t,t),this._context.stroke(),this._canvas}},{key:"drawLine",value:function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=this._size/4;this._context.moveTo(0,e+t),this._context.lineTo(this._size,e+t),this._context.closePath()}}]),e}(l),m=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){return this._context.translate(this._size,0),this._context.rotate(90*Math.PI/180),v.prototype.drawTile.call(this),this._canvas}}]),e}(v),y=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){return this._context.beginPath(),this.setStrokeProps(),this.drawWeave(0,0),this._context.stroke(),this._canvas}},{key:"drawWeave",value:function(t,e){var o=this._size,i=o/2;this._context.moveTo(t+1,e+1),this._context.lineTo(i-1,i-1),this._context.moveTo(i+1,o-1),this._context.lineTo(o-1,i+1),this._context.closePath()}}]),e}(l),x=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){return this._context.beginPath(),this.setStrokeProps(),this.drawZigzag(),this.drawZigzag(this._size/2),this._context.stroke(),this._canvas}},{key:"drawZigzag",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this._size,o=e/4,i=e/2,s=e/10;this._context.moveTo(0,s+t),this._context.lineTo(o,i-s+t),this._context.lineTo(i,s+t),this._context.lineTo(e-o,i-s+t),this._context.lineTo(e,s+t)}}]),e}(l),k=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){return this._context.translate(this._size,0),this._context.rotate(90*Math.PI/180),x.prototype.drawTile.call(this),this._canvas}}]),e}(x),b=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){var t=this._size/2;return this._context.beginPath(),this.setStrokeProps(),this.drawDiagonalLine(),this.drawDiagonalLine(t,t),this._context.stroke(),this._canvas}},{key:"drawDiagonalLine",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this._size,i=o/2,s=1;this._context.moveTo(i-s-t,-1*s+e),this._context.lineTo(o+1-t,i+1+e),this._context.closePath()}}]),e}(l),w=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){return this._context.translate(this._size,0),this._context.rotate(90*Math.PI/180),b.prototype.drawTile.call(this),this._canvas}}]),e}(b),j=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){var t=this._size/2;return this._context.beginPath(),this.setFillProps(),this.drawSquare(),this.drawSquare(t,t),this._context.fill(),this._canvas}},{key:"drawSquare",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this._size,i=o/2,s=o/20;this._context.fillRect(t+s,e+s,i-2*s,i-2*s),this._context.closePath()}}]),e}(l),P=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){var t=this._size/2;return this._context.beginPath(),this.setStrokeProps(),this.drawBox(),this.drawBox(t,t),this._context.stroke(),this._canvas}},{key:"drawBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this._size,i=o/2,s=o/20;this._context.strokeRect(t+s,e+s,i-4*s,i-4*s),this._context.closePath()}}]),e}(l),C=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){var t=this._size/2;return this._context.beginPath(),this.setFillProps(),this.drawTriangle(),this.drawTriangle(t,t),this._context.fill(),this._canvas}},{key:"drawTriangle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this._size,i=o/2,s=o/4;this._context.moveTo(s+t,e),this._context.lineTo(i+t,i+e),this._context.lineTo(t,i+e),this._context.closePath()}}]),e}(l),T=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){var t=this._size;return this._context.translate(t,t),this._context.rotate(180*Math.PI/180),C.prototype.drawTile.call(this),this._canvas}}]),e}(C),z=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){var t=this._size/2;return this._context.beginPath(),this.setFillProps(),this.drawDiamond(),this.drawDiamond(t,t),this._context.fill(),this._canvas}},{key:"drawDiamond",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this._size,i=o/2,s=o/4;this._context.moveTo(s+t,e),this._context.lineTo(i+t,s+e),this._context.lineTo(s+t,i+e),this._context.lineTo(t,s+e),this._context.closePath()}}]),e}(l),O=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return n(e,t),s(e,[{key:"drawTile",value:function(){var t=this._size/2;return this._context.beginPath(),this.setStrokeProps(),this.drawDiamond(),this.drawDiamond(t,t),this._context.stroke(),this._canvas}},{key:"drawDiamond",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this._size,i=o/2-1,s=o/4;this._context.moveTo(s+t,e+1),this._context.lineTo(i+t,s+e),this._context.lineTo(s+t,i+e),this._context.lineTo(t+1,s+e),this._context.closePath()}}]),e}(z),S={plus:c,cross:h,dash:d,"cross-dash":u,dot:p,"dot-dash":f,disc:g,ring:_,line:v,"line-vertical":m,weave:y,zigzag:x,"zigzag-vertical":k,diagonal:b,"diagonal-right-left":w,square:j,box:P,triangle:C,"triangle-inverted":T,diamond:z,"diamond-box":O},D={circle:S.disc,"triangle-vertical":S["triangle-inverted"],"line-horizontal":S.line,"line-diagonal-lr":S.diagonal,"line-diagonal-rl":S["diagonal-right-left"],"zigzag-horizontal":S.zigzag,"diamond-outline":S["diamond-box"]},N=[];function B(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=Object.keys(S);t.forEach((function(t){e.splice(e.indexOf(t),1)}));var o=Math.floor(Math.random()*e.length);return e[o]}function E(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"square",e=arguments[1],o=arguments[2],i=arguments[3],s=document.createElement("canvas"),r=s.getContext("2d"),n=2*i,a=new(0,N[t])(i,e,o),l=r.createPattern(a.drawTile(),"repeat");return s.width=n,s.height=n,l.shapeType=t,l}function F(t){var e=void 0,o=void 0;return t.map((function(t,i,s){var r=void 0;return 0===i?(r=B(),e=o=r):i===s.length-1?r=B([o,e]):(r=B([o]),o=r),E(r,t)}))}return r(N,S,D),{draw:E,generate:F}}()}}]);