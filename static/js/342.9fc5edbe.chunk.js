"use strict";(globalThis.webpackChunkjira_assistant=globalThis.webpackChunkjira_assistant||[]).push([[342],{374:(e,t,s)=>{s.d(t,{A:()=>l,h:()=>n});var i=s(3302),o=s(9264),a=s.n(o),r=s(1219);class n{constructor(){const e=new(a().Workbook);e.created=new Date,e.creator="Jira Assistant",e.lastModifiedBy="Jira Assistant",this.document=e}addTable(e){e=i(e);const t=this.normalizeSheetName(e.attr("export-sheet-name"));console.log("Exporting ",t),this.worksheet=this.document.addWorksheet(t),this.sheetOptions={mergeCells:[],width:{},styles:[],rowsToRemove:[],rowsToHide:[]},this.curRowNum=1;const s=e.find("> thead:not([exportignore]) > tr:not([exportignore])");this.prepareData(s),console.log("header rows",s.length);const o=e.find("> tbody:not([exportignore]) > tr:not([exportignore])");this.prepareData(o),console.log("bodyRows rows",o.length),this.worksheet.views=[{state:"frozen",xSplit:0,ySplit:s.length}],this.sheetOptions.mergeCells.forEach(e=>this.worksheet.mergeCells(e));const a=this.sheetOptions.width;Object.keys(a).forEach(e=>{const t=this.worksheet.getColumn(e),s=parseFloat(a[e])/7.178;t.width=s}),this.sheetOptions.styles.forEach(e=>{const t=this.worksheet.getCell(e.key),s=e.style,i={};"left"!==s.textAlign&&(i.horizontal=s.textAlign),"left"!==s.verticalAlign&&(i.vertical=s.verticalAlign),t.alignment=i;const o=s.fontWeight||"";t.style.font={size:this.getFontSize(s.fontSize),bold:o.indexOf("bold")>-1||o>=550}}),this.sheetOptions.rowsToHide.forEach(e=>this.worksheet.getRow(e).hidden=!0),this.sheetOptions.rowsToRemove.orderByDescending().forEach(e=>this.worksheet.spliceRows(e,1)),this.worksheet=null,this.sheetOptions=null,this.curRowNum=null}normalizeSheetName(e){return e?e.replace(/\[/g,"(").replace(/\]/g,")").replace(/:/g,"-").replace(/[?/\\]/g,""):e}trim(e){return e.replace(/^\s+|\s+$/gm,"")}getFontSize(e){return e?e.endsWith("px")?.75*parseInt(e.replace("px",""),10):e.endsWith("pt")?parseInt(e.replace("pt",""),10):e.endsWith("em")?.0833333*parseInt(e.replace("em",""),10):void 0:e}rgbaToHex(e){if(!e)return e;const t=e.substring(e.indexOf("(")).split(","),s=parseInt(this.trim(t[0].substring(1)),10),i=parseInt(this.trim(t[1]),10),o=parseInt(this.trim(t[2]),10);t[3]=t[3]||"1)";const a=parseFloat(this.trim(t[3].substring(0,t[3].length-1))).toFixed(2);return this.fixSize(s.toString(16))+this.fixSize(i.toString(16))+this.fixSize(o.toString(16))+this.fixSize((255*a).toString(16).substring(0,2))}fixSize(e){return 1===e.length?`0${e}`:e}prepareData(e){const t=this.worksheet,s=[];e.each((e,o)=>{o=i(o);const a=this.getColArray(o,s);if(a){t.addRow(a).commit(),this.curRowNum++}})}getColArray(e,t){const s=e.find("> th, > td"),o=[],a=!!e.attr("exportignore");return a&&this.sheetOptions.rowsToRemove.push(this.curRowNum),e.attr("exporthidden")&&this.sheetOptions.rowsToHide.push(this.curRowNum),s.each((e,s)=>{for(;t[o.length]>0;)t[o.length]=t[o.length]-1,o[o.length]=null;let r=(s=i(s)).attr("exportValue");if(r||(r=s.text()),r&&!a){r=r.trim();switch(s.attr("exportType")){case"int":r=function(e){if(!e)return e;const t=parseInt(e,10);return isNaN(t)?e:t}(r);break;case"float":case"number":r=function(e){if(!e)return e;const t=parseFloat(e);return isNaN(t)?e:t}(r);break;case"date":r=d(r,!0);break;case"datetime":r=d(r,!1)}}o[o.length]=r;let n=s.attr("colspan")||1;const l=(s.attr("rowspan")||1)-1;l&&(t[o.length-1]=l);const c=this.numToChar(o.length),h=this.curRowNum;if(n>1||l>0){const e=this.numToChar(o.length+(n-1)),t=this.curRowNum+l;this.sheetOptions.mergeCells.push(`${c+h}:${e}${t}`)}if(!a){if(!n||n<2){const e=s.width();e>20&&(this.sheetOptions.width[c]=e)}this.sheetOptions.styles.push({key:c+h,style:window.getComputedStyle(s.get(0),null)})}for(;n>1;)n-=1,o[o.length]=null,l&&(t[o.length-1]=l)}),o}export(e){this.document.xlsx.writeBuffer().then(t=>{const s=new Blob([t],{type:"application/octet-stream"});(0,r.Uh)(s,`${e}.xlsx`)})}charToNum(e){for(let t=0,s=1;t<s;t++,s++)e==this.numToChar(t)&&(s=t)}numToChar(e){const t=(e-1)%26,s=this.chr(65+t),i=parseInt((e-1)/26,10);return i>0?this.numToChar(i)+s:s}chr(e){return e>65535?(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e))):String.fromCharCode(e)}}const l={XLSX:"XLSX",CSV:"CSV",PDF:"PDF"};function d(e,t){if(!e)return e;const s=new Date(e);return isNaN(s.getTime())?e:s}},530:(e,t,s)=>{s.d(t,{Ls:()=>d,O0:()=>l,tz:()=>c});var i=s(9950),o=s(3023),a=s(2519),r=s(4414);let n=()=>{};function l(e,t){e.preventDefault&&e.preventDefault(),n(e,t)}function d(){n()}class c extends i.PureComponent{constructor(...e){super(...e),this.state={contextItems:[]},this.setMenuRef=e=>this.menu=e,this.setContextMenuRef=e=>this.contextMenu=e}componentDidMount(){n=(e,t)=>{var s;if(!e)return this.menu.hide({}),void this.contextMenu.hide({});const i="contextmenu"===e.type;i||(t=t.filter(e=>!e.disabled||!e.items||0===e.items.length)),null!==(s=this.state.contextItems)&&void 0!==s&&s.length&&this.state.contextItems===t||this.setState({contextItems:t}),i?(this.menu.hide({}),this.contextMenu.show(e)):(this.contextMenu.hide({}),this.menu.toggle(e))}}render(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.W,{appendTo:document.body,model:this.state.contextItems,popup:!0,ref:this.setMenuRef}),(0,r.jsx)(a.t,{appendTo:document.body,model:this.state.contextItems,popup:!0,ref:this.setContextMenuRef})]})}}},975:(e,t,s)=>{s.d(t,{A:()=>b,m:()=>r});var i=s(5620),o=s(2813),a=s(9786);function r(e,t,s){if(!e)return null;const{icon:i,name:o}=e;return{name:o,id:`D-${t}`,url:`/${s}/dashboard/${t}`,icon:i,isDashboard:!0}}const{dashboards:n,calendar:l,importWorklog:d,importIssues:c,planningPoker:h,worklogReport:u,sprintReport:p,customReport:m,estimateVsActual:g,pivotReport:f,sayDoRatioReport:x,userGroups:v,generalSettings:y,advancedSettings:k,activitiesGroup:j=l||d||c||h,reportsGroup:w=u||x||p||m||g,settingsGroup:S=v||y||k}=a.A.modules,b=[n&&{title:!0,name:"Dashboards",isDashboard:!0,items:[{name:"Default",id:"D-0",url:"/dashboard/0",icon:"fa fa-tachometer",isDashboard:!0}]},j&&{title:!0,name:"Activities",items:[l&&{name:"Worklog Calendar",id:"CAL",url:"/calendar",icon:"fa fa-calendar"},d&&{name:"Import worklog",id:"IMW",url:"/import/worklog",icon:"fa fa-clock"},c&&{name:"Import issue",id:"IMI",url:"/import/issue",icon:"fa fa-ticket",badge:{variant:"success",text:"BETA"}},h&&{name:"Poker",id:"PLP",external:!i.mx,url:i.eD?`${o.V5}/poker`:(0,i.B2)(i.zM?"/../poker":"/poker"),icon:"fa fa-gamepad"}].filter(Boolean)},w&&{title:!0,name:"Reports",items:[u&&{name:"Worklog Report",id:"R-WL",url:"/reports/worklog",icon:"fa fa-users"},f&&{name:"Pivot Report",id:"R-PR",url:"/reports/pivot",icon:"fa fa-table",badge:{variant:"success",text:"BETA"}},x&&{name:"Say-Do Ratio",id:"R-SDR",url:"/reports/say-do-ratio",icon:"fa fa-chart-line"},p&&{name:"Sprint Report",id:"R-SP",url:"/reports/sprint",icon:"fa fa-history"},m&&{name:"Custom Report",id:"R-CR",url:"/reports/custom",icon:"fa fa-table"},g&&{name:"Estimate vs Actual",id:"R-EA",url:"/reports/estimateactual",icon:"fa fa-bar-chart"}].filter(Boolean)},S&&{title:!0,name:"Settings",items:[y&&{name:"General",id:"S-GE",url:"/settings/general",icon:"fa fa-cog"},v&&{name:"User groups",id:"S-UG",url:"/settings/usergroups",icon:"fa fa-users"},k&&{name:"Advanced",id:"S-AD",url:"/settings/global",icon:"fa fa-cogs"}].filter(Boolean)}].filter(Boolean)},1427:(e,t,s)=>{s.d(t,{VP:()=>f,QC:()=>m,ew:()=>h,vc:()=>p,D1:()=>u,lO:()=>g});var i=s(9950),o=s(8738),a=s.n(o),r=s(8981),n=s(4414);const l=(0,i.createContext)({}),d="sortChanged",c="dataChanged";class h extends i.PureComponent{constructor(e){super(e),this.sharedProps={getData:()=>this.state.dataset,sortBy:e=>{let{isDesc:t}=this.state;if(t=e===this.state.sortBy&&!t,!e)return this.state.sortBy;{let{dataset:s}=this.state;if(s){let i=!1;this.props.onSort&&(i=this.props.onSort(e,t)),i||(s=s.sortBy(e,t),this.setState({dataset:s,sortBy:e,isDesc:t}),this.eventEmitter.emit(d,e,t))}}},getSortedField:()=>{const{sortBy:e,isDesc:t}=this.state;return{sortBy:e,isDesc:t}},onDataChanged:e=>(this.eventEmitter.on(c,e),()=>this.eventEmitter.off(c,e)),onSortFieldChanged:e=>(this.eventEmitter.on(d,e),()=>this.eventEmitter.off(d,e)),getScrollTop:()=>{var e;return(null===(e=this.container)||void 0===e?void 0:e.scrollTop)||0}},this.setContainer=e=>this.container=e,this.eventEmitter=new r.EventEmitter,this.eventEmitter.setMaxListeners(400),this.actualDataset=e.dataset,this.state={dataset:e.dataset,sortBy:e.sortBy,isDesc:e.isDesc}}UNSAFE_componentWillReceiveProps(e){const{dataset:t,sortBy:s,isDesc:i}=e;t!==this.actualDataset&&(this.actualDataset=t,this.setState({dataset:t,sortBy:s,isDesc:i}),this.eventEmitter.emit(c,e.dataset)),s===this.state.sortBy&&i===this.state.isDesc||(this.setState({dataset:t,sortBy:s,isDesc:i}),this.eventEmitter.emit(d,s,i))}render(){const{className:e,style:t,children:s,exportable:i,exportSheetName:o,height:r,containerStyle:d}=this.props;return(0,n.jsx)("div",{className:a()("scroll-table-container",e),style:d||{height:r},ref:this.setContainer,children:(0,n.jsx)(l.Provider,{value:this.sharedProps,children:(0,n.jsx)("table",{ref:e=>this.table=e,"export-sheet-name":o,className:a()("scroll-table",e,!1!==i?"exportable":null),style:t,children:s})})})}}class u extends i.PureComponent{constructor(...e){super(...e),this.state={},this.setRef=e=>this.el=e}componentDidMount(){this.componentDidUpdate()}componentDidUpdate(){this.el.querySelectorAll("tr:not(:first-child)").forEach((e,t)=>{const s=e.querySelectorAll("th");this.setScrollTop(s,31*(t+1))})}setScrollTop(e,t){const s=this.context.getScrollTop();e.forEach(e=>{const i=e.offsetTop&&s&&e.offsetTop>s?e.offsetTop-s:e.offsetTop;e.style.top=`${i||t}px`})}render(){const{className:e,style:t,children:s}=this.props;return(0,n.jsx)("thead",{ref:this.setRef,className:e,style:t,exportignore:this.props.exportIgnore||void 0,children:s})}}u.contextType=l;class p extends i.PureComponent{componentDidMount(){this.cleanup=this.context.onSortFieldChanged((e,t)=>{this.setState({sortBy:e,isDesc:t})})}componentWillUnmount(){this.cleanup()}render(){const{children:e,className:t,style:s}=this.props,i=this.context.getData();let o=null;return i&&0===i.length?null:(o="function"===typeof e?i&&i.length>0&&i.map(e):e,(0,n.jsx)("tbody",{className:t,style:s,children:o}))}}p.contextType=l;class m extends i.PureComponent{constructor(...e){super(...e),this.state={hasRows:!1}}componentDidMount(){const e=this.context.getData();this.setState({hasRows:!(!e||!e.length)}),this.cleanup=this.context.onDataChanged(e=>this.setState({hasRows:!(!e||!e.length)}))}componentWillUnmount(){this.cleanup()}render(){if(this.state.hasRows)return null;const{children:e,span:t}=this.props;return(0,n.jsx)("tbody",{children:(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:t,children:e})})})}}m.contextType=l;class g extends i.PureComponent{render(){return(0,n.jsx)("tr",{...this.props})}}g.contextType=l;class f extends i.PureComponent{constructor(...e){super(...e),this.state={},this.onClick=e=>{this.context.sortBy(this.props.sortBy)}}componentDidMount(){this.setState(this.context.getSortedField()),this.cleanup=this.context.onSortFieldChanged((e,t)=>{this.setState({sortBy:e,isDesc:t})})}componentWillUnmount(){this.cleanup()}render(){const{sortBy:e,isDesc:t}=this.state,{style:s,sortBy:i,children:o,noExport:a,rowSpan:r,colSpan:l,dragConnector:d}=this.props;let{className:c}=this.props;return c||(c=""),i&&(c+=" sortable"),(0,n.jsxs)("th",{ref:d,className:c,style:s,onClick:this.onClick,"no-export":a?"true":null,rowSpan:r,colSpan:l,children:[o," ",i?i===e?(0,n.jsx)("i",{className:"fa fa-sort-"+(t?"desc":"asc")}):(0,n.jsx)("i",{className:"fa fa-sort"}):null]})}}f.contextType=l},1445:(e,t,s)=>{s.d(t,{A:()=>g});s(9950);var i=s(9051),o=s.n(i),a=s(9779),r=s(640),n=s(8874),l=s(6778),d=s(3816),c=s(4922),h=s(2963),u=s(4414);const p=[{value:"",label:"Auto adjust"},{value:"leave",label:"No changes"},{value:"manual",label:"Reduce by"},{value:"new",label:"Set new estimate"}];class m extends r.A{constructor(e){const{editTracker:t}=e;super(e,t?"Edit Tracker":"Add worklog"),this.saveWorklog=(e,t,s)=>{if(!this.validateData(e,t,this.state.ctlClass))return this.$message.warning("Please provide value for all the mandatory fields","Incomplete worklog details"),!1;if(this.setState({isLoading:!0}),this.props.editTracker){const{dateStarted:e,description:t}=this.state.log;this.$wltimer.editTrackerInfo(this.getTicketNo(this.state.log),e,t).then(this.props.onDone)}else{const{adjustEstimate:t,estimate:i}=this.state,o=e.overrideTimeSpent||e.timeSpent;t&&(s={adjustEstimate:t,estimate:i}),this.$worklog.saveWorklog({ticketNo:this.getTicketNo(e),dateStarted:e.dateStarted,description:e.description,worklogId:e.worklogId,isUploaded:e.isUploaded,timeSpent:o,parentId:e.parentId,id:e.id},s).then(t=>{this.props.onDone(e.id>0?{type:d.v8.WorklogModified,edited:t,previousTime:this.previousTime}:{type:d.v8.WorklogModified,added:t}),this.onHide()},e=>{this.setState({isLoading:!1}),"string"===typeof e?this.$message.error(e):e.message&&this.$message.error(e.message)})}},this.setValue=(e,t,s)=>{let{log:i,vald:o,ctlClass:a}=this.state;t?(i[e]=t,s&&(a={...a,[e]:""},o={...o,[e]:!0})):delete i[e],i={...i},this.setState({log:i,vald:o,ctlClass:a})},this.formatTs=e=>e,this.handleKeyPress=e=>{const{ctrlKey:t,charCode:s}=e;if(t&&13===s){const{isLoading:e,state:{log:t,vald:s,uploadImmediately:i}}=this;e||this.saveWorklog(t,s,i&&!(t.id>0))}},this.style={width:"90vw",maxWidth:"850px"},(0,n.WQ)(this,"SessionService","WorklogService","WorklogTimerService","MessageService","UtilsService","AnalyticsService"),this.className="add-worklog-popup",this.displayDateFormat="yyyy-MM-dd HH:mm";const{commentLength:s,autoUpload:i,defaultTimeSpent:o}=this.$session.CurrentUser;this.minCommentLength=s||0,this.defaultTimeSpent=function(e){if(!e)return"01:00";e=e.toString().split(".");const t=parseInt(e[0]),s=parseInt(Math.round(60*`.${e[1]||0}`))||0;return`${t.pad(2)}:${s.pad(2)}`}(o);const{worklog:a,uploadImmediately:r}=e;this.state=this.getState(a),this.state.uploadImmediately="boolean"===typeof r?r:i||!1,this.init(t)}init(e){e?this.$wltimer.getCurrentTimer().then(e=>this.setState(this.getTrackerState(e))):this.loadWorklog(this.state.log)}loadWorklog(e){e.id&&this.fillWorklog(e,e.copy)}getTrackerState(e){const t={ticketNo:e.key,dateStarted:new Date(e.created),description:e.description};return{log:t,vald:{ticketNo:!0,dateStarted:!0,description:!!t.description}}}getState(e){const t={showDialog:!0,vald:{},ctlClass:{},isLoading:!1,log:e};if(e&&!e.id){var s;t.log={ticketNo:e.ticketNo,dateStarted:o()(e.startTime||e.dateStarted||new Date).toDate(),description:(null===(s=e.description)||void 0===s?void 0:s.trim())||""},e.parentId&&(t.log.parentId=e.parentId);let{timeSpent:i}=e;"number"===typeof i&&(i=this.$utils.formatSecs(i,!1,!0)),t.log.timeSpent=i||this.defaultTimeSpent,this.validateData(t.log,t.vald,t.ctlClass)}return t}fillWorklog(e,t){return this.$worklog.getWorklog(e).then(e=>{e.timeSpent&&(e.timeSpent=e.timeSpent.substring(0,5),"00:00"===e.timeSpent&&(e.timeSpent=null)),t?(this.$analytics.trackEvent("Worklog copy",c.hB.UserActions,e.isUploaded?"Uploaded worklog":"Pending worklog"),delete e.id,delete e.isUploaded,delete e.worklogId,delete e.parentId,e.dateStarted=o()(`${(new Date).format("yyyy/MM/dd")} ${e.dateStarted.format("HH:mm:ss")}`).toDate()):(this.previousTime=e.dateStarted,this.$analytics.trackEvent("Worklog view",c.hB.UserActions,e.isUploaded?"Uploaded worklog":"Pending worklog"));const s={log:e,vald:this.state.vald,ctlClass:this.state.ctlClass};return this.validateData(s.log,s.vald,s.ctlClass),this.setState(s),e})}validateData(e,t,s){e.timeSpent=e.overrideTimeSpent||e.timeSpent||"00:00",delete e.overrideTimeSpent;let i=!0;const a=this.getTicketNo(e);if(i=(t.ticketNo=!(!a||a.length<3))&&i,this.props.editTracker){const s=o()(e.dateStarted),a=o()().startOf("day").toDate();i=(t.dateStarted=s.isValid()&&s.isBetween(a,new Date,void 0,"[]"))&&i}else{i=(t.dateStarted=!(!e.dateStarted||e.dateStarted.length<16))&&i,t.timeSpent=e.timeSpent&&e.timeSpent.length>=4,t.timeSpent=t.timeSpent&&this.$worklog.getTimeSpent(e.timeSpent)>0,i=t.timeSpent&&i;const{adjustEstimate:s,estimate:o}=this.state;t.estimate=!!o&&this.$worklog.getTimeSpent(o)>0||!s||"leave"===s,i=t.estimate&&i}return i=(t.description=this.minCommentLength<1||!(!e.description||e.description.length<this.minCommentLength))&&i,s.ticketNo=t.ticketNo?"is-valid":"is-invalid",s.dateStarted=t.dateStarted?"is-valid":"is-invalid",s.timeSpent=t.timeSpent?"is-valid":"is-invalid",s.description=t.description?"is-valid":"is-invalid",s.estimate=t.estimate?"is-valid":"is-invalid",i}getTicketNo(e){return e&&e.ticketNo?"string"===typeof e.ticketNo?e.ticketNo:e.ticketNo.value:null}deleteWorklog(e){this.setState({isLoading:!0});const t=e.ticketNo;e.ticketNo=t.value||t,this.$worklog.deleteWorklog(e).then(t=>{this.setState({isLoading:!1}),this.props.onDone({type:d.v8.DeletedWorklog,removed:e.id,deleted:e.id,deletedObj:e}),this.onHide()},()=>{e.ticketNo=t})}getFooter(){const{state:{isLoading:e,log:t,vald:s,uploadImmediately:i,adjustEstimate:o}}=this;return(0,u.jsxs)(u.Fragment,{children:[!t.id&&(0,u.jsx)(l.Sc,{checked:i||!!o,disabled:!!o,className:"float-start",label:"Upload immediately to Jira",onChange:e=>this.setState({uploadImmediately:e})}),t.id>0&&(0,u.jsx)(l.$n,{type:"danger",icon:"fa fa-trash",label:"Delete",className:"float-start",disabled:e,onClick:()=>this.deleteWorklog(t)}),t.id>0&&!t.worklogId&&(0,u.jsx)(l.$n,{type:"primary",isLoading:e,icon:"fa fa-upload",label:"Save & Upload",className:"float-start",disabled:e,onClick:()=>this.saveWorklog(t,s,!0)}),(0,u.jsx)(l.$n,{text:!0,type:"secondary",icon:"fa fa-times",label:"Cancel",onClick:this.onHide}),(0,u.jsx)(l.$n,{type:"primary",icon:"fa fa-save",label:"Save",isLoading:e,disabled:e,onClick:()=>this.saveWorklog(t,s,i&&!(t.id>0))})]})}render(){const{minCommentLength:e,state:{log:t,vald:s,ctlClass:i,adjustEstimate:o,estimate:r},props:{editTracker:n}}=this;return this.state.log?super.renderBase((0,u.jsxs)("div",{className:"pad-22",onKeyPress:this.handleKeyPress,children:[(0,u.jsxs)("div",{className:"row pad-b",children:[(0,u.jsx)("div",{className:"col-sm-3",children:(0,u.jsxs)("strong",{children:["Date started ",n?"":"& Time spent"]})}),(0,u.jsx)("div",{className:"col-lg-5 col-sm-6 col-xs-12",children:(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)("div",{className:i.dateStarted,children:(0,u.jsx)(l.lr,{value:t.dateStarted,showTime:!0,onChange:e=>this.setValue("dateStarted",e)})}),(0,u.jsx)("span",{className:"help-block "+(s.dateStarted?"":"msg-error"),children:"Provide the time you had started the work"})]})}),!n&&(0,u.jsx)("div",{className:"col-lg-3 col-sm-3 col-xs-12",children:(0,u.jsxs)("div",{className:"form-group no-margin",children:[(0,u.jsx)("div",{className:`p-inputgroup ${i.timeSpent}`,children:(0,u.jsx)(a.N,{mask:"99:99",className:"w-80",value:t.timeSpent||"",placeholder:"00:00",maxlength:5,onChange:e=>this.setValue("timeSpent",e.value)})}),(0,u.jsx)("span",{className:"help-block "+(s.timeSpent?"":"msg-error"),children:"Provide hours spent"})]})})]}),(0,u.jsxs)("div",{className:"row pad-b",children:[(0,u.jsx)("div",{className:"col-sm-3",children:(0,u.jsx)("strong",{children:"Ticket no"})}),(0,u.jsxs)("div",{className:"col-sm-9",children:[(0,u.jsx)(h.i,{value:t.ticketNo,useDisplay:!0,className:"w-100",tabIndex:"3",placeholder:"Enter the ticket number or start typing the summary to get suggestion",disabled:t.isUploaded,maxLength:20,onPick:e=>this.setValue("ticketNo",e,!0)}),(0,u.jsx)("span",{className:"help-block "+(s.ticketNo?"":"msg-error"),children:"Provide the ticket no on which you had to log your work"})]})]}),(0,u.jsxs)("div",{className:"row",children:[(0,u.jsx)("div",{className:"col-sm-3",children:(0,u.jsx)("strong",{children:"Work description"})}),(0,u.jsx)("div",{className:"col-sm-9",children:(0,u.jsx)(l.fI,{multiline:!0,rows:3,value:t.description||"",className:"form-control "+(s.description?"":"ctl-error"),onChange:e=>this.setValue("description",e),placeholder:"Provide a brief info about the task you had done."+(e?` Should be atleast ${e} chars is length. You can change this settings from General settings -> Worklog tab`:"")})})]}),(0,u.jsx)("br",{}),!n&&(0,u.jsxs)("div",{className:"row pad-top-5",children:[(0,u.jsx)("div",{className:"col-sm-3",children:(0,u.jsx)("strong",{children:"Remaining estimate"})}),(0,u.jsx)("div",{className:"col-sm-4",children:(0,u.jsx)(l.aL,{value:o||"",dataset:p,onChange:e=>this.setState({adjustEstimate:e})})}),(0,u.jsx)("div",{className:"col-sm-4",children:("manual"===o||"new"===o)&&(0,u.jsx)(a.N,{mask:"99:99",className:"w-80",value:r||"",placeholder:"00:00",maxlength:5,onChange:e=>this.setState({estimate:e.value})})}),!!o&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"col-sm-3"}),(0,u.jsx)("div",{className:"col-sm-9",children:(0,u.jsxs)("span",{className:"help-block",children:[(0,u.jsx)("strong",{children:"Note:"})," Your worklog will be immediately uploaded upon save"]})})]})]})]})):"Loading..."}}const g=m},2285:(e,t,s)=>{s.d(t,{v:()=>i});const i={None:0,AddWorklog:1,WorklogModified:2,DeletedWorklog:3,TicketBookmarked:10,SettingsChanged:20,RemoveGadget:100}},2492:(e,t,s)=>{s.d(t,{A:()=>o});s(9950);var i=s(4414);const o=function({value:e,maxHours:t}){let s=-100,o="log-indicator";return e?(s=100*e/t,s>100?s=100:s<0&&(s=0),s-=100):o+=" no-value",(0,i.jsx)("div",{className:o,children:(0,i.jsx)("div",{className:"prog-bar",style:{marginLeft:`${s}%`}})})}},2963:(e,t,s)=>{s.d(t,{i:()=>h});var i=s(9950),o=s(1219),a=s(6778),r=s(8874),n=s(4414);const l=[9,16,17,18,27,123],d=/^\b[A-Z][A-Z0-9_]+-[1-9][0-9]*$/gi;async function c(e,t){var s;if(!new RegExp(d).test(t))return;const{$session:i}=(0,r.WQ)("SessionService"),a=null===(s=i.CurrentUser.jiraUrl)||void 0===s?void 0:s.clearEnd("/");try{const[s]=await e.searchTickets(`key=${t}`);return{id:s.id,key:s.key,root:a,url:(0,o._8)(a,s.key),summary:s.fields.summary,summaryText:s.fields.summary,img:s.fields.issuetype.iconUrl}}catch(n){console.error("Invalid issue key provided in picker",n)}}const h=i.memo(function({value:e,disabled:t,useDisplay:s,returnObject:o,onPick:d,onInvalid:h,tabIndex:u,...p}){const m=(0,i.useRef)({}),[g,f]=(0,i.useState)(s&&!!e),[x,v]=(0,i.useState)(!(!s||!e)&&{key:e}),[y,k]=(0,i.useState)(!e),{$jira:j}=(0,r.WQ)("JiraService"),w=(e,t)=>{f(!1),!d||!e&&h&&t?h&&!e&&t&&h(t):d(o?e:null===e||void 0===e?void 0:e.key),e?s&&(v(e),k(!1)):(v(!1),k(!0))};(0,i.useEffect)(()=>{!s||!e||null!==x&&void 0!==x&&x.id&&e===x.key||async function(){const t=await c(j,e);w(t)}()},[e]);const S=e=>{m.current.blurTimer&&(clearTimeout(m.current.blurTimer),delete m.current.blurTimer),w(e.value)},b=e=>{const t=e.target.value;t?m.current.blurTimer=setTimeout(async()=>{delete m.current.blurTimer,v({key:t}),f(!0);const e=await c(j,t);w(e)},600):w("")},C=e=>{l.includes(e.keyCode)||k(!0)};return g&&s&&x?(0,n.jsxs)("div",{className:"sel-issue loading-data",title:"Please wait. Loading details...",children:[(0,n.jsx)("span",{className:"issue-key",children:x.key})," -",(0,n.jsx)("div",{className:"issue-summary",children:"Loading..."}),(0,n.jsx)("span",{className:"fa fa-spin fa-spinner"})]}):!y&&x&&s?(0,n.jsxs)("div",{className:"sel-issue"+(t?" disabled":""),tabIndex:u,onClick:t?void 0:C,onKeyDown:t?void 0:C,"data-test-id":"issue-key","data-issue-key":x.key,children:[(0,n.jsx)(a._V,{src:x.img,className:"margin-r-8"}),(0,n.jsx)("span",{className:"issue-key",children:x.key})," -",(0,n.jsx)("div",{className:"issue-summary",children:x.summaryText}),!t&&(0,n.jsx)("span",{className:"edit-key fa fa-pencil",title:"Click to edit issue"})]}):(0,n.jsx)(a.j9,{value:e,displayField:"value",dataset:j.lookupIssues,disabled:t,maxLength:20,onSelect:S,onBlur:b,autoFocus:!0,optionGroupChildren:"issues",optionGroupLabel:"label",valueField:"key",...p,children:e=>(0,n.jsxs)("span",{style:{fontSize:12,margin:"10px 10px 0 0"},children:[(0,n.jsx)(a._V,{src:e.img,alt:"",className:"margin-r-8"}),e.key," - ",e.summaryText]})})})},3623:(e,t,s)=>{s.d(t,{A:()=>n});s(9950);var i=s(640),o=s(7630),a=s(4414);class r extends i.A{constructor(e){super(e,"Add users"),this.style={width:"90vw"},this.className="no-padding"}render(){return super.renderBase((0,a.jsx)(o.default,{isPlugged:!0,groups:this.props.groups,onDone:this.onHide}))}}const n=r},3816:(e,t,s)=>{s.d(t,{Vv:()=>G,_X:()=>ne,v8:()=>i.v,nD:()=>Cs,ak:()=>ms,KK:()=>xs,UO:()=>ys,L3:()=>ws,ez:()=>X,yP:()=>bs,Zs:()=>ds,e_:()=>os});var i=s(2285),o=s(9950),a=s(9051),r=s.n(a),n=s(1072),l=s(7758),d=s(7327),c=s(1668),h=s(2092),u=s(8008),p=s(9786),m=s(7426),g=s(8874),f=s(6778),x=s(1723),v=s(530),y=s(1445),k=s(3493),j=s(1219),w=s(5674),S=s(4414);class b extends o.PureComponent{constructor(...e){super(...e),this.state={},this.toggleShowAttendees=()=>this.setState({showAttendees:!this.state.showAttendees}),this.toggleShowDesc=()=>this.setState({showFullDesc:!this.state.showFullDesc})}render(){const{props:{cut:e,eventDetails:t},state:{showAttendees:s,showFullDesc:i}}=this;return t?(0,S.jsxs)("div",{className:"event-details",children:[(0,S.jsxs)("div",{className:"header",children:[(0,S.jsx)("div",{className:"controls"}),(0,S.jsx)("div",{className:"title",children:e(t.summary,75)})]}),(0,S.jsxs)("div",{className:"body",children:[(0,S.jsxs)("div",{className:"detail",children:[(0,S.jsx)("div",{className:"title",children:(0,S.jsx)("i",{className:"fa fa-clock"})}),(0,S.jsxs)("div",{className:"info",children:[(0,S.jsx)("span",{children:t.date}),(0,S.jsxs)("span",{className:"info",children:[t.startTime," - ",t.endTime," ",t.remaining]})]})]}),t.location&&(0,S.jsxs)("div",{className:"detail",children:[(0,S.jsx)("div",{className:"title",children:(0,S.jsx)("i",{className:"fa fa-map-marker"})}),(0,S.jsx)("div",{className:"info",children:t.location})]}),t.videoCall&&(0,S.jsxs)("div",{className:"detail",children:[(0,S.jsx)("div",{className:"title",children:(0,S.jsx)("i",{className:"fa fa-video-camera"})}),(0,S.jsx)("div",{className:"info",children:(0,S.jsxs)(w.A,{href:t.videoCall.url,children:["Join meeting: ",t.videoCall.name]})})]}),t.attendees&&(0,S.jsxs)("div",{className:"detail pointer",children:[(0,S.jsx)("div",{className:"title",children:(0,S.jsx)("i",{className:"fa fa-users"})}),(0,S.jsxs)("div",{className:"info",onClick:this.toggleShowAttendees,children:[(0,S.jsx)("div",{className:"icon float-end",children:(0,S.jsx)("i",{className:"fa "+(s?"fa-angle-up":"fa-angle-down")})}),(0,S.jsxs)("div",{children:[(0,S.jsxs)("span",{children:[t.attendees.total," guests"]}),t.attendees&&(0,S.jsxs)("span",{className:"info",children:[t.attendees.yes&&(0,S.jsxs)("font",{children:[t.attendees.yes," yes,"]}),t.attendees.no&&(0,S.jsxs)("font",{children:[t.attendees.no," no,"]}),t.attendees.tentative&&(0,S.jsxs)("font",{children:[" ",t.attendees.tentative," tentative,"]}),t.attendees.awaiting&&(0,S.jsxs)("font",{children:[" ",t.attendees.awaiting," awaiting"]})]})]})]}),s&&t.attendees&&(0,S.jsx)("div",{className:"attendees",children:t.attendees.list.map((e,t)=>(0,S.jsxs)("div",{className:"attendee",children:[e.displayName&&(0,S.jsxs)("span",{className:"name",children:[" ",e.displayName]}),e.email&&(0,S.jsxs)("span",{className:"email",children:[" (",e.email,")"]})]},t))})]}),t.description&&(0,S.jsxs)("div",{className:"detail",children:[(0,S.jsx)("div",{className:"title",children:(0,S.jsx)("i",{className:"fa fa-align-justify"})}),(0,S.jsx)("div",{className:"info",children:(0,j.BW)(i?t.description:e(t.description,350))}),t.description.length>350&&(0,S.jsx)("div",{style:{textAlign:"center"},children:(0,S.jsx)("span",{className:"link",onClick:this.toggleShowDesc,children:i?"show less":"show all"})})]})]})]}):null}}const C=b;var N=s(640);const{googleCalendar:T,outlookCalendar:D}=p.A.features.integrations,$=!1!==D||!1!==T;class W extends N.A{constructor(e){super(e,"Calendar configurations"),this.setValue=(e,t)=>{let{settings:s}=this.state;s={...s},e||!1===e?s[t]=e:delete s[t],this.setState({settings:s})},this.onDone=()=>{this.props.onDone(this.state.settings),this.onHide()},this.state={showDialog:!0,settings:{...e.settings}},this.style={width:"667px"}}getFooter(){return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(f.$n,{text:!0,type:"secondary",icon:"fa fa-times",label:"Cancel",onClick:this.onHide}),(0,S.jsx)(f.$n,{type:"primary",icon:"fa fa-save",label:"Done",onClick:this.onDone})]})}render(){const{settings:e}=this.state;return super.renderBase((0,S.jsxs)("div",{className:"pad-22",children:[(0,S.jsx)("h3",{className:"control-sidebar-heading",children:"Item Colors"}),$&&(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Meeting entry color"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)(f.sk,{value:e.eventColor,fieldName:"eventColor",onChange:this.setValue}),(0,S.jsx)("label",{className:"form-check-label",children:"Specify the color of the entry for meeting"})]})]}),(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Worklog entry color"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)(f.sk,{value:e.worklogColor,fieldName:"worklogColor",onChange:this.setValue}),(0,S.jsx)("label",{className:"form-check-label d-block",children:"Specify the color of the worklog entry"})]})]}),(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Info color (Valid)"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)(f.sk,{value:e.infoColor_valid,fieldName:"infoColor_valid",onChange:this.setValue}),(0,S.jsx)("label",{className:"form-check-label",children:"Specify the color of the info entry when the total hours logged is equal to the max hours to log setting"})]})]}),(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Info color (Less)"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)(f.sk,{value:e.infoColor_less,fieldName:"infoColor_less",onChange:this.setValue}),(0,S.jsx)("label",{className:"form-check-label",children:"Specify the color of the info entry when the total hours logged is lesser than the max hours to log"})]})]}),(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Info color (High)"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)(f.sk,{value:e.infoColor_high,fieldName:"infoColor_high",onChange:this.setValue}),(0,S.jsx)("label",{className:"form-check-label",children:"Specify the color of the info entry when the total hours logged is higher than the max hours to log"})]})]}),(0,S.jsx)("h3",{className:"control-sidebar-heading mt-3",children:"Show / Hide Entries"}),$&&(0,S.jsx)("div",{className:"form-group",children:(0,S.jsx)(f.Sc,{checked:e.showMeetings||!1,onChange:e=>this.setValue(e,"showMeetings"),label:"Display entry for meetings integrated from calendar"})}),(0,S.jsx)("div",{className:"form-group",children:(0,S.jsx)(f.Sc,{checked:e.showWorklogs||!1,onChange:e=>this.setValue(e,"showWorklogs"),label:"Display worklog added by you"})}),(0,S.jsx)("div",{className:"form-group",children:(0,S.jsx)(f.Sc,{checked:e.showInfo||!1,onChange:e=>this.setValue(e,"showInfo"),label:"Display information about total hours logged on daily basis"})}),(0,S.jsx)("h5",{className:"control-sidebar-heading mt-2",children:"Entry details"}),(0,S.jsxs)("div",{className:"form-group",children:[(0,S.jsx)(f.a,{value:e.detailsMode||"1",defaultValue:"1",onChange:e=>this.setValue(e,"detailsMode"),label:"Display worklog comments on worklog entry"}),(0,S.jsx)("br",{}),(0,S.jsx)(f.a,{value:e.detailsMode||"1",defaultValue:"2",onChange:e=>this.setValue(e,"detailsMode"),label:"Display ticket summary on worklog entry"}),(0,S.jsx)("br",{}),(0,S.jsx)(f.a,{value:e.detailsMode||"1",defaultValue:"3",onChange:e=>this.setValue(e,"detailsMode"),label:"Try accomidate both worklog comments and ticket summary on worklog entry"})]}),(0,S.jsx)("h3",{className:"control-sidebar-heading mt-3",children:"Other options"}),(0,S.jsx)("div",{className:"form-group",children:(0,S.jsx)(f.Sc,{checked:e.rowBanding||!1,onChange:e=>this.setValue(e,"rowBanding"),label:"Enable alternate row color on calendar time grid"})}),(0,S.jsxs)("div",{className:"form-group",children:[(0,S.jsx)(f.Sc,{checked:e.hideWeekends||!1,onChange:e=>this.setValue(e,"hideWeekends"),label:"Hide weekends from calendar view (even when worklog already exists)"}),"\xa0( ",(0,S.jsx)("span",{className:"fa fa-exclamation-triangle",title:"Will be applied only once the page is refreshed. Existing pending worklog would still be uploaded even if hidden"})," )"]}),(0,S.jsxs)("div",{className:"form-group",children:[(0,S.jsx)(f.Sc,{checked:e.readableEvents||!1,onChange:e=>this.setValue(e,"readableEvents"),label:"Allow small events to expand in height to make it readable"}),"\xa0( ",(0,S.jsx)("span",{className:"fa fa-exclamation-triangle",title:"This settings may result in small events overlapping with other events. This settings would be applied only after page refresh."})," )"]})]}))}}const A=W;var U=s(4922),L=s(4692);class I extends o.PureComponent{componentDidMount(){this.props.enabled&&this.props.onChange()}render(){return null}}const M=I,R=[{value:"dayGridMonth",label:"Month"},{value:"timeGridWeek",label:"Week"},{value:"timeGridDay",label:"Day"},{value:"listMonth",label:"Month List"},{value:"listWeek",label:"Week List"},{value:"listDay",label:"Day List"},{value:"dayGridWeek",label:"Grid Week"},{value:"dayGridDay",label:"Grid Day"}],E=[l.A,d.A,u.Ay,c.A,h.Ay],{googleCalendar:F,outlookCalendar:P}=p.A.features.integrations,B=(!1!==P||!1!==F)&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("li",{children:["One click ",(0,S.jsx)("span",{className:"fa fa-clock"})," icon to create worklog entry for meetings"]}),(0,S.jsx)("li",{children:'You can set "Default meeting ticket" in General Settings \u21e8 Worklog tab'})]});class V extends m.Ay{constructor(e){super(e,"Calendar","fa-calendar"),this.refreshData=()=>this.fillEvents(this.startDate,this.endDate),this.viewModeChanged=e=>{this.setState({viewMode:e}),this.fullCalendarOpts.dayHeaderFormat=this.getDayHeaderFormat(e),this.calendar.getApi().changeView(e),this.saveSettings({...this.state.settings,viewMode:e},!0)},this.hideWorklogDialog=()=>this.setState({showAddWorklogPopup:!1}),this.toggleSettingsDialog=()=>this.setState({showSettingsPopup:!this.state.showSettingsPopup}),this.addEvent=e=>{if(0===e.type)return;let t=!1,{events:s}=this.state;if(s=[...s],e.removed){const t=e.removed+(e.deletedObj.worklogId?`#${e.deletedObj.worklogId}`:"");e=s.first(e=>e.id===t&&1===e.entryType),s.remove(e)}else if(e.added||e.edited){const i=e.previousTime;e=e.added||e.edited,(e={...e}).backgroundColor=this.state.settings.worklogColor,e.borderColor=e.backgroundColor,s.removeAll(t=>t.id===e.id&&1===t.entryType),s.push(e),t=!0,i&&this.updateAllDayEvent({start:i},s)}return this.updateAllDayEvent(e,s),this.setEventsData(s),t},this.hideOPEvent=()=>this.setState({showOpEvent:!1}),this.eventClick=e=>{const{event:t,jsEvent:s,view:i}=e;return s.target.hasAttribute("event-icon")||(this.currentMeetingViewItem=null,1===t.extendedProps.entryType?this.showWorklogPopup(t.extendedProps.sourceObject):2===t.extendedProps.entryType&&(this.currentMeetingViewItem=s.srcElement,this.showCalendarDetails(t,s,i))),!1},this.renderEventContent=e=>{const{timeText:t,event:s,view:{type:i}}=e,{entryType:o,logged:a,diff:r}=s.extendedProps;if(3===o)return(0,S.jsx)("span",{className:"pad-l-5",children:this.getLoggedTimeTitle(a,r)});const n=` (${this.$utils.formatTs(this.getEventDuration(s))})`,l=s.extendedProps.sourceObject;let d,c,h,u=s.title,p="";if(1===o){const{detailsMode:e}=this.state.settings;"2"===e?u=`${null===l||void 0===l?void 0:l.ticketNo} - ${null===l||void 0===l?void 0:l.summary}`:"3"===e&&(p=null===l||void 0===l?void 0:l.summary)}if(l&&(d=`${t} ${n}\n${u}`),1===o){const e=l;h=t=>{this.mnuWL_Upload.disabled=e.isUploaded,this.currentWLItem=e,(0,v.O0)(t,this.contextMenuItems)},c=(0,S.jsx)("i",{className:"fa fa-ellipsis-v float-start",title:"Show options",onClick:h,"event-icon":"true"})}else if(2===o){var m;const e=l,t=null===(m=this.state.events)||void 0===m?void 0:m.some(e=>e.parentId===s.id&&1===e.entryType);h=(i,o,a)=>{i.stopPropagation(),i.preventDefault(),this.currentMeetingItem=e,this.currentMeetingExtdProps=s.extendedProps,this.mnuCal_AddWL.disabled=t,this.mnuCal_OpenUrl.disabled=!e.hangoutLink,(0,v.O0)(i,this.calMenuItems)},c=t?(0,S.jsx)("i",{className:"fa fa-ellipsis-v float-start",title:"Show options",onClick:h,"event-icon":"true"}):(0,S.jsx)("i",{className:"fa fa-clock float-start",title:"Create worklog for this meeting","event-icon":"true",onClick:t=>{t.stopPropagation(),this.createWorklog(t,e,this.defaultMeetingTicket)}})}if("timeGridWeek"===i||"timeGridDay"===i){const e=30*((u?3:0)+(p?3:0))>l.totalMins?" short-desc":"";return(0,S.jsxs)("div",{ref:e=>{var t,s;return null===e||void 0===e||null===(t=e.parentElement)||void 0===t||null===(s=t.parentElement)||void 0===s?void 0:s.addEventListener("contextmenu",h)},className:"fc-content pad-8",title:d,"data-jira-key":null===l||void 0===l?void 0:l.ticketNo,"data-jira-wl-id":null===l||void 0===l?void 0:l.worklogId,children:[1===o&&(0,S.jsx)(H,{worklog:l,onUpload:this.uploadSelectedWorklog,onClone:this.cloneWorklog}),c,(0,S.jsxs)("div",{className:"fc-time",children:[(0,S.jsx)("span",{children:t}),(0,S.jsxs)("span",{className:"fc-hour",children:[" ",n]})]}),(0,S.jsx)("div",{className:`fc-title${e}`,children:u}),!!p&&(0,S.jsx)("div",{className:`fc-sub-title${e}`,title:p,children:p})]})}return!0},this.uploadSelectedWorklog=async e=>{try{this.setState({uploading:!0});const t=await this.$worklog.uploadWorklogs([e],!0);this.setState({uploading:!1}),this.$message.success("Worklog uploaded successfully!");const{events:s}=this.state;s.removeAll(t=>1===t.entryType&&t.id.toString()===e.toString()),this.addEvent({added:this.$worklog.getWLCalendarEntry(t[0])}),this.$analytics.trackEvent("Worklog uploaded: Individual",U.hB.UserActions)}catch(t){(t.message||t.response)&&this.$message.error(t.message||t.response)}finally{this.setState({uploading:!1})}},this.cloneWorklog=async e=>{try{const t=await this.$worklog.copyWorklog(e);this.addEvent({added:t}),this.$message.success("Worklog cloned!"),this.$analytics.trackEvent("Worklog Cloned: Individual",U.hB.UserActions)}catch(t){this.$message.error(t.message,"Clone failed")}},this.saveSettings=(e,t)=>{if(this.isGadget)return super.saveSettings(),void(!0!==t&&this.refreshData());this.$session.pageSettings.calendar=e,this.setGadgetClass(e),this.setState({settings:e},!0!==t?this.refreshData:null),this.$config.saveSettings("calendar",e)},this.toggleDisplayHours=()=>this.setState(e=>this.updateOpts(e,{fullView:!e.fullView})),this.toggleZoom=()=>this.setState(e=>this.updateOpts(e,{zoomIn:!e.zoomIn})),this.today=()=>this.calendar.getApi().today(),this.setCalRef=e=>this.calendar=e,(0,g.WQ)(this,"SessionService","WorklogService","MessageService","AnalyticsService","OutlookService","CalendarService","UtilsService","UserUtilsService","ConfigService","TicketService","AppBrowserService"),this.hideMenu=!e.isGadget,this.hideRefresh=!0,this.hideExport=!0,this.$session.pageSettings.calendar?this.state.settings=Object.assign({showMeetings:!0,showWorklogs:!0,showInfo:!0},this.$session.pageSettings.calendar):this.state.settings={viewMode:"timeGridWeek",showMeetings:!0,showWorklogs:!0,showInfo:!0},this.setGadgetClass(this.state.settings),this.setMenuItems(),this.CurrentUser=this.$session.CurrentUser,this.maxTime=this.CurrentUser.maxHours,this.minTime=this.CurrentUser.minHours||this.maxTime,this.dateFormat=this.CurrentUser.dateFormat,this.maxTime&&(this.maxTime=60*this.maxTime*60),this.minTime&&(this.minTime=60*this.minTime*60),this.fullCalendarOpts=this.getCalendarOptions(this.state)}setGadgetClass({rowBanding:e}){const t=e?" cal-row-banding":"";this.props.isGadget?this.className=`calendar-view${t}`:this.className=t}getHint(){return(0,S.jsxs)("ul",{className:"gadget-hint",children:[(0,S.jsx)("li",{children:"Pressing left Alt + drag drop worklog will copy the worklog to target slot"}),B,(0,S.jsx)("li",{children:"Drag and drop or resize the worklog to edit it"}),(0,S.jsx)("li",{children:"Right click worklog to see more options"}),(0,S.jsxs)("li",{children:["You can change the hours grid in calendar by changing the working",(0,S.jsx)("br",{}),"and display hours in General Settings page"]})]})}async setMenuItems(){this.mnuWL_Upload={label:"Upload worklog",icon:"fa fa-upload",command:()=>this.uploadWorklog()},this.contextMenuItems=[{label:"Edit worklog",icon:"fa fa-edit",command:()=>this.showWorklogPopup(this.currentWLItem)},{label:"Open ticket",icon:"fa fa-external-link",command:()=>this.openTicket(this.currentWLItem)},{label:"Copy worklog",icon:"fa fa-copy",command:()=>this.copyWorklog()},this.mnuWL_Upload,{label:"Delete worklog",icon:"fa fa-times",command:()=>this.deleteWorklog()}];const e=(this.$session.CurrentUser.meetingTicket||"").trim().split(",").map(e=>e.trim()).filter(Boolean),t=await this.$ticket.getTicketDetails(e),s=[];e.length>0&&(e.forEach(e=>{const{fields:{summary:i=""}={}}=t[e.toUpperCase()]||{};s.push({label:i?`${e}: ${this.$utils.cut(i,65,!0)}`:e,icon:"fa fa-ticket",command:t=>this.createWorklog(t.originalEvent,this.currentMeetingItem,e)})}),1===e.length&&(this.defaultMeetingTicket=e[0])),s.length>0&&s.push({separator:!0}),s.push({label:"Choose ticket",icon:"fa fa-pencil",command:e=>this.createWorklog(e.originalEvent,this.currentMeetingItem,"")}),this.mnuCal_AddWL={label:"Add worklog to",icon:"fa fa-clock",items:s,command:e=>this.createWorklog(e.originalEvent,this.currentMeetingItem,"")},this.mnuCal_OpenUrl={label:"Open video call",icon:"fa fa-video-camera",command:()=>this.openVideoCall(this.currentMeetingItem)},this.calMenuItems=[this.mnuCal_AddWL,{label:"Show details",icon:"fa fa-info-circle",command:e=>this.showCalendarDetails({extendedProps:this.currentMeetingExtdProps},e.originalEvent,null)},this.mnuCal_OpenUrl]}getDayHeaderFormat(e){if("dayGridMonth"===e)return;let t=this.dateFormat?U.Hx[this.dateFormat]:void 0;return t&&(t=t.replace("YYYY","").replace(/-/g,"/").clearStart(["/",","," "]).clearEnd(["/",","," "]),t.includes("ddd")||(t=`ddd, ${t}`)),t}getCalendarOptions({fullView:e,zoomIn:t}){var s;const{startOfDay:i,endOfDay:o,startOfWeek:a,workingDays:r=U.K3,timeFormat:n}=this.CurrentUser,{viewMode:l}=this.isGadget?this.props:this.state.settings,{hideWeekends:d,readableEvents:c}=this.state.settings,{startOfDayDisp:h,endOfDayDisp:u}=e?{startOfDayDisp:"00:00",endOfDayDisp:"23:59"}:this.CurrentUser;let p=a;p&&p>0?p-=1:p=null;const m=(n||"").indexOf("tt")>-1,g=!!m&&"short";let f=d?[0,1,2,3,4,5,6].filter(e=>!r.includes(e)):[];return 7===(null===(s=f)||void 0===s?void 0:s.length)&&(f=[]),{plugins:E,timeZone:"local",weekends:!0,hiddenDays:f,titleFormat:this.dateFormat?U.Hx[this.dateFormat]:void 0,dayHeaderFormat:this.getDayHeaderFormat(l),eventMinHeight:c?40:void 0,displayEventTime:!0,selectable:!0,firstDay:p,height:"100%",fixedWeekCount:!1,dayMaxEventRows:!0,editable:!0,droppable:!0,slotDuration:t?"00:05:00":"00:15:00",slotMinTime:h||i||U.je,slotMaxTime:u||o||U.qU,allDayText:"total",headerToolbar:!1,nowIndicator:!0,navLinks:!0,initialView:l,businessHours:{daysOfWeek:r||U.K3,startTime:i||U.je,endTime:o||U.qU},slotLabelFormat:{hour:"numeric",minute:"2-digit",omitZeroMinute:m,meridiem:g,hour12:m},eventTimeFormat:{hour:"numeric",minute:"2-digit",omitZeroMinute:m,meridiem:g,hour12:m},select:this.select.bind(this),datesSet:this.viewRender.bind(this),eventDrop:this.eventDrop.bind(this),eventResize:this.eventResize.bind(this),eventClick:this.eventClick}}UNSAFE_componentWillReceiveProps(e){e.viewMode&&this.setState({settings:{...this.state.settings,viewMode:e.viewMode}}),super.UNSAFE_componentWillReceiveProps(e)}createWorklog(e,t,s){if((0,v.Ls)(),!t.start.dateTime)return;e.stopPropagation(),e.preventDefault();const i=a.duration(a(t.end.dateTime).diff(t.start.dateTime)),o={dateStarted:t.start.dateTime,timeSpent:`${i.hours().pad(2)}:${i.minutes().pad(2)}`,description:t.subject||t.summary,parentId:t.id};return s?(o.ticketNo=s,this.$worklog.saveWorklog(o).then(t=>{var s;this.addEvent({added:t}),null===(s=e.currentTarget)||void 0===s||s.remove()},e=>{"string"===typeof e?this.$message.error(e):console.error(e)}),this.$analytics.trackEvent("Quick add WL",U.hB.UserActions)):this.showWorklogPopup(o),!1}fillEvents(e,t){e=a(e).startOf("day"),t=a(t).endOf("day");const s=e=>{const t=[],s=this.state.settings;switch(s.showMeetings&&t.push(2),s.showWorklogs&&t.push(1),s.showInfo&&t.push(3),t.length){case 0:e=[];break;case 3:break;default:e=e.filter(e=>t.indexOf(e.entryType)>-1)}this.setColors(e),this.setEventsData(e)},i=[this.$worklog.getWorklogsEntry(e,t,["worklog","summary"])];this.CurrentUser.googleIntegration&&this.CurrentUser.hasGoogleCredentials&&this.state.settings.showMeetings&&i.push(this.$calendar.getEvents(e,t).then(null,e=>{let t="Unable to fetch Google meetings!";return e.error&&e.error.message&&(t+=`<br /><br />Reason:- ${e.error.message}`),this.$message.warning(t),[]})),this.CurrentUser.outlookIntegration&&this.CurrentUser.hasOutlookCredentials&&this.state.settings.showMeetings&&i.push(this.$outlook.getEvents(e,t).then(null,e=>{let t="Unable to fetch Outlook meetings!";return e.error&&e.error.message&&(t+=`<br /><br />Reason:- ${e.error.message}`),this.$message.warning(t),[]})),this.setState({isLoading:!0,uploading:!1}),Promise.all(i).then(e=>{this.setState({isLoading:!1});const t=e[0],i=t.filter(e=>1===e.entryType).groupBy(e=>a(e.start).format("YYYY-MM-DD")).map(e=>this.getAllDayObj(e));s(t.addRange(i).addRange(e[1]))},e=>(this.setState({isLoading:!1}),Promise.reject(e)))}setLoggedTime(e,t){const s=this.getTimeSpent(e);return t.logged=s,s>this.maxTime?t.diff=s-this.maxTime:s<this.minTime?t.diff=s-this.minTime:t.diff=0,this.setInfoColor(t,this.state.settings),t.title=this.getLoggedTimeTitle(s,t.diff),t}getLoggedTimeTitle(e,t){const{formatSecs:s}=this.$utils;let i=`Logged: ${s(e)}`;return t&&(i+=` (${t>0?"+":"-"}${s(Math.abs(t))})`),i}setInfoColor(e,t){e.diff?e.backgroundColor=e.diff>0?t.infoColor_high:t.infoColor_less:e.backgroundColor=t.infoColor_valid,e.borderColor=e.backgroundColor}getTimeSpent(e){return e.sum(e=>{const t=a(e.start),s=a(e.end);return a.duration(s.diff(t)).asSeconds()})}updateAllDayEvent(e,t){const s=a(e.start).format("YYYY-MM-DD");t||(t=[...this.state.events]),t.removeAll(e=>e.id===s&&3===e.entryType);const o=t.filter(e=>1===e.entryType&&a(e.start).format("YYYY-MM-DD")===s);if(o&&o.length>0){const e=this.getAllDayObj({key:s,values:o});e.logged&&(t.push(e),this.setLoggedTime(o,e))}this.setEventsData(t),this.performAction(i.v.WorklogModified)}openTicket(e){const t=this.$userutils.getTicketUrl(e.ticketNo);this.$jaBrowserExtn.openTab(t)}showWorklogPopup(e){(0,v.Ls)();const t={showAddWorklogPopup:!0};if(e.copy)return t.worklogItem=e.copy,void this.setState(t);let s;if(e.id||e.parentId)s=e;else{const t=a.duration(e.end.diff(e.start));s={timeSpent:`${t.hours().pad(2)}:${t.minutes().pad(2)}`,allowOverride:!0},e.dateStarted?s.startTime=e.dateStarted:s.startTime=e.isMonthMode?a(`${e.start.format("YYYY-MM-DD")} ${this.CurrentUser.startOfDay}`,"YYYY-MM-DD HH:mm").toDate():e.start.toDate()}t.worklogItem=s,this.setState(t)}setEventsData(e){this.setState({isLoading:!1,events:[...e],pendingWorklogCount:this.getPendingWorklogs(e).length})}getAllDayObj(e){return this.setLoggedTime(e.values,{id:e.key,entryType:3,start:e.key,allDay:!0,editable:!1})}setColors(e){const t=this.state.settings,s=t.worklogColor,i=t.eventColor;e.forEach(e=>{switch(e.entryType){case 1:e.backgroundColor=s,e.borderColor=s;break;case 2:e.backgroundColor=i,e.borderColor=i;break;case 3:this.setInfoColor(e,t)}})}select({start:e,end:t,allDay:s}){const i="dayGridMonth"===this.state.settings.viewMode&&!this.isGadget;return!i&&s||(this.$analytics.trackEvent("Worklog drag",U.hB.UserActions),this.showWorklogPopup({isMonthMode:i,start:a(e),end:a(t)})),!1}showCalendarDetails(e,t,s){(0,v.Ls)(),t.preventDefault(),t.stopPropagation();const i=e.extendedProps.sourceObject;if(this.$analytics.trackEvent("View event details",U.hB.UserActions,e.extendedProps.source),"goolge"===e.extendedProps.source?this.currentMeetingItem=this.getGoogleEventView(i):"outlook"===e.extendedProps.source&&(this.currentMeetingItem=this.getOutlookEventView(i)),this.$session.isQuickView){const e=document.body.querySelector(".app-header.navbar > button[appmobilesidebartoggler]");e&&(t={currentTarget:e})}else this.currentMeetingViewItem&&(t={currentTarget:this.currentMeetingViewItem});this.opEvent.show(t),this.setState({showOpEvent:!0})}getGoogleEventView(e){const t={summary:e.summary,htmlLink:e.htmlLink,location:e.location,description:e.description,descrLimit:350,creator:e.creator,organizer:e.organizer};if(e.start){t.date=this.$userutils.formatDate(e.start.dateTime),t.startTime=this.$userutils.formatTime(e.start.dateTime);let s=a(e.start.dateTime).diff(a());s=s<0?e.end&&e.end.dateTime&&a().diff(e.end.dateTime)<0?"(now ongoing)":"":`(in ${this.$utils.formatTs(s)})`,t.remaining=s}if(e.end&&e.end.dateTime&&(t.endTime=this.$userutils.formatTime(e.end.dateTime)),e.attendees&&(t.attendees={total:e.attendees.length,yes:e.attendees.count(e=>"accepted"===e.responseStatus),no:e.attendees.count(e=>"notAccepted"===e.responseStatus),awaiting:e.attendees.count(e=>"needsAction"===e.responseStatus),tentative:e.attendees.count(e=>"tentative"===e.responseStatus),list:e.attendees}),e.hangoutLink){let s=e.hangoutLink;s.lastIndexOf("/")>0&&(s=s.substring(s.lastIndexOf("/")+1)),t.videoCall={url:e.hangoutLink,name:s}}return t}getOutlookEventView(e){const t={summary:e.subject,htmlLink:e.webLink,location:(e.location||{}).displayName,description:e.bodyPreview,descrLimit:350,creator:e.creator,organizer:((e.organizer||{}).emailAddress||{}).name};if(e.start){t.date=this.$userutils.formatDate(e.start.dateTime),t.startTime=this.$userutils.formatTime(e.start.dateTime);let s=a(e.start.dateTime).diff(a());s=s<0?e.end&&e.end.dateTime&&a().diff(e.end.dateTime)<0?"(now ongoing)":"":`(in ${this.$utils.formatTs(s)})`,t.remaining=s}if(e.end&&e.end.dateTime&&(t.endTime=this.$userutils.formatTime(e.end.dateTime)),e.attendees&&(t.attendees={total:e.attendees.length,yes:e.attendees.count(e=>"accepted"===(e.status||{}).response),no:e.attendees.count(e=>"notAccepted"===(e.status||{}).response),awaiting:e.attendees.count(e=>"needsAction"===(e.status||{}).response),tentative:e.attendees.count(e=>"tentative"===(e.status||{}).response),list:e.attendees.map(e=>{const{emailAddress:{address:t,name:s}}=e;return{email:t,displayName:s}})}),e.onlineMeetingUrl){let s=e.onlineMeetingUrl;s.lastIndexOf("/")>0&&(s=s.substring(s.lastIndexOf("/")+1)),t.videoCall={url:e.onlineMeetingUrl,name:s}}return t}openVideoCall(e){(0,v.Ls)(),e&&e.hangoutLink&&this.$jaBrowserExtn.openTab(e.hangoutLink)}viewRender(e){const{view:t}=e;this.startDate=t.activeStart,this.endDate=t.activeEnd,this.title=`Calendar - [${t.title.replace(/[^a-zA-Z0-9, /]+/g,"-")}]`,this.saveSettings({...this.state.settings,viewMode:t.type})}eventDrop(e){const{event:t,revert:s,jsEvent:i}=e,o=t.extendedProps.sourceObject,r=i.ctrlKey||i.altKey;if(!r&&o.isUploaded){const t=e.el.querySelector("i.fa-ellipsis-v");t&&(t.classList.replace("fa-ellipsis-v","fa-refresh"),t.classList.add("fa-spin")),s()}if(r){s();const e=this.state.events.first(e=>1===e.entryType&&e.id===t.id);if(e){const t=e.sourceObject;e.start=a(new Date(t.dateStarted)).toDate(),e.end=a(new Date(t.dateStarted)).add(this.$worklog.getTimeSpent(t),"minutes").toDate()}this.$worklog.copyWorklog(o,t.start).then(e=>{this.addEvent({added:e}),this.$analytics.trackEvent("Worklog quick copied",U.hB.UserActions,o.isUploaded?"Uploaded worklog":"Pending worklog")})}else{const s=o.dateStarted,i=O(this.state.zoomIn?5:15,t.start);this.$worklog.changeWorklogDate(o,i).then(e=>{this.$analytics.trackEvent("Worklog moved",U.hB.UserActions,o.isUploaded?"Uploaded worklog":"Pending worklog"),this.addEvent({previousTime:s,edited:e})}).finally(()=>{const t=e.el.querySelector("i.fa-refresh");t&&(t.classList.replace("fa-refresh","fa-ellipsis-v"),t.classList.remove("fa-spin"))})}}eventResize(e){const{event:t}=e;this.$worklog.changeWorklogTS(t.extendedProps.sourceObject,this.getEventDuration(t,!0)).then(e=>{this.addEvent({edited:e}),this.$analytics.trackEvent("Worklog resized",U.hB.UserActions,t.extendedProps.sourceObject.isUploaded?"Uploaded worklog":"Pending worklog")})}getEventDuration(e,t){if(e.end&&e.start){const s=t?O(this.state.zoomIn?5:15,e.end):e.end,i=a.duration(a(s).diff(e.start));return`${i.hours().pad(2)}:${i.minutes().pad(2)}`}if(e.extendedProps.sourceObject){const t=e.extendedProps.sourceObject,s=t.overrideTimeSpent||t.timespent;if(s&&~s.indexOf(":"))return s}return"00:00"}async uploadWorklog(e){if(this.setState({uploading:!0}),(0,v.Ls)(),e)try{const e=this.getPendingWorklogs().map(e=>e.sourceObject.id);await this.$worklog.uploadWorklogs(e),this.$message.success(`${e.length} worklog(s) uploaded successfully!`),this.$analytics.trackEvent("Worklog uploaded: All",U.hB.UserActions)}catch(t){(t.message||t.response)&&this.$message.error(t.message||t.response)}finally{this.refreshData()}else this.uploadSelectedWorklog(this.currentWLItem.id)}deleteWorklog(){(0,v.Ls)(),this.$worklog.deleteWorklog(this.currentWLItem).then(()=>{this.$analytics.trackEvent("Worklog deleted",U.hB.UserActions,this.currentWLItem.isUploaded?"Uploaded worklog":"Pending worklog"),this.addEvent({removed:this.currentWLItem.id,deletedObj:this.currentWLItem})})}copyWorklog(){(0,v.Ls)();const e=Object.create(this.currentWLItem);e.copy=!0,this.showWorklogPopup({copy:e})}getPendingWorklogs(e){return e||(e=this.state.events),e.filter(e=>1===e.entryType&&!e.sourceObject.isUploaded)}executeEvent(e){e.type!==i.v.AddWorklog&&e.type!==i.v.DeletedWorklog&&e.type!==i.v.WorklogModified||this.refreshData()}updateOpts(e,t){return this.fullCalendarOpts=this.getCalendarOptions({...e,...t}),t}renderCustomActions(){const{isGadget:e,state:{pendingWorklogCount:t,isLoading:s,uploading:i,fullView:o,zoomIn:a,settings:{viewMode:r}}}=this,n="timeGridWeek"===r||"timeGridDay"===r;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(f.$n,{text:!0,label:"Today",onClick:this.today,title:"Navigate to current week"}),n&&(0,S.jsx)(f.$n,{text:!0,type:"secondary",icon:o?"fa fa-compress":"fa fa-expand",onClick:this.toggleDisplayHours,title:o?"Click to show only working hours in calendar":"Click to show full day calendar"}),(0,S.jsx)(f.$n,{text:!0,onClick:this.toggleZoom,icon:a?"fa fa-search-minus":"fa fa-search-plus",title:a?"Zoom out to see 15 mins grid":"Zoom in to see 5 mins grid"}),!this.isGadget&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(f.$n,{text:!0,icon:"fa fa-arrow-left",onClick:()=>this.calendar.getApi().prev()}),(0,S.jsx)(f.$n,{text:!0,icon:"fa fa-arrow-right",onClick:()=>this.calendar.getApi().next()}),(0,S.jsx)(x.A,{dataset:R,value:r,valueField:"value",displayField:"label",style:{width:"120px"},onChange:this.viewModeChanged})]}),(0,S.jsxs)("span",{className:"info-badge",title:t?`Upload ${t} pending worklog(s)`:"No worklog pending to be uploaded",children:[t>0&&(0,S.jsx)("span",{className:"info bg-warning text-dark",children:t}),(0,S.jsx)(f.$n,{text:!0,type:"success",icon:i?"fa fa-spin fa-spinner":"fa fa-upload",disabled:i||t<1||s,onClick:()=>this.uploadWorklog(!0)})]}),(0,S.jsx)(f.$n,{text:!0,icon:"fa fa-refresh",disabled:s||i,onClick:this.refreshData,title:"Refresh meetings and worklogs"}),!e&&(0,S.jsx)(f.$n,{text:!0,icon:"fa fa-cogs",onClick:this.toggleSettingsDialog,title:"Show settings"})]})}render(){var e;const{hideWorklogDialog:t,addEvent:s,state:{showAddWorklogPopup:i,showSettingsPopup:o,worklogItem:a,events:r,showOpEvent:l,isLoading:d}}=this;return super.renderBase((0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(n.A,{ref:this.setCalRef,events:r,...this.fullCalendarOpts,eventContent:this.renderEventContent}),i&&(0,S.jsx)(y.A,{worklog:a,onDone:s,onHide:t}),o&&(0,S.jsx)(A,{settings:this.state.settings,onDone:this.saveSettings,onHide:this.toggleSettingsDialog}),(0,S.jsx)(k.j,{className:"op-event-details",ref:e=>{this.opEvent=e},showCloseIcon:!0,dismissable:!0,appendTo:document.body,onHide:this.hideOPEvent,children:l&&this.currentMeetingItem&&(0,S.jsx)(C,{eventDetails:this.currentMeetingItem,cut:this.$utils.cut})}),(0,S.jsx)(M,{enabled:!d&&this.context.needReload,onChange:this.refreshData},null===(e=this.context.timerEntry)||void 0===e?void 0:e.key)]}))}}V.contextType=L.dg;const G=V;function O(e,t){let s=(t=a(t)).minutes()%e;if(!s)return t.toDate();return s=s<=parseInt(e/2)?-s:15-s,t.add(s,"minutes").toDate()}function H({worklog:e,onUpload:t,onClone:s}){return(0,S.jsxs)("div",{className:"worklog-options",children:[!e.worklogId&&(0,S.jsx)("span",{className:"fa fa-upload",title:"Upload this worklog","event-icon":"true",onClick:s=>t(e.id)}),(0,S.jsx)("span",{className:"fa fa-clone",title:"Clone worklog to same time","event-icon":"true",onClick:t=>s(e)})]})}var z=s(4452),J=s(6904);class _ extends o.PureComponent{constructor(e){super(e),(0,g.WQ)(this,"JiraService","SessionService");const{epicNameField:t,storyPointField:s}=this.$session.CurrentUser;this.epicNameField=null===t||void 0===t?void 0:t.id,this.storyPointField=null===s||void 0===s?void 0:s.id;const i=["key","summary","project","status","parent","assignee","issuetype","reporter","created","changeLog","timeestimate","aggregatetimeestimate","timeoriginalestimate","aggregatetimeoriginalestimate"];this.epicNameField&&i.push(this.epicNameField),this.storyPointField&&i.push(this.storyPointField),this.fieldNames=i,this.state={}}componentDidMount(){this.fetchData()}UNSAFE_componentWillReceiveProps(e){const{jql:t}=e;this.jql!==(null===t||void 0===t?void 0:t.trim())&&this.fetchData()}async fetchData(){const{jql:e,setLoader:t}=this.props;if(this.jql=null===e||void 0===e?void 0:e.trim(),this.jql){t&&t(!0);try{const t=await this.$jira.searchTickets(e,this.fieldNames,0,{expand:["changelog"]}),s=(new Date).getTime(),i=t.map(e=>{const{key:t,changelog:{histories:i}={},fields:{summary:o,status:a,issuetype:n,assignee:l,reporter:d,created:c,project:h,parent:u,timeestimate:p,aggregatetimeestimate:m,timeoriginalestimate:g,aggregatetimeoriginalestimate:f,[this.epicNameField]:x,[this.storyPointField]:v}}=e,y=[];let k=i.length;for(;--k>=0;){const{created:e,items:t}=i[k];t.filter(e=>"status"===e.field).forEach(t=>{const{fromString:s,toString:i}=t;y.push({date:r()(e).toDate().getTime(),from:s,to:i})})}let j=r()(c).toDate().getTime();const w=y.length-1,S=y.reduce((e,t,i)=>{const{date:o,from:a,to:r}=t;return e[a]=(e[a]||0)+(o-j),j=o,w===i&&(e[r]=(e[r]||0)+(s-j)),e},{});return Object.keys(S).forEach(e=>{S[e]||delete S[e]}),{key:t,summary:o,status:a,issuetype:n,assignee:l,reporter:d,created:c,project:h,parent:u,timeestimate:p,aggregatetimeestimate:m,timeoriginalestimate:g,aggregatetimeoriginalestimate:f,statusData:S,changelog:y,epic:x,storyPoint:v}}),o=i.distinct(e=>e.project.key),a=await this.getStatuses(o);this.columnList=this.getFieldList(a),this.setState({reportData:i,statusList:a})}finally{t&&t(!1)}}else this.setState({reportData:[],statusList:[]})}getFieldList(e){const{onAddWorklog:t}=this.props;return[{field:"key",displayText:"Ticket No",type:"string",viewComponent:J.JA,props:{onAddWorklog:t}},{field:"summary",displayText:"Summary",type:"string"},{field:"project",fieldKey:"project.key",displayText:"Project",type:"string",viewComponent:J.qM},{field:"issuetype",fieldKey:"issuetype.name",displayText:"Issue Type",type:"string",viewComponent:J.mG},{field:"epic",displayText:"Epic",type:"string",viewComponent:J.JA,props:{hideWorklog:!0}},{field:"storyPoint",displayText:"Story Points",type:"number"},{field:"timeestimate",displayText:"Time Estimate",type:"number",viewComponent:J.g4},{field:"aggregatetimeestimate",displayText:"\u03a3 Time Estimate",type:"number",viewComponent:J.g4},{field:"timeoriginalestimate",displayText:"Original Estimate",type:"number",viewComponent:J.g4},{field:"aggregatetimeoriginalestimate",displayText:"\u03a3 Original Estimate",type:"number",viewComponent:J.g4},{field:"parent",fieldKey:"project.key",displayText:"Parent",type:"string",viewComponent:J.Ek,props:{onAddWorklog:t}},{field:"status",fieldKey:"status.name",displayText:"Status",type:"string",viewComponent:J.mG},{field:"created",displayText:"Created",type:"datetime",viewComponent:J.Hl},{field:"assignee",fieldKey:"assignee.displayName",displayText:"Assignee",type:"string",viewComponent:J.YP},{field:"reporter",fieldKey:"reporter.displayName",displayText:"Reporter",type:"string",viewComponent:J.YP},...e.map(e=>({field:`statusData.${e.name}`,displayText:`Spent on ${e.name}`,type:"number",viewComponent:J.g4,props:{inputType:"ticks",days:!0}}))]}async getStatuses(e){const t=await this.$jira.getProjectStatuses(e),s=[],i=[];return t.forEach(e=>{e.forEach(e=>{e.statuses.forEach(e=>{if(~s.indexOf(e.id))return;const{id:t,name:o,iconUrl:a}=e;s.push(t),i.push({name:o,iconUrl:a})})})}),i}render(){const{columnList:e,state:{loading:t,reportData:s},props:{settings:i,settingsChanged:o}}=this,{displayColumns:a,groupBy:r,groupFoldable:n,sortField:l,isDesc:d}=i||{};return(0,S.jsx)("div",{className:"statuswise-ts-grid",children:!t&&s&&(0,S.jsx)(z.A,{dataset:s,exportSheetName:"Status wise time spent",columns:e,allowSorting:!0,onChange:o,displayColumns:a,groupBy:r,groupFoldable:n,sortField:l,isDesc:d,noRowsMessage:"No ticket details available"})})}}const Q=_;var Y=s(8855);class q extends N.A{constructor(e){super(e,"Gadget configurations"),this.onDone=()=>{this.onHide(this.state.pageSettings)},this.onChange=e=>{let{pageSettings:t}=this.state;t={...t,jql:e},this.setState({pageSettings:t})},this.className="no-padding";const{pageSettings:t}=e;this.state={showDialog:!0,pageSettings:{...t}}}getFooter(){return(0,S.jsx)(f.$n,{icon:"fa fa-save",label:"Done",onClick:this.onDone})}render(){const{pageSettings:{jql:e}}=this.state;return super.renderBase((0,S.jsx)("div",{children:(0,S.jsx)(Y.A,{jql:e,onChange:this.onChange})}))}}const Z=q;class K extends m.Ay{constructor(e){super(e,"Status Wise Time Spent","fa-list-alt"),this.settingsChanged=e=>{this.pageSettingsChanged({gridSettings:e})},this.pageSettingsChanged=e=>{e&&(this.settings={...this.settings,...e},this.saveSettings()),this.setState({showSettings:!1,settings:e})},this.showSettings=()=>{this.setState({showSettings:!0})},this.setLoader=e=>{this.setState({isLoading:e})},this.refreshData=()=>{let{gridKey:e}=this.state;e++,this.setState({gridKey:e})},(0,g.WQ)(this,"SessionService","AnalyticsService"),this.state.gridKey=0}renderCustomActions(){return(0,S.jsx)(f.$n,{text:!0,icon:"fa fa-cogs",onClick:this.showSettings,title:"Show settings"})}render(){const{showSettings:e,gridKey:t}=this.state,{jql:s,gridSettings:i}=this.settings||{};return super.renderBase((0,S.jsxs)("div",{className:"status-wise-ts-gadget",children:[!s&&(0,S.jsxs)("div",{className:"no-jql",children:["No JQL was set to fetch the data. Click on ",(0,S.jsx)("span",{className:"fa fa-cogs"})," icon from top right corner of the gadget and modify the JQL to fetch data from Jira."]}),s&&(0,S.jsx)(Q,{setLoader:this.setLoader,jql:s,settings:i,settingsChanged:this.settingsChanged,onAddWorklog:this.addWorklogOn},t),e&&(0,S.jsx)(Z,{pageSettings:this.settings,onHide:this.pageSettingsChanged})]}))}}const X=K;var ee=s(5006),te=s(1427),se=s(3602);const ie=function(){return"Loading... Please wait..."};var oe=s(2492);const ae=function({lastUpdated:e,showContext:t,editWorklog:s,settings:i,setLoader:a}){const[r,n]=(0,o.useState)(!1),{$worklog:l,$utils:d,$userutils:c,$session:{CurrentUser:{maxHours:h}}}=(0,g.h1)("WorklogService","UtilsService","UserUtilsService","SessionService"),u=60*(h||8)*60;if((0,o.useEffect)(()=>{(async()=>{try{const e=i.dateRange;if(!e)return void n([]);const[t,s]=(0,se.f8)(e.quickDate)||[];if(t&&(e.fromDate=t,e.toDate=s),!e.fromDate)return void n([]);null===a||void 0===a||a(!0),e.dateWise=!0;const o=await l.getWorklogs(e);o.forEach(e=>e.rowClass=d.getRowStatus(e)),n(o)}finally{null===a||void 0===a||a(!1)}})()},[e]),!1===r)return(0,S.jsx)(ie,{});return(0,S.jsxs)(te.ew,{dataset:r,exportSheetName:"Datewise worklog",children:[(0,S.jsx)(te.D1,{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)(te.VP,{sortBy:"dateLogged",style:{width:"100px"},children:"Logged Date"}),(0,S.jsx)(te.VP,{sortBy:"totalHours",children:"Total Hours"}),(0,S.jsx)(te.VP,{sortBy:"uploaded",children:"Uploaded"}),(0,S.jsx)(te.VP,{sortBy:"pendingUpload",children:"Pending Upload"}),(0,S.jsx)(te.VP,{children:"Ticket List"})]})}),(0,S.jsx)(te.vc,{className:"no-log-bg-hl",children:e=>(0,S.jsxs)("tr",{onContextMenu:t?s=>t(s,e):void 0,className:e.rowClass,children:[(0,S.jsx)("td",{children:c.formatDate(e.dateLogged)}),(0,S.jsxs)("td",{className:"log-indi-cntr",children:[d.formatTs(e.totalHours),e.totalSecs>0&&(0,S.jsx)(oe.A,{value:e.totalSecs,maxHours:u})]}),(0,S.jsx)("td",{children:d.formatTs(e.uploaded)}),(0,S.jsx)("td",{children:d.formatTs(e.pendingUpload)}),(0,S.jsx)("td",{children:(0,S.jsx)("ul",{className:"tags",children:e.ticketList.map((e,t)=>{return(0,S.jsxs)("li",{children:[e.worklogId&&(0,S.jsxs)(w.A,{className:"link badge rounded-pill skin-bg-font",href:(i=e.ticketNo,o=e.worklogId,c.getWorklogUrl(i,o)),title:e.comment,children:[(0,S.jsx)("span",{className:"fa fa-clock"})," ",e.ticketNo,": ",e.uploaded]}),!e.worklogId&&(0,S.jsxs)("span",{className:"link badge rounded-pill skin-bg-font",onClick:s?()=>s(e.id):void 0,title:e.comment,children:[(0,S.jsx)("span",{className:"fa fa-clock"})," ",e.ticketNo,": ",e.uploaded]})]},t);var i,o})})})]},e.dateLogged)}),(0,S.jsx)(te.QC,{span:5,children:"No worklog exists for selected date range!"})]})};class re extends m.Ay{constructor(e){super(e,"Daywise worklog","fa-list-alt"),this.refreshData=async()=>this.setState({lastUpdated:new Date}),this.showContext=(e,t)=>{this.selectedDay=t,(0,v.O0)(e,this.contextMenu)},(0,ee.WQ)(this,"WorklogService","UtilsService","MessageService"),this.contextMenu=[{label:"Upload worklog",icon:"fa fa-clock",command:()=>this.uploadWorklog()},{label:"Add worklog",icon:"fa fa-bookmark",command:()=>this.addWorklog()}]}dateSelected(e){this.settings.dateRange=e,e.toDate&&(this.refreshData(),e.auto||this.saveSettings())}async uploadWorklog(){const e=this.selectedDay.ticketList.filter(e=>!e.worklogId).map(e=>e.id);if(0!==e.length){this.setState({isLoading:!0});try{await this.$worklog.uploadWorklogs(e),super.performAction(m.v8.WorklogModified)}catch(t){t.message&&this.$message.error(t.message)}finally{this.refreshData(),this.setState({isLoading:!1})}}}addWorklog(){let e=r()(this.selectedDay.dateLogged).toDate();r()(e).isSame(r()(),"day")&&(e=new Date);let t=null;this.selectedDay.pendingUpload>0&&(t=this.$utils.formatTs(this.selectedDay.pendingUpload,!0)),super.addWorklog({startTime:e,timeSpent:t,allowOverride:!!t})}executeEvent(e){e.type!==m.v8.AddWorklog&&e.type!==m.v8.DeletedWorklog&&e.type!==m.v8.WorklogModified||this.refreshData()}renderCustomActions(){return(0,S.jsx)(f.lr,{range:!0,value:this.settings.dateRange,onChange:e=>this.dateSelected(e),style:{marginRight:"35px"}})}render(){var e;const{state:{isLoading:t,lastUpdated:s}}=this;return super.renderBase((0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ae,{lastUpdated:s,settings:this.settings,showContext:this.showContext,editWorklog:this.editWorklog,setLoader:this.setLoader}),(0,S.jsx)(M,{enabled:!t&&this.context.needReload,onChange:this.refreshData},null===(e=this.context.timerEntry)||void 0===e?void 0:e.key)]}))}}re.contextType=L.dg;const ne=re;var le=s(3623),de=s(2591);N.A;o.PureComponent;o.PureComponent;o.PureComponent;o.PureComponent;o.PureComponent;m.Ay;const ce=function(e={}){"function"===typeof e&&(e=e(e));const t=(0,o.createContext)(e),s=t.Provider;let i=function(){},a=function(){};function r(e){i(e)}function n(e){const t=a();if(t)return e?t[e]:t}function l({children:t,initialData:r,...n}){const[l,d]=(0,o.useState)(()=>({...e,...r,...n}));return i=e=>d("function"===typeof e?e:t=>({...t,...e})),a=()=>l,(0,S.jsx)(s,{value:l,children:t})}function d(e,s,i,a){if(i=i?Object.keys(i).reduce((e,t)=>(e[t]=i[t](r,n),e),{}):{},a&&a.length){const e=a[a.length-1];if("function"===typeof e){const t=(0,g.WQ)(a.slice(0,a.length-1));i={...i,...e(t)}}else{const e=(0,g.WQ)(a);i={...i,...e}}}return function(a){const r=(0,o.useContext)(t),n=s?s(r,a):void 0;return(0,S.jsx)(e,{...n,...a,...i})}}return{DataProvider:l,withProvider:function(e,t,s,i,a){return(t||s)&&(e=d(e,t,s,i)),a?function(t){const[s,i]=(0,o.useState)(!1),[r,n]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{!async function(e){let s=a(t);null!==(e=s)&&void 0!==e&&e.then&&(s=await s),n(s),i(!0)}()},[]),s?(0,S.jsx)(l,{initialData:r,children:(0,S.jsx)(e,{...t})}):null}:function(t){return(0,S.jsx)(l,{children:(0,S.jsx)(e,{...t})})}},connect:d}},he={userListMode:"2",timeframeType:"2",userGroups:[],reportUserGrp:"1",dateRange:{},logFormat:"2",breakupMode:"1",userDisplayFormat:"1",fields:{},daysToHide:"1",rIndicator:"1",timeZone:"1",expandUsers:!1,splitWorklogDays:!1,sprintStartRounding:"1",sprintEndRounding:"1",jql:"",logFilterType:"1",filterThrsType:"1",filterDays:5,filterDate:new Date,wlDateSelection:"1",loadingData:!1,reportLoaded:!1,disableAddingWL:!1,selSprints:{},sprintBoards:[],sprintList:{},allSprints:{},sprints:[],userExpnState:{}},{withProvider:ue,connect:pe}=ce(he);function me(e,t){if(!e)return{};const{userListMode:s,timeframeType:i,reportUserGrp:o,dateRange:a,logFormat:n,breakupMode:l,timeZone:d,sprintStartRounding:c,sprintEndRounding:h,userDisplayFormat:u,fields:p,daysToHide:m,rIndicator:g,expandUsers:f,splitWorklogDays:x,jql:v,logFilterType:y,filterThrsType:k,filterDays:j,filterDate:w,wlDateSelection:S,sprintBoards:b,sprintList:C,selSprints:N={},userGroups:T,flatTableSettings:D}=e,$=fe({userListMode:s,timeframeType:i,reportUserGrp:o,dateRange:a,logFormat:n,breakupMode:l,timeZone:d,sprintStartRounding:c,sprintEndRounding:h,userDisplayFormat:u,fields:p,daysToHide:m,rIndicator:g,expandUsers:f,splitWorklogDays:x,jql:v,logFilterType:y,filterThrsType:k,filterDays:j,filterDate:w,wlDateSelection:S,sprintBoards:b,sprintList:C,selSprints:N,flatTableSettings:fe(D)});return w&&r()(w).isSame(new Date,"day")&&delete $.filterDate,null!==t&&void 0!==t&&t.incUserGroups&&($.userGroups=T),$}function ge({sprintBoards:e,sprintList:t}){if(!e||!t)return{sprints:[],allSprints:{}};return{sprints:e.map(e=>{var s;return{label:e.name,isGroup:!0,items:null===(s=t[e.id])||void 0===s?void 0:s.map(({name:e,id:t})=>({value:t,label:e}))}}),allSprints:Object.keys(t).reduce((e,s)=>{var i;return null===(i=t[s])||void 0===i||i.forEach(t=>e[t.id]=t),e},{})}}function fe(e){return"object"!==typeof e||Object.keys(e).forEach(t=>{"undefined"===typeof e[t]&&delete e[t]}),e}var xe=s(158);function ve(e,t,s){const i=["summary","worklog","issuetype","parent","project","status","assignee","reporter"];if(e){var o;const a=e.fields.hideEstimate;let r=(null===(o=e.jql)||void 0===o?void 0:o.trim())||"";if(r){const{projects:e,users:t}=s||{};r=r.replace(/\$selectedProjects\$|\$selProjects\$/gi,`"${(null===e||void 0===e?void 0:e.join('", "'))||""}"`).replace(/\$selectedUsers\$|\$selUsers\$/gi,`"${(null===t||void 0===t?void 0:t.join('", "'))||""}"`),r=` AND (${r})`}a||(i.push("aggregatetimespent"),i.push("timeoriginalestimate"),i.push("timeestimate")),t&&i.push(t);const n=e.fields.optional;return Array.isArray(n)&&n.length&&n.forEach(({key:e})=>i.push(e)),{fieldsToFetch:i.distinct(),additionalJQL:r}}return{fieldsToFetch:i}}function ye(e,t,s){return t.union(t=>t.users.union(i=>{var o,a;return(null===(o=e[(0,j.J3)(i,!0)])||void 0===o||null===(a=o.logData)||void 0===a?void 0:a.map(function(e,t,s){const{$userutils:{getTicketUrl:i}}=(0,g.WQ)("UserUtilsService"),o=e.displayName;return a=>({groupName:t,sprintName:s,username:(0,j.J3)(e),userDisplay:o,fields:a.fields,assignee:a.assignee,reporter:a.reporter,parent:a.parent,parentSummary:a.parentSummary,parentUrl:a.parent?i(a.parent):null,epicDisplay:a.epicDisplay,epicUrl:a.epicUrl,ticketNo:a.ticketNo,ticketUrl:a.url,issueType:a.issueType,summary:a.summary,projectKey:a.projectKey,projectName:a.projectName,statusName:a.statusName,logTime:a.logTime,logCreated:a.logCreated,logUpdated:a.logUpdated,timeSpent:a.totalHours,originalestimate:a.originalestimate,remainingestimate:a.remainingestimate,totalLogged:a.totalLogged,estVariance:a.estVariance,comment:(0,xe.p)(a.comment)})}(i,t.name,s)))||[]}))}function ke({projects:e,userListMode:t},s){if((s||"3"===t||"4"===t)&&Array.isArray(e))return e.map(({key:e})=>null===e||void 0===e?void 0:e.toUpperCase()).distinct().filter(Boolean)}function je(e,t){const{userGroups:s,userListMode:i}=e;if(!t&&"2"!==i&&"4"!==i)return;return s.union(e=>(e.users.forEach(t=>t.groupName=e.name),e.users)).map(e=>(0,j.J3)(e,!0)).distinct()}async function we(e,t){if(t){const{$ticket:i,$message:o}=(0,g.WQ)("MessageService","TicketService");try{const s=e.distinct(({fields:{[t]:e}})=>e).filter(Boolean);return await i.getTicketDetails(s,!1,["summary","issuetype"])}catch(s){return o.error("Epic fetch failed",`Error Message: ${s.message}`),{}}}}function Se(e,t,s,i,o,a){var n;const l=(0,g.WQ)("UserUtilsService","SessionService"),d={epicNameField:null===(n=l.$session.CurrentUser.epicNameField)||void 0===n?void 0:n.id,epicDetails:a,...l},c=function(e,t,s){const{logFilterType:i,filterThrsType:o,filterDays:a,wlDateSelection:n}=s;let{filterDate:l}=s;"1"===o?l=null:"2"===o&&(l=r()(t).clone().add(a,"days")),l&&(l=r()(l).endOf("day"));const d=s=>r()(s.started).isBetween(e,t,void 0,"[]");if("1"===i)return d;{const e="2"===i,t="2"!==n;return function(s){if(!d(s))return!1;const i=l||r()(s.started).add(a,"days").endOf("day");return e===r()(t&&s.updated||s.created).isBefore(i)}}}(t,s,o),h={};if(e.forEach(e=>{var t;const s=e.fields||{},o=(null===(t=s.worklog)||void 0===t?void 0:t.worklogs)||[],a=s.aggregatetimespent||0,n=s.timeoriginalestimate||0,l=s.timeestimate||0,u={originalestimate:n,remainingestimate:l,totalLogged:a,estVariance:n>0?l+a-n:0};o.forEach(t=>{if(!c(t))return;const o=(0,j.J3)(t.author,!0),a=o===i;let n=h[o];n||(n={logData:[],userName:o,isCurrentUser:a,...t.author},h[o]=n);const l=function(e,t,s,i,{epicNameField:o,epicDetails:a,$userutils:n}){var l,d,c,h,u,p,m,g;const f={fields:t,ticketNo:e.key,epicDisplay:null,epicUrl:null,url:n.getTicketUrl(e.key),issueType:null===(l=t.issuetype)||void 0===l?void 0:l.name,iconUrl:null===(d=t.issuetype)||void 0===d?void 0:d.iconUrl,parent:null===(c=t.parent)||void 0===c?void 0:c.key,parentSummary:null===(h=t.parent)||void 0===h||null===(u=h.fields)||void 0===u?void 0:u.summary,assignee:null===(p=t.assignee)||void 0===p?void 0:p.displayName,reporter:null===(m=t.reporter)||void 0===m?void 0:m.displayName,summary:t.summary,logTime:r()(s.started).toDate(),logCreated:r()(s.created).toDate(),logUpdated:r()(s.updated||s.created).toDate(),comment:s.comment,projectName:t.project.name,statusName:null===(g=t.status)||void 0===g?void 0:g.name,projectKey:t.project.key,totalHours:s.timeSpentSeconds,...i};if(o){const e=t[o];if("string"===typeof e&&e.includes("-")){f.epicKey=e;const t=a[e];if(null!==t&&void 0!==t&&t.fields){const{key:e,fields:{summary:s,issuetype:{iconUrl:i}}}=t;f.epicDisplay=`${e} - ${s}`,f.epicIcon=i}f.epicUrl=n.getTicketUrl(e)}else f.epicDisplay=e}return f}(e,s,t,u,d);n.logData.push(l)})}),"2"===o.userListMode){const e=je(o);Object.keys(h).forEach(t=>{e.includes(t)||delete h[t]})}else if("4"===o.userListMode){const e=ke(o),t=je(o);Object.keys(h).filter(e=>!t.includes(e)).forEach(t=>{const s=h[t];let{logData:i}=s;i=i.filter(t=>{var s;return e.includes(null===(s=t.projectKey)||void 0===s?void 0:s.toUpperCase())}),i.length?s.logData=i:delete h[t]})}return{userwiseLog:h,userwiseLogArr:Object.keys(h).map(e=>{const t=h[e];return t.totalHours=t.logData.sum(e=>e.totalHours),t}).sortBy(e=>e.displayName)}}function be(e){return e.groupBy(e=>`${e.month}_${e.week}`).map(({values:e})=>{const t=e.length;let s="";const{0:{week:i,dispFormat:o,dateNum:a},[t-1]:{dateNum:r}}=e;return s=t>4?`${o}, ${a} to ${r} (W-${i})`:t>3?`${o}, ${a}-${r}`:t>2?`${o.split(" ")[0]} (W-${i})`:o.split(" ")[0],{display:s,days:t}})}function Ce(e,t,s){const i=(0,g.WQ)("UtilsService","UserUtilsService","SessionService"),{maxHours:o,minHours:a=o}=i.$session.CurrentUser,n=60*(o||8)*60,l=60*(a||8)*60,{timeZone:d,fromDate:c,toDate:h}=s;let{dates:u,daysToHide:p}=s;if(u)p=!1;else{const e=i.$utils.getDateArray(c,h);u=e.map(e=>({prop:e.format("yyyyMMdd"),date:e,dispFormat:e.format("MMM yyyy").toUpperCase(),month:e.getMonth(),week:r()(e).week(),dayOfWeek:r()(e).day(),day:e.format("DD").toUpperCase(),dateNum:e.getDate(),isHoliday:i.$userutils.isHoliday(e)}))}const m=parseInt(d),f=t.map(t=>{const s={name:t.name,total:{},totalCost:{},grandTotal:0,grandTotalCost:0,users:null};t.isDummy&&(s.isDummy=t.isDummy),s.users=t.users.map(s=>{let o=null;2===m?o=t.timeZone:3===m&&(o=s.timeZone||t.timeZone),"GRP_TZ"===o&&(o=t.timeZone);const a={name:(0,j.J3)(s),displayName:s.displayName,emailAddress:s.emailAddress,timeZone:o,imageUrl:s.avatarUrls["48x48"]||s.avatarUrls["32x32"],profileUrl:i.$userutils.getProfileUrl(s),costPerHour:s.costPerHour},d={...a,tickets:null,total:{},totalCost:{},logClass:{},grandTotal:0,grandTotalCost:0},c=e[s.userName||(0,j.J3)(s,!0)]||{};c.isCurrentUser&&(d.isCurrentUser=!0);const h=c.logData||[],p={};d.ticketsMap=p,d.tickets=h.groupBy(e=>e.ticketNo).map(e=>{const t=e.values,i=t.first(),n={},l={fields:{...i.fields,worklogUser:a},ticketNo:e.key,parent:i.parent,parentUrl:i.parent?(0,j._8)(i.parent):null,parentSummary:i.parentSummary,projectKey:i.projectKey,projectName:i.projectName,assignee:i.assignee,reporter:i.reporter,epicDisplay:i.epicDisplay,epicUrl:i.epicUrl,issueType:i.issueType,iconUrl:i.iconUrl,statusName:i.statusName,summary:i.summary,originalestimate:i.originalestimate,remainingestimate:i.remainingestimate,totalLogged:i.totalLogged,estVariance:i.estVariance,url:i.url,logs:n,totalHours:0,totalCost:0};p[l.ticketNo]=l;let d=0;return t.forEach(e=>{let t=e.logTime;o&&(t=r()(r()(t).tz(o).format("YYYY-MM-DD HH:mm:ss")).toDate());const i=t.format("yyyyMMdd");let a=n[i];a||(a=[],n[i]=a),a.push({logTime:t,totalHours:e.totalHours,totalCost:(0,j.yP)(e.totalHours,s.costPerHour),comment:e.comment}),d+=e.totalHours}),l.totalHours=d,l.totalCost=(0,j.yP)(d,s.costPerHour),l}),function(e,t){var s;const i=e.tickets;i.forEach(e=>{const{logs:s}=e;e.worklogStartIndex=t.findIndex(e=>!!s[e.prop])}),e.tickets=i.orderBy(e=>e.worklogStartIndex),e.firstWorklogStartIndex=null===(s=e.tickets[0])||void 0===s?void 0:s.worklogStartIndex}(d,u);const g=d.logClass,f=d.total,x=d.totalCost;let v=0;return u.forEach(e=>{const t=d.tickets.sum(t=>{const s=t.logs[e.prop];return s?s.sum(e=>e.totalHours):0});t>0&&(f[e.prop]=t,x[e.prop]=(0,j.yP)(t,s.costPerHour),v+=t),g[e.prop]=function(e,t,s,i){if(t=t>0?t:0,e.isHoliday)return t?"log-high":"col-holiday";if(t>=i&&t<=s)return"log-good";if(t<i)return"log-less";if(t>s)return"log-high"}(e,t,n,l)}),d.grandTotal=v,d.grandTotalCost=(0,j.yP)(v,s.costPerHour),d}).orderBy(e=>e.firstWorklogStartIndex),s.usersMap=s.users.reduce((e,t)=>(e[t.name]=t,e),{});const o=s.total,a=s.totalCost;let d=0,c=0;return u.forEach(e=>{const t=s.users.sum(t=>t.total[e.prop]||0);t>0&&(o[e.prop]=t,d+=t);const i=s.users.sum(t=>t.totalCost[e.prop]||0);i>0&&(a[e.prop]=i,c+=i)}),s.grandTotal=d,s.grandTotalCost=c,s});let x=0,v=0;const y={},k={};return u.forEach(e=>{const t=f.sum(t=>t.total[e.prop]||0);t>0&&(y[e.prop]=t,x+=t),e.hasWorklogs=e.hasWorklogs||t>0;const s=f.sum(t=>t.totalCost[e.prop]||0);s>0&&(k[e.prop]=s,v+=s)}),f.grandTotal=x,f.grandTotalCost=v,f.total=y,f.totalCost=k,u=Ne(p,u),{groupedData:f,weeks:be(u),dates:u}}function Ne(e,t){if(!e||"1"===e)return t;const s="3"===e;return"2"===e||s?t.filter(e=>e.hasWorklogs||!s&&!e.isHoliday):t}function Te(e,t){return async function(){const s={loadingData:!1};try{e({loadingData:!0,errorTitle:"",errorMessage:""});const{dateRange:{fromDate:i,toDate:o}}=t();if(!i||!o)return null;const a=await async function(e,t,s){const{$session:{CurrentUser:{name:i,epicNameField:o}}}=(0,g.WQ)("SessionService"),a=await async function(e,t,s,i){const o=(0,g.WQ)("JiraService"),{fieldsToFetch:a,additionalJQL:r}=ve(s,i,{projects:ke(s,!0),users:je(s,!0)}),n=je(s),l=ke(s);if(0===(null===n||void 0===n?void 0:n.length)||0===(null===l||void 0===l?void 0:l.length))throw Error("Either userlist or project is required for generating worklog report");const d=n?`worklogAuthor in ("${n.join('","')}")`:"",c=l?`project in ("${l.join('","')}")`:"",h=d||c?`(${d}${d&&c?" OR ":""}${c}) AND `:"",u=`(worklogDate >= '${e.clone().add(-1,"days").format("YYYY-MM-DD")}' and worklogDate < '${t.clone().add(1,"days").format("YYYY-MM-DD")}') `,p=`${h}${u}${r}`;return await o.$jira.searchTickets(p,a,0,{worklogStartDate:e.toDate(),worklogEndDate:t.toDate()})}(e,t,s,null===o||void 0===o?void 0:o.id);if(!a.length)return;const r=await we(a,null===o||void 0===o?void 0:o.id),n=We(a,e,t,null===i||void 0===i?void 0:i.toLowerCase(),s,r),l=function(e,t){const{userwiseLog:s,userwiseLogArr:i,settings:o}=e,a=[Ue(i)],r=Ce(s,a,o),n=function(e,t){const{dates:s,groupedData:i,weeks:o}=e;let a=i.flatMap(e=>e.users.flatMap(e=>e.tickets));return a=t.splitWorklogDays?a.flatMap(e=>{const{logs:t,fields:s}=e;return Object.keys(t).map(i=>{const o=t[i],{logTime:a}=o[0],r=`${a.format("yyyyMMddHHmm")}_${e.ticketNo}`;return{...e,fields:{...s,logDateTime:a},logs:{[i]:o},worklogStartIndex:r}})}).orderBy(e=>e.worklogStartIndex):a.orderBy(e=>e.worklogStartIndex.pad(5)+e.ticketNo),{dates:s,weeks:o,issuesList:a}}(r,t);return n}(n,s),{userListMode:d,userGroups:c,reportUserGrp:h}=s,u="2"===d&&"1"===h;if(u||"1"===h){const e=$e(n,s,u&&c);return e.issueDayWise=l,e}{const{groupByFunc:n,getGroupName:d}=function(e,t,s){return"3"===e?{getGroupName:e=>{const{name:t}=e[0].fields.issuetype;return t},groupByFunc:e=>e.fields.issuetype.id}:"4"===e&&t?{getGroupName:e=>{var i;const o=e[0].fields[t],a=o&&(null===s||void 0===s||null===(i=s[o])||void 0===i?void 0:i.fields.summary);return(a?`${o} - ${a}`:o)||"<Issues without epic>"},groupByFunc:e=>e.fields[t]}:{getGroupName:e=>{const{name:t,key:s}=e[0].fields.project;return`${t} (${s})`},groupByFunc:e=>e.fields.project.key}}(h,null===o||void 0===o?void 0:o.id,r),p=[],m=a.groupBy(n).map(({values:e})=>({issues:e,grpName:d(e)})).sortBy(({grpName:e})=>e).reduce((o,{grpName:a,issues:n})=>{const l=We(n,e,t,null===i||void 0===i?void 0:i.toLowerCase(),s,r,o.dates),{flatWorklogs:d,groupReport:{dates:h,groupedData:m}}=$e(l,s,u&&c,a);if(o.dates=h,!m.grandTotal)return o;p.addRange(d);const[g]=m;g.name=a,delete g.isDummy;const{groupedData:f}=o;return f.push(g),f.grandTotal=(f.grandTotal||0)+(m.grandTotal||0),f.grandTotalCost=(f.grandTotalCost||0)+(m.grandTotalCost||0),f.total=De(f.total,m.total),f.totalCost=De(f.totalCost,m.totalCost),o},{groupedData:[]});return m.dates=Ne(s.daysToHide,m.dates),m.weeks=be(m.dates),{flatWorklogs:p,groupReport:m,issueDayWise:l}}}(r()(i).startOf("day"),r()(o).endOf("day"),t());if(!a){const{$message:e}=(0,g.WQ)("MessageService");return void e.warning("No worklog information returned matching your filters","No data available")}const{groupReport:n,flatWorklogs:l,issueDayWise:d}=a;s.groupReport=n,s.flatWorklogs=l,s.issueDayWise=d,s.reportLoaded=!0}catch(a){var i,o;console.error("Error pulling range report:",a);const{$message:t}=(0,g.WQ)("MessageService"),s=a.message||(null===(i=a.error)||void 0===i||null===(o=i.errorMessages)||void 0===o?void 0:o[0])||"Unknown error. Check the console for more details",r=a.message?"Worklog report":"Unknown error";e({errorTitle:r,errorMessage:s}),t.error(s,r)}finally{e(s)}}}function De(e,t){if(e){if(t){const s={...e};return Object.keys(t).forEach(e=>{s[e]=(s[e]||0)+(t[e]||0)}),s}return e}return t}function $e(e,t,s,i){const{userwiseLog:o,userwiseLogArr:a,settings:r}=e;s||(s=[Ue(a,i)]);return{groupReport:Ce(o,s,r),flatWorklogs:ye(o,s)}}function We(e,t,s,i,o,a,r){const{userwiseLog:n,userwiseLogArr:l}=Se(e,t,s,i,o,a);return{userwiseLog:n,userwiseLogArr:l,settings:{fromDate:t.toDate(),toDate:s.toDate(),timeZone:o.timeZone,dates:r,daysToHide:r?null:o.daysToHide}}}const Ae="";function Ue(e,t){const s=e.reduce((e,t)=>(e.totalHours+=t.totalHours||0,e.totalCost+=t.totalCost||0,e),{totalHours:0,totalCost:0});return{isDummy:!0,name:t||Ae,users:e,...s}}function Le(e,t,s,{userListMode:i,userGroups:o},a){const r=function(e,t){return e.map(e=>{const{id:s,name:i}=e,{dates:o}=t[`groupReport_${s}`];return{id:s,name:Ee(i,e.settings),days:o.length}})}(e,t);function n(e,s){const{grandTotalHours:i,grandTotalCost:o,users:a,usersMap:n}=function(e,t,s){let i=0,o=0;const a=e.sortBy(e=>e.displayName).map(e=>{const a=[],r={},n={...e,tickets:a,allSprintTotalCost:0,allSprintTotalHours:0},l=(0,j.J3)(n);for(const i of t){const{groupedData:[e]}=s[`groupReport_${i.id}`],{tickets:t,grandTotal:o,grandTotalCost:d}=e.usersMap[l]||{tickets:[]};o&&(n.allSprintTotalHours+=o),d&&(n.allSprintTotalCost+=d);for(const s of t){const{ticketNo:e}=s,t=r[e];t?(s.totalHours&&(t.grandTotalHours+=s.totalHours),s.totalCost&&(t.grandtotalCost+=s.totalCost)):(a.push(s),r[e]=s,s.allSprintTotalHours=s.totalHours,s.allSprintTotalCost=s.totalCost)}}return i+=n.allSprintTotalHours,o+=n.allSprintTotalCost,n});return{grandTotalHours:i,grandTotalCost:o,users:a}}(s,r,t);return{name:e,users:a,usersMap:n,grandTotalHours:i,grandTotalCost:o,sprints:r}}return"2"===i?o.map(e=>n(e.name,e.users)):[n("Sprint",s)]}function Ie(e,t,s){var i;const{range:o,custom:a}=t[e],r=null===(i=s[e])||void 0===i?void 0:i.sortBy(({startDate:e})=>new Date(e).getTime(),!0);switch(o){case-1:return r.filter(e=>a[e.id]).reverse();case 0:return[r[0]].filter(Boolean);case 1:const e=r[0];return[e.completeDate?e:r[1]].filter(Boolean);default:return r.slice(0,o).reverse()}}async function Me(e,t,s,i){var o;const{$jira:a,$session:{CurrentUser:{epicNameField:r}}}=(0,g.WQ)("JiraService","SessionService"),{fieldsToFetch:n}=ve(i,null===r||void 0===r?void 0:r.id),l={maxResults:1e3,fields:n,worklogStartDate:t,worklogEndDate:s};var d;null!==(o=i.jql)&&void 0!==o&&o.trim()&&(l.jql=null===(d=i.jql)||void 0===d?void 0:d.trim());const c=await a.getSprintIssues(e,l);return{issues:c,epicDetails:c.length>0&&await we(c,null===r||void 0===r?void 0:r.id)}}function Re(e,t,s,i){const{userListMode:o,userGroups:a}=i,r="2"===o?a:function(e,t,s){return[{name:Ee(e.name,s),users:Object.keys(t).map(e=>t[e])}]}(e,t,s);return{groupReport:Ce(t,r,s),flatWorklogs:ye(t,r,e.name)}}function Ee(e,t){if(null===t||void 0===t||!t.fromDate)return e;const{fromDate:s,toDate:i}=t,{$userutils:o}=(0,g.WQ)("UserUtilsService");return`${e} (${o.formatDateTime(s)} - ${o.formatDateTime(i)})`}function Fe(e){return function(t){e(t)}}function Pe(e,t){const{$utils:{convertSecs:s}}=(0,g.WQ)("UtilsService");return e=>e||0===e?s(e,{format:"1"===t("logFormat")}):e}const Be=["date","datetime","string","number"],Ve=["project","issuetype","parent","status","assignee","reporter","comment"];function Ge(e){return function(t,s){e({[t]:s})}}function Oe(e,t,s,i,o){return(0,S.jsx)("input",{type:"radio",className:"form-check-input",name:e,checked:s===t,onChange:()=>i(e,t),...o})}function He({sprintBoards:e,selSprints:t,setValue:s,onChange:i}){const a=(0,o.useRef)(null),r=(0,o.useRef)(!0),{current:n}=r;(0,o.useEffect)(()=>{r.current=!1,!n&&(null===i||void 0===i||i())},[t]);const l=!(null===e||void 0===e||!e.length),[d,c]=(0,o.useState)(t),h=(e,t,s)=>c({...d,[t]:{range:0,custom:[],...d[t],selected:e,name:s}}),u=l?(e,t)=>c(t):void 0,p=l&&d!==t?()=>{Object.keys(d).forEach(e=>{const t=d[e];-1!==t.range||Object.keys(t.custom||{}).length||delete d[e]}),s("selSprints",d)}:void 0;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("span",{className:"link margin-r-8",title:"Click to choose list of sprints",onClick:e=>a.current.toggle(e),children:"Choose sprint"}),(0,S.jsxs)(k.j,{ref:a,showCloseIcon:!0,id:"overlay_panel",style:{width:"450px"},onHide:p,className:"op-sprint-list",children:[!l&&(0,S.jsxs)("div",{className:"pad-22 no-boards-message",children:[(0,S.jsx)("span",{className:"fa fa-exclamation-triangle warn"})," No agile boards selected. Click ",(0,S.jsx)("span",{className:"fa fa-cogs"})," icon to choose one or more agile boards."]}),l&&(0,S.jsx)("div",{className:"board-list",children:(0,S.jsxs)("table",{className:"board-list-table",children:[(0,S.jsx)("thead",{children:(0,S.jsx)("tr",{children:e.map(e=>{var t;return(0,S.jsx)("th",{children:(0,S.jsx)("div",{children:(0,S.jsx)(f.Sc,{label:e.name,field:e.id,args:e.name,checked:null===(t=d[e.id])||void 0===t?void 0:t.selected,onChange:h})})},e.id)})})}),(0,S.jsx)("tbody",{children:(0,S.jsx)("tr",{children:e.map(e=>{var t;return(0,S.jsx)("td",{className:"board-col",children:(0,S.jsx)(Je,{board:e,selSprints:d,setValue:u,disabled:!(null!==(t=d[e.id])&&void 0!==t&&t.selected)})},e.id)})})})]})})]})]})}const ze=pe(o.memo(He),({selSprints:e,sprintBoards:t})=>({selSprints:e,sprintBoards:t}),{setValue:Ge});function Je({board:e,selSprints:t,disabled:s,setValue:i}){var a;const[r,n]=(0,o.useState)(-1===(null===(a=t[e.id])||void 0===a?void 0:a.range)),l=e=>{e<0&&n(!0),d(null,null,e)},d=(s,o,a)=>{const r={...t[e.id],range:a};o>0&&(r.custom={...r.custom,[o]:s},s||delete r.custom[o]),i("selSprints",{...t,[e.id]:r})};return r?(0,S.jsxs)("div",{className:"sprint-custom-cntr",children:[(0,S.jsx)(_e,{boardId:e.id,selSprints:t,onChange:d,disabled:s}),(0,S.jsx)("div",{children:(0,S.jsx)("span",{className:"link",onClick:()=>n(!1),children:" Back"})})]}):(0,S.jsxs)("div",{className:"sprint-range",children:[(0,S.jsx)("div",{children:(0,S.jsx)(f.a,{label:"Last sprint",defaultValue:0,value:null===(c=t[e.id])||void 0===c?void 0:c.range,onChange:l,disabled:s})}),(0,S.jsx)("div",{children:(0,S.jsx)(f.a,{label:"Last closed sprint",defaultValue:1,value:null===(h=t[e.id])||void 0===h?void 0:h.range,onChange:l,disabled:s})}),(0,S.jsx)("div",{children:(0,S.jsx)(f.a,{label:"Last 2 sprints",defaultValue:2,value:null===(u=t[e.id])||void 0===u?void 0:u.range,onChange:l,disabled:s})}),(0,S.jsx)("div",{children:(0,S.jsx)(f.a,{label:"Last 3 sprints",defaultValue:3,value:null===(p=t[e.id])||void 0===p?void 0:p.range,onChange:l,disabled:s})}),(0,S.jsx)("div",{children:(0,S.jsx)(f.a,{label:"Last 4 sprints",defaultValue:4,value:null===(m=t[e.id])||void 0===m?void 0:m.range,onChange:l,disabled:s})}),(0,S.jsx)("div",{children:(0,S.jsx)(f.a,{label:"Last 5 sprints",defaultValue:5,value:null===(g=t[e.id])||void 0===g?void 0:g.range,onChange:l,disabled:s})}),(0,S.jsx)("div",{children:(0,S.jsx)(f.a,{label:"Custom",defaultValue:-1,value:null===(x=t[e.id])||void 0===x?void 0:x.range,onChange:l,disabled:s})})]});var c,h,u,p,m,g,x}const _e=pe(function({boardId:e,selSprints:t,getRapidSprintList:s,onChange:i,disabled:a}){var r;const[n,l]=(0,o.useState)(!1),[d,c]=(0,o.useState)([]);(0,o.useEffect)(()=>{!async function(){try{l(!0);const t=await s([e]);c(t)}catch(t){console.error("Error pulling sprint for board:",e,t)}finally{l(!1)}}()},[e,s]);const h=(null===(r=t[e])||void 0===r?void 0:r.custom)||{};return(0,S.jsxs)("div",{className:"sprints-custom",children:[n&&(0,S.jsx)("span",{children:"Loading..."}),d.map((e,t)=>(0,S.jsx)("div",{children:(0,S.jsx)(f.Sc,{label:e.name,checked:!!h[e.id],field:e.id,args:-1,onChange:i,disabled:a})},t))]})},null,null,["JiraService",({$jira:{getRapidSprintList:e}})=>({getRapidSprintList:e})]),Qe=pe(function({userListMode:e,timeframeType:t,showGroupsPopup:s,onInputChanged:i}){return(0,S.jsxs)(S.Fragment,{children:["1"===t&&(0,S.jsx)(ze,{onChange:i}),"2"===t&&(0,S.jsx)(Ye,{onChange:i}),("2"===e||"4"===e)&&(0,S.jsx)(f.$n,{text:!0,icon:"fa fa-users",onClick:s,title:"Add users / groups to report"})]})},({userListMode:e,timeframeType:t})=>({userListMode:e,timeframeType:t})),Ye=pe(function({dateRange:e,onChange:t,setValue:s}){const i=(0,o.useRef)(!0),{current:a}=i;return(0,o.useEffect)(()=>{i.current=!1,!a&&(null===t||void 0===t||t())},[e]),(0,S.jsx)(f.lr,{value:e,range:!0,onChange:e=>s("dateRange",e),style:{marginRight:"35px"}})},({dateRange:e})=>({dateRange:e}),{setValue:Ge});var qe=s(5459);function Ze({showMore:e,setShowMore:t}){const s=(0,o.useCallback)(()=>t(!e),[e,t]);return(0,S.jsxs)("div",{onClick:s,className:"show-more-link",children:[(0,S.jsx)("span",{className:e?"fa fa-caret-down":"fa fa-caret-right"}),(0,S.jsx)("span",{className:"link",children:e?"Hide options":"Show more options"})]})}const Ke=function({setValue:e,setBoards:t,state:s}){const{userListMode:i,timeframeType:o,sprintBoards:a,projects:r}=s,n="1"===o||!(null!==r&&void 0!==r&&r.length),l=n&&(0,S.jsx)("span",{className:"fa fa-exclamation-triangle msg-warning margin-l-5",title:"Not applicable when timeframe below is selected as Sprint or when no default project is configured"});return(0,S.jsxs)("div",{className:"settings-group",children:[(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"User List"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("userListMode","1",i,e),"Show all users who logged work"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("userListMode","2",i,e),"Show only selected users"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("userListMode","3",i,e,{disabled:n}),"Show all users logged work on configured projects ",l]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("userListMode","4",i,e,{disabled:n}),"Show selected users and all worklogs on configured projects ",l]})})]})]}),(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Time frame type"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("timeframeType","1",o,e,{disabled:"3"===i||"4"===i}),"Based on specific sprint",("3"===i||"4"===i)&&(0,S.jsx)("span",{className:"fa fa-exclamation-triangle msg-warning margin-l-5",title:"Not applicable based on User List selection above"})]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("timeframeType","2",o,e),"Based on selected date range"]})})]})]}),"1"===o&&(0,S.jsx)(Xe,{sprintBoards:a,setBoards:t}),"1"===o&&(0,S.jsx)(tt,{state:s,setValue:e}),"2"===o&&(0,S.jsx)(et,{state:s,setValue:e,userListMode:i})]})},Xe=o.memo(function({setBoards:e,sprintBoards:t}){return(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Choose Agile board *"}),(0,S.jsx)("div",{className:"col-md-9 col-form-label",children:(0,S.jsx)(qe.A,{value:t,onChange:e,multiple:!0})})]})});function et({setValue:e,state:{epicField:t,reportUserGrp:s,jql:i},userListMode:o}){return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Users worklog grouping"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("reportUserGrp","1",s,e),"2"===o?"Use default user groups":"Do not group worklogs"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("reportUserGrp","2",s,e),"Group worklogs based on project"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("reportUserGrp","3",s,e),"Group worklogs based on Issue type"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("reportUserGrp","4",s,e,{disabled:!t}),"Group by Epic ",!t&&(0,S.jsx)("span",{className:"fa fa-exclamation-triangle msg-warning margin-l-5",title:"JIRA Epic field name must be configured in general settings -> default values tab"})]})})]})]}),"1"===o&&(0,S.jsxs)("div",{className:"col-md-12",children:[(0,S.jsx)("strong",{children:"Caution:"})," Pulling worklogs of all the users on a specific timerange could result in pulling huge data and cause performance issues.",i?"Ensure you have necessary filters in JQL.":"Use JQL to add additional filters as necessary."]})]})}const tt=o.memo(function({setValue:e,state:{sprintStartRounding:t,sprintEndRounding:s}}){const[i,a]=(0,o.useState)(!1);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Ze,{showMore:i,setShowMore:a}),i&&(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Sprint start date rounding"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("sprintStartRounding","1",t,e),"Match exact start date time of sprint"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("sprintStartRounding","2",t,e),"Consider start of day as start date"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("sprintStartRounding","3",t,e),"Consider start of next day as start date"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("sprintStartRounding","4",t,e),"Use end of previous sprint (if available)"]})})]})]}),i&&(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Sprint end date rounding"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("sprintEndRounding","1",s,e),"Match exact end date time of sprint"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("sprintEndRounding","2",s,e),"Consider end of day as end date"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("sprintEndRounding","3",s,e),"Consider end of previous day as end date"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("sprintEndRounding","4",s,e),"Use start of next sprint (if available)"]})})]})]})]})});var st=s(89);const it=function({value:e,field:t,valueOnly:s,onChange:i,hideTypes:a,hideKeys:r}){const n=(0,o.useMemo)(()=>!e||s?e:e.map(e=>e.id||e.key),[e,s]),[l,d]=(0,o.useState)(),c=(0,o.useMemo)(()=>null===l||void 0===l?void 0:l.reduce((e,t)=>(e[t.id]=t,e),{}),[l]);(0,o.useEffect)(()=>{(async function(e,t){const{$jira:s}=(0,ee.WQ)("JiraService");let i=await s.getCustomFields();Array.isArray(e)&&e.length&&(i=i.filter(t=>{var s;return!e.includes(null===(s=t.schema)||void 0===s?void 0:s.type)}));Array.isArray(t)&&t.length&&(i=i.filter(e=>!t.includes(e.id)));return i})(a,r).then(d)},[a,r]);const h=(0,o.useCallback)((e,t)=>{const s=e.map(e=>{const t=c[e],{id:s,key:i=s,name:o}=t,a=function(e){const{schema:t,key:s}=e;if(!t)return s;const{type:i,system:o}=t;if(!o)return i;if("number"===i&&(o.endsWith("timespent")||o.endsWith("estimate")))return"timespent";return i}(t);return{id:s,key:i,name:o,type:a}});i(s,t)},[c,i]);return l?(0,S.jsx)(f.aL,{multiselect:!0,valueField:"id",displayField:"name",value:n||[],dataset:l||[],field:t,onChange:s?i:h,filter:!0,placeholder:"Choose the list of columns"}):"Loading..."};const ot=["key","summary","worklog","issuekey"];function at({setFieldValue:e,fields:t}){const{optional:s,daywiseFields:i,showCostReport:a,hideEstimate:r}=t,n=(0,o.useCallback)((t,s)=>{const o=i||{};if(t)e({...o,[s]:!0},"daywiseFields");else{const t={...o};delete t[s],e(t,"daywiseFields")}},[i,e]),l=(null===s||void 0===s?void 0:s.length)>0;return(0,S.jsx)("div",{className:"settings-group",children:(0,S.jsxs)("div",{className:"row",children:[(0,S.jsxs)("div",{className:"col-4",children:[(0,S.jsx)(st.A,{checked:a,onChange:e,field:"showCostReport",label:"Show cost report"}),(0,S.jsxs)("span",{className:"pad-l-15",children:[" ( ",(0,S.jsx)("i",{className:"fa fa-exclamation-triangle",title:"Change will take effect only after report is refreshed"})," )"]})]}),(0,S.jsxs)("div",{className:"col-8",children:[(0,S.jsx)(st.A,{checked:r,onChange:e,field:"hideEstimate",label:"Hide estimate related fields"}),(0,S.jsxs)("span",{className:"pad-l-15",children:[" ( ",(0,S.jsx)("i",{className:"fa fa-exclamation-triangle",title:"Change will take effect only after report is refreshed"})," )"]})]}),(0,S.jsxs)("div",{className:"col-12",children:[(0,S.jsx)("strong",{children:"Additional fields to pull from Jira"}),(0,S.jsx)(it,{value:s,field:"optional",onChange:e,hideKeys:ot}),(0,S.jsx)("span",{children:"These fields would be displayed in Flat (Groupable)"})]}),l&&(0,S.jsxs)("div",{className:"col-12",children:[(0,S.jsx)("strong",{children:"Additional fields to be displayed in Grouped - [User daywise] report"}),(0,S.jsx)("div",{className:"row",children:s.map(e=>(0,S.jsx)("div",{className:"col-4",children:(0,S.jsx)(st.A,{checked:null===i||void 0===i?void 0:i[e.id],onChange:n,field:e.id,label:e.name},e.id)}))})]})]})})}const rt=o.memo(at);const nt=function({setValue:e,state:t,state:{logFormat:s,timeZone:i,daysToHide:a}}){const[r,n]=(0,o.useState)(!1);return(0,S.jsxs)("div",{className:"settings-group",children:[(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Report timezone (experimental)"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("timeZone","1",i,e),"Use my local time zone for all users"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("timeZone","2",i,e),"Use containing groups timezone for all users"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("timeZone","3",i,e),"Use individual users timezone"]})})]})]}),(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Days to hide in Daywise view"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("daysToHide","1",a,e),"Show all days"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("daysToHide","2",a,e),"Hide non working days without worklog"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("daysToHide","3",a,e),"Hide all days without worklog"]})})]})]}),(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Log hour format"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("logFormat","1",s,e),"Format hours (2h 30m)"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("logFormat","2",s,e),"Show as number (2.5)"]})})]})]}),(0,S.jsx)(Ze,{showMore:r,setShowMore:n}),r&&(0,S.jsx)(lt,{setValue:e,state:t})]})};function lt({setValue:e,state:{breakupMode:t,userDisplayFormat:s,rIndicator:i,expandUsers:o,splitWorklogDays:a}}){return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"User display format"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("userDisplayFormat","1",s,e),"Show user display name only"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("userDisplayFormat","2",s,e),"Show user display name with avatar"]})})]})]}),(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Log breakup"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("breakupMode","1",t,e),"Single entry (Sum worklog added for same ticket on same day)"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("breakupMode","2",t,e),"Individual entry (Display individual entry for each of the worklog)"]})})]})]}),(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Range indicator"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("rIndicator","1",i,e),"Show thermometer as indicator"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("rIndicator","2",i,e),"Highlight background as indicator"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("rIndicator","0",i,e),"Do not show any indicator"]})})]})]}),(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("div",{className:"col-12",children:(0,S.jsx)(f.Sc,{checked:o,onChange:t=>e("expandUsers",t),label:"Expand user row by default in grouped report"})}),(0,S.jsxs)("div",{className:"col-12",children:[(0,S.jsx)(f.Sc,{checked:a,onChange:t=>e("splitWorklogDays",t),label:"Do not group worklog on ticket for multiple days under issue day wise tab"}),(0,S.jsxs)("span",{className:"pad-l-15",children:[" ( ",(0,S.jsx)("i",{className:"fa fa-exclamation-triangle",title:"Change will take effect only after report is refreshed"})," )"]})]})]})]})}var dt=s(7698);const ct=function({setValue:e,state:{logFilterType:t,filterThrsType:s,filterDays:i,filterDate:o,wlDateSelection:a}}){return(0,S.jsxs)("div",{className:"settings-group",children:[(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Filter worklogs by creation/updation"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("logFilterType","1",t,e),"Show all worklogs"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("logFilterType","2",t,e),"Show worklogs logged before the threshold"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("logFilterType","3",t,e),"Show worklogs logged after the threshold"]})})]})]}),(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Date selection"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("wlDateSelection","1",a,e),"Use updated date of worklog if its modified after creation"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("wlDateSelection","2",a,e),"Always use worklog creation date only"]})})]})]}),(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Threshold type"}),(0,S.jsxs)("div",{className:"col-md-9 col-form-label",children:[(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("filterThrsType","1",s,e),"X number of days from the log date"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("filterThrsType","2",s,e),"X number of days from the last date"]})}),(0,S.jsx)("div",{className:"form-check",children:(0,S.jsxs)("label",{className:"form-check-label",children:[Oe("filterThrsType","3",s,e),"On a specific date selected"]})})]})]}),"3"!==s&&(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Threshold days"}),(0,S.jsx)("div",{className:"col-md-9",children:(0,S.jsx)(dt.Y,{className:"form-check-input",value:i,maxLength:3,maxFractionDigits:0,onValueChange:({value:t})=>e("filterDays",t)})})]}),"3"===s&&(0,S.jsxs)("div",{className:"form-group row",children:[(0,S.jsx)("label",{className:"col-md-3 col-form-label",children:"Threshold date"}),(0,S.jsx)("div",{className:"col-md-9",children:(0,S.jsx)(f.lr,{value:o,onChange:t=>e("filterDate",t)})})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("strong",{children:"Info:"})," This tab lets to filter the worklog based on the date when the worklog was created/updated by the user. This would help you to eliminate or identify worklogs added after a threshold date."]}),(0,S.jsx)("br",{}),(0,S.jsxs)("div",{children:[(0,S.jsx)("strong",{children:"Note:"})," Changes in this tab would reflect only after you refresh the report."]})]})},ht=function({settings:e,onChange:t}){const[s,i]=(0,o.useState)({}),[a,r]=(0,o.useState)(e),n=s=>{i(s);const o={...e,...s};r(o),t(o,s)},l=(e,t)=>n({...s,[e]:t});return(0,S.jsxs)(de.J,{className:"worklog-settings",children:[(0,S.jsx)(de.K,{header:"Datasource",leftIcon:"fa fa-cog",contentClassName:"pad-22",children:(0,S.jsx)(Ke,{state:a,setValue:l,setBoards:e=>{const{sprintList:t}=a;n({...s,sprintBoards:e,sprintList:t&&e.reduce((e,s)=>(e[s.id]=t[s.id],e),{})})}})}),(0,S.jsx)(de.K,{header:"Formatting",leftIcon:"fa fa-cog",contentClassName:"pad-22",children:(0,S.jsx)(nt,{state:a,setValue:l})}),(0,S.jsx)(de.K,{header:"Fields list",leftIcon:"fa fa-cog",contentClassName:"pad-22",children:(0,S.jsx)(rt,{fields:a.fields,setFieldValue:(e,t)=>{l("fields",{...a.fields,[t]:e})},epicField:a.epicField})}),(0,S.jsx)(de.K,{header:"Log filter",leftIcon:"fa fa-filter",contentClassName:"pad-22",children:(0,S.jsx)(ct,{state:a,setValue:l})}),(0,S.jsxs)(de.K,{header:"JQL filter",leftIcon:"fa fa-filter",children:[(0,S.jsx)(f.fI,{multiline:!0,value:a.jql,onChange:e=>l("jql",e),style:{width:"100%",height:411},placeholder:"Provide the additional JQL filters to be applied while fetching data.",defaultValue:""}),(0,S.jsxs)("span",{children:[(0,S.jsx)("strong",{children:"Note:"})," Date range and user list filter will be added automatically."]})]})]})};class ut extends N.A{constructor(e){super(e,"Report configurations"),this.onDone=async()=>{const{modifiedSettings:e,allSettings:t}=this.state,s=me(function(e,t,s){const{reportLoaded:i,userListMode:o,timeframeType:a}=e;i&&(t.reportLoaded=(!t.userListMode||t.userListMode===o)&&(!t.timeframeType||t.timeframeType===a));const{sprintBoards:r,selSprints:n}=s,l=(null===r||void 0===r?void 0:r.reduce((e,t)=>(e[t.id]=!0,e),{}))||{},d=Object.keys(n).filter(e=>!l[e]);if(d.length){const e={...s.selSprints};d.forEach(t=>delete e[t]),t.selSprints=e,s.selSprints=e}return s}(this.props.settings,e,t));this.props.setStateValue(e),await this.$config.saveSettings("reports_WorklogReport",s),this.props.fillSprintList(),this.onHide(s)},this.handleOnChange=(e,t)=>{this.setState({allSettings:e,modifiedSettings:t})},this.style={width:"85vw",maxWidth:"900px"},(0,ee.WQ)(this,"ConfigService"),this.className="no-padding",this.state={showDialog:!0,modifiedSettings:{},allSettings:e.settings}}getFooter(){return(0,S.jsx)(f.$n,{icon:"fa fa-save",label:"Done",onClick:this.onDone})}render(){return super.renderBase((0,S.jsx)(ht,{settings:this.props.settings,onChange:this.handleOnChange}))}}const pt=pe(ut,e=>({settings:e}),{fillSprintList:function(e,t){return function(){e(ge(t()))}},setStateValue:Fe});const mt=function({est:e,rem:t,logged:s,variance:i}){const o=`Original Estimate: ${e||0}\nRemaining: ${t||0}\nTotal Logged: ${s}\nEstimate Variance: ${i}`;return(0,S.jsxs)("div",{className:"ticket-estimate",title:o,children:[(0,S.jsxs)("span",{className:"ticket-item est",children:[(0,S.jsx)("span",{className:"fas fa-clock"})," Est: ",e]}),(0,S.jsxs)("span",{className:"ticket-item rem",children:[(0,S.jsx)("span",{className:"fas fa-clipboard"})," Rem: ",t]}),(0,S.jsxs)("span",{className:"ticket-item log",children:[(0,S.jsx)("span",{className:"fas fa-hourglass-half"})," Log: ",s]}),(0,S.jsxs)("span",{className:"ticket-item var",children:[(0,S.jsx)("span",{className:"fas fa-exclamation-triangle"})," Var: ",i]})]})},gt=pe(function({weeks:e}){return e.map((e,t)=>(0,S.jsx)("th",{className:"week-head",colSpan:e.days,children:e.display},t))},(e,{sprint:t})=>{const{[t?`groupReport_${t.id}`:"groupReport"]:{weeks:s}}=e;return{weeks:s}}),ft=pe(function({dates:e}){return e.map((e,t)=>(0,S.jsxs)("th",{"data-test-id":e.prop,className:"day-head"+(e.isHoliday?" holiday":""),children:[e.dateNum,(0,S.jsx)("br",{}),(0,S.jsx)("span",{className:"day-name",children:e.day})]},t))},(e,{sprintId:t})=>{const{[t?`groupReport_${t}`:"groupReport"]:{dates:s}}=e;return{dates:s}});function xt({costView:e,dates:t,timeExportFormat:s,breakupMode:i,ticket:o,user:a,disableAddingWL:r,addNewWorklog:n,convertSecs:l,formatTime:d}){const c=(e,t)=>e&&0!==e.length?e.map(e=>`${d(e.logTime)} (${l(e.totalHours)})${t?`, Cost: ${e.totalCost}`:""} - ${e.comment||"(no comment provided)"}`).join(";\n"):"";return e?(0,S.jsxs)(S.Fragment,{children:[t.map((t,s)=>(0,S.jsx)("td",{className:"day-wl-block","data-test-id":t.prop,exportType:"float",children:(0,S.jsx)("span",{title:c(o.logs[t.prop],e),children:jt(o.logs[t.prop])})},s)),(0,S.jsx)("td",{"data-test-id":"total",exportType:"float",children:o.totalCost})]}):(0,S.jsxs)(S.Fragment,{children:[t.map((e,t)=>(0,S.jsx)(yt,{timeExportFormat:s,disableAddingWL:r,breakupMode:i,addNewWorklog:n,convertSecs:l,user:a,getComments:c,formatTime:d,day:e,issue:o},t)),(0,S.jsx)("td",{exportType:s,"data-test-id":"total",children:l(o.totalHours)})]})}function vt({issue:e,showParentSummary:t,hideEstimate:s,convertSecs:i}){const o=i(e.originalestimate),a=i(e.remainingestimate),r=i(e.totalLogged)||0,n=(e.estVariance>0?"+":"")+(i(e.estVariance)||(e.originalestimate>0?0:"NA"));return(0,S.jsxs)("td",{className:"data-left",children:[(0,S.jsxs)("div",{className:"wl-ticket-detail",title:e.summary,children:[(0,S.jsx)(f._V,{src:e.iconUrl,title:e.issueType}),!t&&e.parent&&(0,S.jsxs)(f.N_,{href:e.parentUrl,className:"link",children:[e.parent," - "]}),(0,S.jsx)(f.N_,{href:e.url,className:"link",children:e.ticketNo})," -",(0,S.jsx)("span",{children:e.summary})]}),!s&&!(!o&&!a)&&(0,S.jsx)(mt,{est:o,rem:a,logged:r,variance:n})]})}function yt({issue:e,user:t={},day:s,timeExportFormat:i,breakupMode:o,disableAddingWL:a,getComments:r,addNewWorklog:n,formatTime:l,convertSecs:d}){const{logs:c={}}=e,h=c[s.prop];return(0,S.jsxs)("td",{className:"day-wl-block"+(s.isHoliday?null!==h&&void 0!==h&&h.length?" log-high":" col-holiday":""),exportType:i,"data-test-id":s.prop,children:[(null===t||void 0===t?void 0:t.isCurrentUser)&&!0!==a&&(0,S.jsx)("span",{className:"fa fa-clock add-wl",title:"Click to add worklog",onClick:()=>n(e.ticketNo,s)}),"2"!==o&&(0,S.jsx)("span",{title:r(h),children:d(kt(h))}),"2"===o&&(0,S.jsxs)("div",{children:[" ",function(e){if(Array.isArray(e)&&e.length>0){const t=e.length>1?";":"";return e.map((e,s)=>(0,S.jsx)("span",{title:`${l(e.logTime)} - ${e.comment}`,children:d(e.totalHours)+t},s))}}(h)]})]})}function kt(e){return e&&0!==e.length?e.sum(e=>e.totalHours):""}function jt(e){return e&&0!==e.length?e.sum(e=>e.totalCost):""}const wt=pe(function({isSprint:e,groupIndex:t,issue:s,user:i,uid:o,sprintsList:a,costView:r,timeExportFormat:n,convertSecs:l,formatTime:d,addNewWorklog:c,fields:{hideEstimate:h},additionalCols:u}){return(0,S.jsxs)("tr",{className:"auto-wrap","data-row-id":"ticket","data-current-user":i.isCurrentUser?"1":"0","data-test-id":s.ticketNo,children:[(0,S.jsx)(vt,{issue:s,showParentSummary:!1,hideEstimate:h,convertSecs:l}),null===u||void 0===u?void 0:u.map(({key:e,Component:t,props:i})=>{var o;return(0,S.jsx)(t,{value:null===(o=s.fields)||void 0===o?void 0:o[e],...i},e)}),e&&a.map(({id:i})=>(0,S.jsx)(St,{convertSecs:l,groupIndex:t,costView:r,sprintId:i,uid:o,formatTime:d,ticketNo:s.ticketNo,isSprint:e,timeExportFormat:n,addNewWorklog:c},i)),!e&&(0,S.jsx)(St,{convertSecs:l,groupIndex:t,timeExportFormat:n,uid:o,formatTime:d,ticketNo:s.ticketNo,isSprint:e,costView:r,addNewWorklog:c}),e&&r&&(0,S.jsx)("td",{children:s.allSprintTotalCost}),e&&!r&&(0,S.jsx)("td",{children:l(s.allSprintTotalHours)})]})},({fields:e})=>({fields:e}),null,["UserUtilsService",({$userutils:{formatTime:e}})=>({formatTime:e})]),St=pe(xt,(e,{isSprint:t,sprintId:s,groupIndex:i,uid:o,ticketNo:a})=>{var r;const{breakupMode:n,disableAddingWL:l,[t?`groupReport_${s}`:"groupReport"]:{dates:d,groupedData:{[i]:{usersMap:{[o]:c}}}}}=e;return{breakupMode:n,dates:d,user:c,disableAddingWL:l,ticket:(null===c||void 0===c||null===(r=c.ticketsMap)||void 0===r?void 0:r[a])||{logs:{}}}});function bt(e){return e.imageUrl||e.avatarUrls["48x48"]||e.avatarUrls["32x32"]}const Ct=pe(function({isSprint:e,groupIndex:t,boardId:s,user:i,user:a,colSpan:r,additionalCols:n,userDisplayFormat:l,sprintsList:d,costView:c,expanded:h,uid:u,timeExportFormat:p,convertSecs:m,addWorklog:g,toggleUserExpanded:f}){const x="1"!==l,v=(0,o.useCallback)(e=>{e.nativeEvent.srcElement.classList.contains("add-wl")||f(s,t,u)},[s,t,u,f]),y=(0,o.useCallback)((e,t)=>{var s;const{date:o,prop:a}=t;g(i,e,o,null===(s=i.total)||void 0===s?void 0:s[a])},[i,g]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("tr",{className:"pointer auto-wrap",onClick:v,"data-current-user":a.isCurrentUser?"1":"0","data-row-id":"user",children:[(0,S.jsx)("td",{className:"data-left",colSpan:r,children:(0,S.jsxs)("div",{className:x?"user-info":"user-info-min",style:{paddingLeft:0},children:[(0,S.jsx)("i",{className:"float-start drill-down fa "+(h?"fa-chevron-circle-down":"fa-chevron-circle-right"),title:"Click to toggle ticket details"}),x&&(0,S.jsx)("img",{src:bt(a),height:40,width:40,className:"float-start",alt:a.displayName}),(0,S.jsx)("span",{className:"name",children:a.displayName}),x&&(0,S.jsxs)("span",{className:"email",children:["(",a.emailAddress||a.name,a.timeZone&&(0,S.jsxs)("span",{children:[", time zone: ",a.timeZone]}),")"]})]})}),e&&d.map(({id:e})=>(0,S.jsx)(Nt,{sprintId:e,uid:u,boardId:s,convertSecs:m,groupIndex:t,costView:c,timeExportFormat:p,addNewWorklog:y},e)),!e&&(0,S.jsx)(Nt,{uid:u,convertSecs:m,groupIndex:t,costView:c,timeExportFormat:p,addNewWorklog:y}),e&&c&&(0,S.jsx)("td",{exportType:"float",children:a.allSprintTotalCost}),e&&!c&&(0,S.jsx)("td",{exportType:p,children:m(a.allSprintTotalHours)})]}),h&&(0,S.jsx)(Tt,{isSprint:e,groupIndex:t,boardId:s,uid:u,user:a,costView:c,sprintsList:d,addNewWorklog:y,convertSecs:m,timeExportFormat:p,additionalCols:n})]})},(e,{boardId:t,groupIndex:s,user:i})=>{var o;const{userDisplayFormat:a,timeframeType:r,userExpnState:n,expandUsers:l}=e,d="1"===r,c=(0,j.J3)(i),h={isSprint:d,userDisplayFormat:a,uid:c,expanded:!!(null!==(o=n[`${t}_${s}_${c}`])&&void 0!==o?o:l)};return d&&(h.sprintsList=e[`sprintsList_${t}`]),h},{addWorklog:function(e){const{$session:{CurrentUser:{maxHours:t},UserSettings:{startOfDay:s}}}=(0,g.WQ)("SessionService"),i=60*(t||8)*60;return function(t,o,a,n){let l=(i||0)-(n||0);l<60&&(l="01:00"),r()(a).isSame(r()(),"day")?a=new Date:s&&(a=new Date(a)).setHours(...s.split(":")),e({showWorklogPopup:!0,worklogItem:{ticketNo:o,dateStarted:a,timeSpent:l}})}},convertSecs:Pe,toggleUserExpanded:function(e,t){return function(s,i,o){const a=t(),r={...a.userExpnState},n=`${s}_${i}_${o}`,{[n]:l}=r;(null!==l&&void 0!==l?l:a.expandUsers)?r[n]=!1:r[n]=!0,e({userExpnState:r})}}}),Nt=pe(function({costView:e,dates:t,user:s,timeExportFormat:i,addNewWorklog:o,convertSecs:a,maxHours:r,rIndicator:n,disableAddingWL:l}){return e?(0,S.jsxs)(S.Fragment,{children:[t.map((e,t)=>(0,S.jsx)("td",{className:`${s.logClass[e.prop]} day-wl-block`,"data-test-id":e.prop,exportType:"float",children:s.totalCost[e.prop]},t)),(0,S.jsx)("td",{"data-test-id":"total",exportType:"float",children:s.grandTotalCost})]}):(0,S.jsxs)(S.Fragment,{children:[t.map((e,t)=>(0,S.jsxs)("td",{className:`${s.logClass[e.prop]} day-wl-block`,exportType:i,"data-test-id":e.prop,children:[s.isCurrentUser&&!0!==l&&(0,S.jsx)("span",{className:"fa fa-clock add-wl",title:"Click to add worklog",onClick:()=>o(null,e)}),a(s.total[e.prop]),"1"===n&&(0,S.jsx)(oe.A,{value:s.total[e.prop],maxHours:r})]},t)),(0,S.jsx)("td",{exportType:i,"data-test-id":"total",children:a(s.grandTotal)})]})},(e,{sprintId:t,groupIndex:s,uid:i})=>{const{timeframeType:o,["1"===o?`groupReport_${t}`:"groupReport"]:{dates:a,groupedData:r},maxHours:n,rIndicator:l,disableAddingWL:d}=e;return{dates:a,group:r,maxHours:n,rIndicator:l,disableAddingWL:d,user:r[s].usersMap[i]||{logClass:{},total:{},totalCost:{}}}});function Tt({user:e,isSprint:t,groupIndex:s,sprintsList:i,uid:o,timeExportFormat:a,addNewWorklog:r,convertSecs:n,costView:l,additionalCols:d}){return e.tickets.map((c,h)=>(0,S.jsx)(wt,{isSprint:t,groupIndex:s,issue:c,user:e,uid:o,addNewWorklog:r,sprintsList:i,timeExportFormat:a,convertSecs:n,costView:l,additionalCols:d},h))}const Dt=pe(function({group:e,index:t,dates:s,sprintsList:i,convertSecs:a,isSprint:r,boardId:n,costView:l,timeExportFormat:d,additionalCols:c}){const[h,u]=(0,o.useState)(!1),p=(0,o.useCallback)(()=>u(e=>!e),[u]),m=((null===c||void 0===c?void 0:c.length)||0)+1;return(0,S.jsxs)(S.Fragment,{children:[!h&&!e.isDummy&&(0,S.jsxs)("tr",{className:"grouped-row left",title:"Click to hide user details",children:[(0,S.jsxs)("td",{colSpan:r?m:(null===s||void 0===s?void 0:s.length)+1+m,onClick:p,children:[(0,S.jsx)("i",{className:"float-start drill-down fa fa-chevron-circle-down"}),e.name]}),r&&e.sprints.map((e,t)=>e.days<=999?(0,S.jsx)("td",{colSpan:e.days+1,children:e.name},t):(0,S.jsxs)(o.Fragment,{children:[(0,S.jsx)("td",{colSpan:1e3,className:"total-field",children:e.name}),(0,S.jsx)("td",{colSpan:e.days-999})]},t))]}),!h&&e.users.map((e,s)=>(0,S.jsx)(Ct,{groupIndex:t,index:s,colSpan:m,user:e,timeExportFormat:d,boardId:n,costView:l,additionalCols:c},s)),!e.isDummy&&(0,S.jsxs)("tr",{className:"grouped-row right auto-wrap",onClick:h?p:null,children:[(0,S.jsxs)("td",{colSpan:m,children:[h&&(0,S.jsxs)("div",{children:[(0,S.jsx)("i",{className:"float-start drill-down fa fa-chevron-circle-right",title:"Click to show user details"}),(0,S.jsx)("span",{className:"float-start",children:e.name}),(0,S.jsxs)("span",{className:"float-end",children:["Total ",(0,S.jsx)("i",{className:"fa fa-arrow-right"})]})]}),!h&&(0,S.jsxs)("div",{children:[e.name," ",(0,S.jsx)("i",{className:"fa fa-arrow-right"})," Total ",(0,S.jsx)("i",{className:"fa fa-arrow-right"})]})]}),r&&i.map(({id:e})=>(0,S.jsx)($t,{sprintId:e,boardId:n,convertSecs:a,timeExportFormat:d,costView:l,groupIndex:t},e)),!r&&(0,S.jsx)($t,{convertSecs:a,timeExportFormat:d,costView:l,groupIndex:t}),r&&l&&(0,S.jsx)("td",{exportType:"float",children:e.grandTotalCost}),r&&!l&&(0,S.jsx)("td",{exportType:d,children:a(e.grandTotalHours)})]})]})},(e,{boardId:t})=>{const s="1"===e.timeframeType;if(s){const{[`sprintsList_${t}`]:i}=e;return{isSprint:s,sprintsList:i}}{const{groupReport:{dates:t}}=e;return{isSprint:s,dates:t}}},{convertSecs:Pe}),$t=pe(function({group:e,costView:t,dates:s,timeExportFormat:i,convertSecs:o}){return t?(0,S.jsxs)(S.Fragment,{children:[s.map((t,s)=>(0,S.jsx)("td",{className:t.isHoliday?e.totalCost[t.prop]?"log-high":"col-holiday":"",exportType:"float",children:e.totalCost[t.prop]},s)),(0,S.jsx)("td",{exportType:"float",children:e.grandTotalCost})]}):(0,S.jsxs)(S.Fragment,{children:[s.map((t,s)=>(0,S.jsx)("td",{className:t.isHoliday?e.total[t.prop]?"log-high":"col-holiday":"",exportType:i,children:o(e.total[t.prop])},s)),(0,S.jsx)("td",{exportType:i,children:o(e.grandTotal)})]})},(e,{sprintId:t,groupIndex:s})=>{const{timeframeType:i,["1"===i?`groupReport_${t}`:"groupReport"]:{dates:o,groupedData:a}}=e;return{dates:o,group:a[s]}});const Wt=pe(function({boardId:e,isSprint:t,groupedData:s,additionalCols:i,sprintsList:o,logFormat:a,costView:r,rIndicator:n}){const l=((null===i||void 0===i?void 0:i.length)||0)+1,d="2"===a?"float":void 0,c=s.map((t,s)=>(0,S.jsx)(Dt,{index:s,boardId:e,additionalCols:i,group:t,timeExportFormat:d,costView:r},s));return(0,S.jsxs)(te.vc,{className:"2"!==n?"no-log-bg-hl":"",children:[c,s.length>1&&(0,S.jsxs)("tr",{className:"grouped-row right auto-wrap",children:[(0,S.jsxs)("td",{colSpan:l,children:["Grand Total ",(0,S.jsx)("i",{className:"fa fa-arrow-right"})]}),t&&(null===o||void 0===o?void 0:o.map(({id:e})=>(0,S.jsx)(At,{sprintId:e,timeExportFormat:d,costView:r},e))),!t&&(0,S.jsx)(At,{timeExportFormat:d,costView:r})]})]})},(e,{boardId:t})=>{const s="1"===e.timeframeType;if(s){const{[`userGroup_${t}`]:i,[`sprintsList_${t}`]:o,logFormat:a,rIndicator:r}=e;return{isSprint:s,sprintsList:o,groupedData:i,logFormat:a,rIndicator:r}}{const{groupReport:{groupedData:t},logFormat:s,rIndicator:i}=e;return{groupedData:t,logFormat:s,rIndicator:i}}}),At=pe(function({groupedData:e,dates:t,timeExportFormat:s,costView:i,convertSecs:o}){return i?(0,S.jsxs)(S.Fragment,{children:[t.map((t,s)=>(0,S.jsx)("td",{className:t.isHoliday?e.totalCost[t.prop]?"log-high":"col-holiday":"",exportType:"float",children:e.totalCost[t.prop]},s)),(0,S.jsx)("td",{exportType:"float",children:e.grandTotalCost})]}):(0,S.jsxs)(S.Fragment,{children:[t.map((t,i)=>(0,S.jsx)("td",{className:t.isHoliday?e.total[t.prop]?"log-high":"col-holiday":"",exportType:s,children:o(e.total[t.prop])},i)),(0,S.jsx)("td",{exportType:s,children:o(e.grandTotal)})]})},(e,{sprintId:t})=>{const s="1"===e.timeframeType,{[s?`groupReport_${t}`:"groupReport"]:{dates:i,groupedData:o}}=e;return{dates:i,groupedData:o}},{convertSecs:Pe});const Ut=pe(function({useSprint:e,sprintsList:t,additionalCols:s,costView:i}){const a=((null===s||void 0===s?void 0:s.length)||0)+1;return(0,S.jsxs)(te.D1,{children:[(0,S.jsxs)("tr",{className:"data-center pad-min auto-wrap",children:[(0,S.jsx)("th",{style:{minWidth:260+120*a},rowSpan:a>1?1:2,colSpan:a,children:"User Details"}),e&&t.map(e=>(0,S.jsxs)(o.Fragment,{children:[(0,S.jsx)(gt,{sprint:e}),(0,S.jsx)("th",{rowSpan:2,children:"Sprint Total"})]},e.id)),!e&&(0,S.jsx)(gt,{}),!i&&(0,S.jsx)("th",{style:{minWidth:50,maxWidth:100},rowSpan:2,children:"Total Hours"}),i&&(0,S.jsx)("th",{style:{minWidth:50,maxWidth:100},rowSpan:2,children:"Total Cost"})]}),(0,S.jsxs)("tr",{className:"pad-min auto-wrap",children:[a>1&&(0,S.jsx)("th",{style:{minWidth:380},children:"Issue details"}),null===s||void 0===s?void 0:s.map(e=>(0,S.jsx)("th",{children:e.name},e.key)),e&&t.map(({id:e})=>(0,S.jsx)(ft,{sprintId:e},e)),!e&&(0,S.jsx)(ft,{})]})]})},(e,{boardId:t})=>{const{selSprints:s,timeframeType:i}=e,o="1"===i;return{useSprint:o,board:o?s[t]:void 0,sprintsList:o?e[`sprintsList_${t}`]:void 0}});const Lt=pe(function({boardId:e,fields:t,exportSheetName:s,costView:i}){const{optional:a,daywiseFields:r}=t||{},n=(0,o.useMemo)(()=>null===a||void 0===a?void 0:a.filter(e=>null===r||void 0===r?void 0:r[e.id]).map(e=>{const{type:t=e.type}=(0,J.AZ)(e);return{...e,type:t,...(0,J.vL)(t||e.type)}}),[a,r]);return(0,S.jsxs)(te.ew,{className:"table-bordered",exportSheetName:s,children:[(0,S.jsx)(Ut,{additionalCols:n,boardId:e}),(0,S.jsx)(Wt,{additionalCols:n,boardId:e,costView:i})]})},({fields:e})=>({fields:e}));const It=pe(function({useSprint:e,sprintsList:t,additionalCols:s,costView:i}){return(0,S.jsxs)(te.D1,{children:[(0,S.jsxs)("tr",{className:"data-center pad-min auto-wrap",children:[(0,S.jsx)("th",{style:{minWidth:380},rowSpan:2,children:"Issue details"}),null===s||void 0===s?void 0:s.map(e=>(0,S.jsx)("th",{rowSpan:2,children:e.name},e.key)),e&&t.map(e=>(0,S.jsxs)(o.Fragment,{children:[(0,S.jsx)(gt,{sprint:e}),(0,S.jsx)("th",{rowSpan:2,children:"Sprint Total"})]},e.id)),!e&&(0,S.jsx)(gt,{}),!i&&(0,S.jsx)("th",{style:{minWidth:50,maxWidth:100},rowSpan:2,children:"Total Hours"}),i&&(0,S.jsx)("th",{style:{minWidth:50,maxWidth:100},rowSpan:2,children:"Total Cost"})]}),(0,S.jsxs)("tr",{className:"pad-min auto-wrap",children:[e&&t.map(({id:e})=>(0,S.jsx)(ft,{sprintId:e},e)),!e&&(0,S.jsx)(ft,{})]})]})},(e,{boardId:t})=>{const{selSprints:s,timeframeType:i}=e,o="1"===i;return{useSprint:o,board:o?s[t]:void 0,sprintsList:o?e[`sprintsList_${t}`]:void 0}});const Mt=function({isSprint:e,issue:t,user:s,uid:i,sprintsList:o,costView:a,dates:r,timeExportFormat:n,convertSecs:l,formatTime:d,addNewWorklog:c,fields:{hideEstimate:h},additionalCols:u}){return(0,S.jsxs)("tr",{className:"auto-wrap","data-row-id":"ticket","data-current-user":s.isCurrentUser?"1":"0","data-test-id":t.ticketNo,children:[(0,S.jsx)(vt,{issue:t,showParentSummary:!1,hideEstimate:h,convertSecs:l}),null===u||void 0===u?void 0:u.map(({key:e,Component:s,props:i})=>{var o;return(0,S.jsx)(s,{value:null===(o=t.fields)||void 0===o?void 0:o[e],...i},e)}),e&&o.map(({id:o})=>(0,S.jsx)(xt,{convertSecs:l,costView:a,dates:r,sprintId:o,uid:i,formatTime:d,ticketNo:t.ticketNo,ticket:t,user:s,isSprint:e,timeExportFormat:n,addNewWorklog:c},o)),!e&&(0,S.jsx)(xt,{convertSecs:l,timeExportFormat:n,dates:r,uid:i,formatTime:d,ticketNo:t.ticketNo,ticket:t,user:s,isSprint:e,costView:a,addNewWorklog:c}),e&&a&&(0,S.jsx)("td",{children:t.allSprintTotalCost}),e&&!a&&(0,S.jsx)("td",{children:l(t.allSprintTotalHours)})]})};const Rt=pe(function({isSprint:e,issuesList:t,dates:s,additionalCols:i,sprintsList:o,fields:a,logFormat:r,costView:n,rIndicator:l,convertSecs:d,formatTime:c}){const h="2"===r?"float":void 0,u=t.map((t,r)=>(0,S.jsx)(Mt,{isSprint:e,issue:t,dates:s,user:t.fields.worklogUser,uid:t.fields.worklogUser,sprintsList:o,timeExportFormat:h,fields:a,convertSecs:d,formatTime:c,costView:n,additionalCols:i},r));return(0,S.jsx)(te.vc,{className:"2"!==l?"no-log-bg-hl":"",children:u})},(e,{boardId:t})=>{const s="1"===e.timeframeType;if(s){const{[`userGroup_${t}`]:i,[`sprintsList_${t}`]:o,logFormat:a,rIndicator:r,fields:n}=e;return{isSprint:s,sprintsList:o,issuesList:i,logFormat:a,rIndicator:r,fields:n}}{const{issueDayWise:{issuesList:t,dates:s},logFormat:i,rIndicator:o,fields:a}=e;return{issuesList:t,dates:s,logFormat:i,rIndicator:o,fields:a}}},{convertSecs:Pe},["UserUtilsService",({$userutils:{formatTime:e}})=>({formatTime:e})]),Et={key:"worklogUser",type:"user",name:"Worklog author"},Ft={key:"logDateTime",type:"datetime",name:"Worklog date"};const Pt=pe(function({boardId:e,splitWorklogDays:t,fields:s,exportSheetName:i,costView:a}){const{optional:r,daywiseFields:n}=s||{},l=(0,o.useMemo)(()=>{var e;const s=[Et,...null!==(e=null===r||void 0===r?void 0:r.filter(e=>null===n||void 0===n?void 0:n[e.id]))&&void 0!==e?e:[]];return t&&s.splice(0,0,Ft),s.map(e=>{const{type:t=e.type}=(0,J.AZ)(e);return{...e,type:t,...(0,J.vL)(t||e.type)}})},[r,n,t]);return(0,S.jsxs)(te.ew,{className:"table-bordered",exportSheetName:i,children:[(0,S.jsx)(It,{additionalCols:l,boardId:e}),(0,S.jsx)(Rt,{additionalCols:l,boardId:e,costView:a})]})},({splitWorklogDays:e,fields:t})=>({splitWorklogDays:e,fields:t})),Bt=["-originalestimate","-totalLogged","-remainingestimate","-estVariance"],Vt=(e,t)=>e&&(0,S.jsx)(w.A,{href:t,className:"link",children:e});const Gt=pe(function({exportSheetName:e,getColumnSettings:t,flatGridSettingsChanged:s,flatWorklogs:i,hideEstimate:a,flatTableSettings:r,flatTableSettings:{groupBy:n,groupFoldable:l,displayColumns:d,sortField:c,isDesc:h}={displayColumns:a?Bt:null},onSettingsChanged:u}){const[p]=(0,o.useState)(()=>t(Vt)),m=(0,o.useRef)();return(0,o.useEffect)(()=>{r&&m.current&&u(),m.current=!0},[r]),p&&i?(0,S.jsx)(z.A,{className:"flat-data-grid",dataset:i,exportSheetName:e,columns:p,allowSorting:!0,onChange:s,displayColumns:d,groupBy:n,groupFoldable:l,sortField:c,isDesc:h,noRowsMessage:"No worklog details available"}):null},(e,{boardId:t})=>{const{[t?`flatWorklogs_${t}`:"flatWorklogs"]:s,fields:{hideEstimate:i},flatTableSettings:o}=e;return{flatWorklogs:s,hideEstimate:i,flatTableSettings:o}},{getColumnSettings:function(e,t){const s=Pe(0,t),{$userutils:{formatDateTime:i,formatDate:o}}=(0,g.WQ)("UserUtilsService"),a={datetime:{format:e=>i(e)},date:{format:e=>o(e)}};return function(e){const{userListMode:o,timeframeType:r,fields:{optional:n=[]}={}}=t(),l="2"===o,d="1"===r,c="1"===t("logFormat")?"string":"number",h=n.map(e=>{if(Ve.includes(e.key)||"timespent"===e.type)return null;const t={field:`fields.${e.key}`,displayText:e.name,type:e.type,...a[e.type]};if(Be.includes(e.type))return t;const{Component:s,props:i}=(0,J.vL)(e.type);return t.viewComponent=s,t.props=i,t});return[l&&{field:"groupName",displayText:"Group Name",type:"string"},d&&{field:"sprintName",displayText:"Sprint Name",type:"string"},{field:"projectName",displayText:"Project Name",type:"string"},{field:"issueType",displayText:"Issue Type",type:"string"},{field:"epicDisplay",displayText:"Epic",type:"string",format:(t,s)=>e(t,s.epicUrl)},{field:"parent",displayText:"Parent",type:"string",format:(t,s)=>e(t,s.parentUrl)},{field:"ticketNo",displayText:"Ticket No",type:"string",format:(t,s)=>e(t,s.ticketUrl)},{field:"statusName",displayText:"Status",type:"string"},{field:"summary",displayText:"Summary",type:"string"},{field:"logTime",displayText:"Log Date & Time",type:"datetime",format:e=>i(e)},{field:"logCreated",displayText:"Worklog Created",type:"datetime",format:e=>i(e)},{field:"logUpdated",displayText:"Worklog Updated",type:"datetime",format:e=>i(e)},{field:"userDisplay",displayText:"Log user",type:"string"},{field:"assignee",displayText:"Assignee",type:"string"},{field:"reporter",displayText:"Reporter",type:"string"},{field:"timeSpent",displayText:"Hr. Spent",type:c,format:s},{field:"originalestimate",displayText:"Ori. Estm.",type:c,format:s},{field:"totalLogged",displayText:"Total Worklogs",type:c,format:s},{field:"remainingestimate",displayText:"Rem. Estm.",type:c,format:s},{field:"estVariance",displayText:"Estm. Variance",type:"string",format:e=>(e>0?"+":"")+s(e)},{field:"comment",displayText:"Comment"},{field:"fields.project.key",displayText:"Project Name test",type:"string"},...h].filter(Boolean)}},flatGridSettingsChanged:function(e){return function(t){e({flatTableSettings:t})}}}),Ot=pe(function({groups:e,flatWorklogs:t,exportSheetName:s,convertSecs:i,costView:a}){const[r,n]=(0,o.useState)(!1);if((0,o.useEffect)(()=>{n(function(e,t){const s=[],i={},o=t.groupBy(e=>e.username).reduce((e,t)=>(e[t.key]=t.values,e),{});t.groupBy(e=>({key:e.projectKey,name:e.projectName})).sortBy(e=>e.key.key).forEach(({key:e,values:t})=>{s.push(e),i[e.key]=t,e.issueTypes=t.distinct(e=>e.issueType)});const a=e.map(e=>{const{name:t,users:a}=e,r={grandTotal:0,grandTotalCost:0,projects:{}},n={name:t,overallTotal:r};return n.users=a.map(e=>{const t=(0,j.J3)(e),{emailAddress:a,displayName:n}=e,l={name:t,emailAddress:a,displayName:n};l.projects=s.reduce((s,o)=>{const a=r.projects[o.key]||{total:0,totalCost:0};r.projects[o.key]=a;const n=i[o.key];if(n){const i=n.filter(e=>e.username===t);if(i.length){const t=i.groupBy(e=>e.issueType).reduce((t,s)=>{const i=s.values.sum(e=>e.timeSpent)||0,o=(0,j.yP)(i,e.costPerHour);return t[s.key]={total:i,totalCost:o,logs:s.values},a[s.key]=(a[s.key]||0)+i,a[`${s.key}_Cost`]=(a[`${s.key}_Cost`]||0)+o,t},{}),r=i.sum(e=>e.timeSpent);t.grandTotal={total:r,totalCost:(0,j.yP)(r,e.costPerHour),logs:i},a.total+=t.grandTotal.total||0,a.totalCost+=t.grandTotal.totalCost||0,s[o.key]=t}}return s},{});const d=o[t]||[],c=d.sum(e=>e.timeSpent);return l.grandTotal={total:c,totalCost:(0,j.yP)(c,e.costPerHour),logs:d},r.grandTotal+=l.grandTotal.total,r.grandTotalCost+=l.grandTotal.totalCost,l}),n}),r=a.reduce((e,t)=>{const{overallTotal:{grandTotal:i,grandTotalCost:o,projects:a}}=t;return e.grandTotal=(e.grandTotal||0)+i,e.grandTotalCost=(e.grandTotalCost||0)+o,s.forEach(t=>{const s=a[t.key]||{},i=e[t.key]||{total:0,totalCost:0};e[t.key]=i,i.total+=s.total||0,i.totalCost+=s.totalCost||0,t.issueTypes.forEach(e=>{i[e]=(i[e]||0)+(s[e]||0),i[`${e}_Cost`]=(i[`${e}_Cost`]||0)+(s[`${e}_Cost`]||0)})}),e},{grandTotal:0,grandTotalCost:0});return{projects:s,groupedData:a,grandTotal:r}}(e,t))},[e,t]),!r)return(0,S.jsx)("span",{children:"Loading..."});const{projects:l,groupedData:d,grandTotal:c}=r,h=1===(null===d||void 0===d?void 0:d.length)&&!d[0].name;return(0,S.jsxs)(te.ew,{className:"table-bordered",dataset:d,exportSheetName:s,children:[(0,S.jsxs)(te.D1,{children:[(0,S.jsxs)(te.lO,{children:[!h&&(0,S.jsx)(te.VP,{rowSpan:2,children:"Group Name"}),(0,S.jsx)(te.VP,{rowSpan:2,children:"User Name"}),l.map(e=>(0,S.jsx)(te.VP,{colSpan:e.issueTypes.length+1,children:e.name},e.key)),(0,S.jsx)(te.VP,{rowSpan:2,children:"Grand Total"})]}),(0,S.jsx)(te.lO,{children:l.map((e,t)=>(0,S.jsxs)(o.Fragment,{children:[e.issueTypes.map((e,t)=>(0,S.jsx)(te.VP,{children:e},t)),(0,S.jsx)(te.VP,{children:"Total"})]},t))})]}),(0,S.jsx)(te.vc,{children:(e,t)=>(0,S.jsx)(Ht,{group:e,projects:l,costView:a,convertSecs:i,hideGroup:h},t)}),!h&&(0,S.jsx)(zt,{grandTotal:c,projects:l,costView:a,convertSecs:i})]})},(e,{boardId:t})=>{const{[t?`flatWorklogs_${t}`:"flatWorklogs"]:s,groupReport:{groupedData:i}}=e;return{flatWorklogs:s,groups:i}},{convertSecs:Pe}),Ht=(0,o.memo)(function({hideGroup:e,projects:t,costView:s,group:i,convertSecs:a}){return(0,S.jsxs)(o.Fragment,{children:[i.users.map((r,n)=>(0,S.jsxs)("tr",{children:[!e&&0===n&&(0,S.jsx)("td",{rowSpan:i.users.length+1,children:i.name}),(0,S.jsx)("td",{children:r.displayName}),t.map((e,t)=>{var i,n,l;const d=r.projects[e.key]||{};return(0,S.jsxs)(o.Fragment,{children:[!s&&e.issueTypes.map((e,t)=>{const s=d[e];return(0,S.jsx)("td",{className:"data-center",exportType:"float",children:a(null===s||void 0===s?void 0:s.total)},t)}),!s&&(0,S.jsx)("td",{className:"strong data-center",exportType:"float",children:a(null===(i=d.grandTotal)||void 0===i?void 0:i.total)}),s&&e.issueTypes.map((e,t)=>{const s=d[e];return(0,S.jsx)("td",{className:"data-center",exportType:"float",title:a(null===s||void 0===s?void 0:s.total),children:null===s||void 0===s?void 0:s.totalCost},t)}),s&&(0,S.jsx)("td",{className:"strong data-center",exportType:"float",title:a(null===(n=d.grandTotal)||void 0===n?void 0:n.total),children:null===(l=d.grandTotal)||void 0===l?void 0:l.totalCost})]},t)}),!s&&(0,S.jsx)("td",{className:"strong data-center",exportType:"float",children:a(r.grandTotal.total)}),s&&(0,S.jsx)("td",{className:"strong data-center",exportType:"float",title:a(r.grandTotal.total),children:r.grandTotal.totalCost})]},n)),(0,S.jsxs)("tr",{className:"strong data-center",children:[(0,S.jsxs)("td",{className:"data-right",children:["Group Total ",(0,S.jsx)("span",{className:"fa fa-arrow-right"})]}),t.map((e,t)=>{const r=i.overallTotal.projects[e.key]||{};return s?(0,S.jsxs)(o.Fragment,{children:[e.issueTypes.map((e,t)=>(0,S.jsx)("td",{exportType:"float",title:a(r[e]),children:r[`${e}_Cost`]},t)),(0,S.jsx)("td",{exportType:"float",title:a(r.total),children:r.totalCost})]},t):(0,S.jsxs)(o.Fragment,{children:[e.issueTypes.map((e,t)=>(0,S.jsx)("td",{exportType:"float",children:a(r[e])},t)),(0,S.jsx)("td",{exportType:"float",children:a(r.total)})]},t)}),!s&&(0,S.jsx)("td",{exportType:"float",children:a(i.overallTotal.grandTotal)}),s&&(0,S.jsx)("td",{exportType:"float",title:a(i.overallTotal.grandTotal),children:i.overallTotal.grandTotalCost})]})]})}),zt=(0,o.memo)(function({grandTotal:e,projects:t,costView:s,convertSecs:i}){return(0,S.jsx)("tfoot",{children:(0,S.jsxs)("tr",{className:"strong data-center",children:[(0,S.jsxs)("td",{colSpan:2,className:"data-right",children:["Grand total ",(0,S.jsx)("span",{className:"fa fa-arrow-right"})]}),!s&&t.map((t,s)=>(0,S.jsxs)(o.Fragment,{children:[t.issueTypes.map((s,o)=>(0,S.jsx)("td",{exportType:"float",children:i(e[t.key][s])},o)),(0,S.jsx)("td",{exportType:"float",children:i(e[t.key].total)})]},s)),!s&&(0,S.jsx)("td",{exportType:"float",children:i(e.grandTotal)}),s&&t.map((t,s)=>(0,S.jsxs)(o.Fragment,{children:[t.issueTypes.map((s,o)=>(0,S.jsx)("td",{exportType:"float",title:i(e[t.key][s]),children:e[t.key][`${s}_Cost`]},o)),(0,S.jsx)("td",{exportType:"float",title:i(e[t.key].total),children:e[t.key].totalCost})]},s)),s&&(0,S.jsx)("td",{exportType:"float",title:i(e.grandTotal),children:e.grandTotalCost})]})})});var Jt=s(3571),_t=s(1889);const Qt=pe(function({flatData:e,groupField:t,isSprint:s,reportUserGrp:i}){const[a,r]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{r(e.groupBy(e=>e[t]))},[e,t,r]),a?(0,S.jsxs)("div",{className:"worklog-visualization-tab",children:[a.length>1&&(0,S.jsx)(Yt,{title:s?"All Sprints":"All Groups",data:e}),a.map(e=>(0,S.jsx)(Yt,{title:e.key,data:e.values,reportUserGrp:i},e.key))]}):(0,S.jsx)("span",{children:"Loading"})},function(e,{boardId:t}){const s="1"===e.timeframeType,{[s?`flatWorklogs_${t}`:"flatWorklogs"]:i,reportUserGrp:o}=e;return{isSprint:s,flatData:i,groupField:s?"sprintName":"groupName",reportUserGrp:o}}),Yt=function({title:e,data:t,reportUserGrp:s}){const i=[];"4"!==s&&i.push({title:"Epic Wise",groupField:"epicDisplay",legendTitle:"Epic summary",data:t}),"2"!==s&&i.push({title:"Project Wise",groupField:"projectName",legendTitle:"Projects",data:t}),"3"!==s&&i.push({title:"Issuetype Wise",groupField:"issueType",legendTitle:"Issue types",data:t}),i.push({title:"Status Wise",groupField:"statusName",legendTitle:"Statuses",data:t});const a=(0,o.useCallback)(e=>(0,S.jsx)(Zt,{...e}),[]);return(0,S.jsx)("div",{className:"group-wise-charts",children:(0,S.jsx)(_t.F,{header:(0,S.jsx)("h3",{children:e}),value:i,itemTemplate:a})})};function qt(e,{title:t,legendTitle:s,totalTSDisplay:i}){return{maintainAspectRatio:!1,layout:{autoPadding:!1},plugins:{legend:{labels:{boxWidth:20,color:"#495057"},title:{text:s,display:!0},position:"right"},title:{display:!0,text:t,align:"center",font:{size:"16px",weight:"bold"}},tooltip:{mode:"index",intersect:!0,filter:e=>!!e.raw,callbacks:{label:({dataIndex:t})=>{const{display:s,perc:i}=e[t];return`Timespent: ${s} (${i}%)`},footer:()=>`Total: ${i}`}}}}}function Zt({title:e,legendTitle:t,groupField:s,data:i}){const[a,r]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{const{$utils:o}=(0,g.WQ)("UtilsService"),a=i.sum("timeSpent"),n=i.groupBy(e=>e[s]||"(Unavailable)").map(({key:e,values:t})=>{const s=t.sum("timeSpent");return{label:e,total:s,display:o.formatSecs(s),perc:parseFloat((100*s/a).toFixed(2))}}),l={labels:n.map(({label:e})=>e),datasets:[{data:n.map(({total:e})=>e)}]};r({chartData:l,chartOptions:qt(n,{title:e,legendTitle:t,totalTimeSpent:a,totalTSDisplay:o.formatSecs(a)})})},[i,s,e,t,r]),a?(0,S.jsx)("div",{className:"chart-container",children:(0,S.jsx)(Jt.t,{type:"pie",data:a.chartData,options:a.chartOptions})}):(0,S.jsx)("span",{children:"Loading"})}const Kt=(0,S.jsx)("div",{className:"pad-15",children:"Loading... please wait while the report is being loaded. It may take few seconds / minute based on the range/filters you had selected."}),Xt=(0,S.jsx)("div",{className:"pad-15",children:"No data available to display."});const es=pe(function({selSprints:e,isLoading:t,useSprint:s,hasData:i,onSettingsChanged:o}){if(t)return Kt;if(!i)return null;let a=null;if(s){const t=Object.keys(e).filter(t=>{var s;return null===(s=e[t])||void 0===s?void 0:s.selected});t.length>1?a=(0,S.jsx)(de.J,{className:"no-padding multi-view",renderActiveOnly:!1,children:t.map(t=>(0,S.jsx)(de.K,{header:e[t].name,contentClassName:"no-padding",children:(0,S.jsx)(ts,{boardId:t,onSettingsChanged:o})}))}):t.length&&(a=(0,S.jsx)(ts,{boardId:t[0],onSettingsChanged:o}))}else a=(0,S.jsx)(ts,{onSettingsChanged:o});return(0,S.jsx)("div",{className:"worklog-report",children:a})},({reportLoaded:e,timeframeType:t,selSprints:s})=>({hasData:e,useSprint:"1"===t,selSprints:s})),ts=pe(function({boardId:e,hasData:t,showCostReport:s,showSummaryReport:i,isSprint:o,onSettingsChanged:a}){return t?(0,S.jsxs)(de.J,{className:"no-padding",renderActiveOnly:!1,children:[(0,S.jsx)(de.K,{header:"Grouped - [User daywise]",contentClassName:"no-padding",children:(0,S.jsx)(Lt,{exportSheetName:"Grouped - [User daywise]",boardId:e})}),s&&(0,S.jsx)(de.K,{header:"Cost Report",contentClassName:"no-padding",children:(0,S.jsx)(Lt,{exportSheetName:"Cost Report",boardId:e,costView:!0})}),!o&&(0,S.jsx)(de.K,{header:"Flat - [Issue daywise]",contentClassName:"no-padding",children:(0,S.jsx)(Pt,{exportSheetName:"Flat - [Issue daywise]",boardId:e})}),(0,S.jsx)(de.K,{header:"Flat (Groupable)",contentClassName:"no-padding",children:(0,S.jsx)(Gt,{exportSheetName:"Flat (Groupable)",boardId:e,onSettingsChanged:a})}),i&&(0,S.jsx)(de.K,{header:"Summary - (User project wise)",contentClassName:"no-padding",children:(0,S.jsx)(Ot,{exportSheetName:"Summary (User project wise)",boardId:e})}),(0,S.jsx)(de.K,{header:"Visualization",contentClassName:"no-padding",children:(0,S.jsx)(Qt,{exportSheetName:"Visualization",boardId:e})})]}):Xt},(e,{boardId:t})=>{const s="1"===e.timeframeType,{userListMode:i,reportUserGrp:o,fields:{showCostReport:a},[s?`sprintsList_${t}`:"groupReport"]:r}=e;return{hasData:!!r,isSprint:s,showCostReport:a&&"2"===i,showSummaryReport:!s&&"1"===o}});const ss=function(){return(0,S.jsxs)("div",{className:"pad-15",children:[(0,S.jsxs)("section",{children:[(0,S.jsx)("h2",{children:"How to Use"}),(0,S.jsxs)("ul",{children:[(0,S.jsx)("li",{children:"By default, this page allows you to generate a worklog report based on the selected date range."}),(0,S.jsxs)("li",{children:["To generate a report based on one or more sprints, click the",(0,S.jsx)("i",{className:"fa fa-cogs"})," icon to customize report settings."]}),(0,S.jsxs)("li",{children:["Click the ",(0,S.jsx)("i",{className:"fa fa-cogs"})," icon to access advanced report settings, including display formatting, additional columns, worklog filtering by threshold date, JQL data filtering, and more."]}),(0,S.jsxs)("li",{children:["Choose a date or sprint to view the report, or click the refresh",(0,S.jsx)("i",{className:"fa fa-refresh"})," icon to reload the report if a date or sprint is already selected."]}),(0,S.jsxs)("li",{children:["Manage user lists by clicking the ",(0,S.jsx)("i",{className:"fa fa-users"})," icon."]}),(0,S.jsxs)("li",{children:["Access Settings ",(0,S.jsx)("i",{className:"fa fa-arrow-right"})," User Groups in the left-hand menu to create and manage user groups for future use."]}),(0,S.jsx)("li",{children:"Configure time zone settings for each user and group when adding them to a group. Select the appropriate options in settings as well."}),(0,S.jsxs)("li",{children:["Additional settings for this report can be found in Settings ",(0,S.jsx)("i",{className:"fa fa-arrow-right"}),"General in the left-hand menu."]})]}),(0,S.jsxs)("p",{children:[(0,S.jsx)("strong",{children:"Note:"})," Any changes made to the group or users under the group on this page will not be saved and are only applicable for this session."]})]}),(0,S.jsxs)("section",{children:[(0,S.jsx)("h2",{children:"What's New"}),(0,S.jsxs)("ul",{children:[(0,S.jsx)("li",{children:"Alternate option to view the report based on sprints instead of date range selection."}),(0,S.jsx)("li",{children:"Option to filter or identify worklogs created after the threshold date."}),(0,S.jsx)("li",{children:"Ability to generate a report without specifying a user group."}),(0,S.jsx)("li",{children:"Option to pull all worklogs based on a selected project."}),(0,S.jsx)("li",{children:"Automatic grouping of users and worklogs by project, epic, or issue type when pulling worklogs based on a date range."})]})]})]})};class is extends m.Ay{constructor(e){super(e,"Worklog Report","fa-clock"),this.showSettings=()=>this.setState({showSettings:!0}),this.settingsChanged=()=>this.setState({showSettings:!1}),this.showGroups=()=>this.setState({showGroupsPopup:!0}),this.hideGroups=e=>{this.props.groupsChanged(e),this.setState({showGroupsPopup:!1}),this.props.isGadget&&this.saveSettings()},this.refreshData=()=>{this.selSprints=this.props.selSprints,this.dateRange=this.props.dateRange,this.props.fetchData()},this.inputChanged=()=>{this.selSprints===this.props.selSprints&&this.dateRange===this.props.dateRange||(this.saveSettings(),this.refreshData())},this.saveSettings=async()=>{const{isGadget:e}=this.props,t=this.props.getSettingsToStore({incUserGroups:e});e?(this.settings={...this.settings,reportSettings:t},super.saveSettings()):await this.$config.saveSettings("reports_WorklogReport",t)},(0,g.WQ)(this,"ConfigService"),this.selSprints=e.selSprints}UNSAFE_componentWillReceiveProps(e){const{isLoading:t}=e;this.setState({isLoading:t}),super.UNSAFE_componentWillReceiveProps(e)}renderCustomActions(){return(0,S.jsxs)(S.Fragment,{children:[!this.state.showSettings&&(0,S.jsx)(Qe,{onInputChanged:this.inputChanged,showGroupsPopup:this.showGroups}),(0,S.jsx)(f.$n,{text:!0,icon:"fa fa-cogs",onClick:this.showSettings,title:"Show settings"})]})}render(){const{showWorklogPopup:e,worklogItem:t,worklogAdded:s,hideWorklog:i,userGroups:o,reportLoaded:a}=this.props,{showSettings:r,showGroupsPopup:n,isLoading:l}=this.state;return super.renderBase((0,S.jsxs)("div",{className:"worklog-report-container",children:[r&&(0,S.jsx)(pt,{onHide:this.settingsChanged}),n&&(0,S.jsx)(le.A,{groups:o,onHide:this.hideGroups}),!a&&!l&&(0,S.jsx)(ss,{}),a&&(0,S.jsx)(es,{isLoading:l,onSettingsChanged:this.saveSettings}),e&&(0,S.jsx)(y.A,{worklog:t,onDone:s,onHide:i,uploadImmediately:!0})]}))}}const os=ue(is,({selSprints:e,dateRange:t,loadingData:s,reportLoaded:i,showWorklogPopup:o,worklogItem:a,userGroups:r})=>({selSprints:e,dateRange:t,isLoading:s,reportLoaded:i,showWorklogPopup:o,worklogItem:a,userGroups:r}),{fetchData:function(e,t){return async function(){const{timeframeType:s}=t();"1"===s?await function(e,t){return async function(){const s=t(),{selSprints:i,sprintStartRounding:o,sprintEndRounding:a,daysToHide:n,timeZone:l}=s,d=Object.keys(i).filter(e=>{var t;return null===(t=i[e])||void 0===t?void 0:t.selected});if(!d.length)return;const{$jira:c,$session:{CurrentUser:{name:h}}}=(0,g.WQ)("JiraService","SessionService"),u={loadingData:!1,errorTitle:"",errorMessage:""};try{e({loadingData:!0,reportLoaded:!1});const t=await c.getRapidSprintList(d,!0);for(const e of d){const d=Ie(e,i,t);u[`sprintsList_${e}`]=d;const c=[],p={},m=[];u[`flatWorklogs_${e}`]=m;for(const e of d){const{id:t,startDate:i,endDate:d,completeDate:g=d,previousSprintEnd:f,nextSprintStart:x}=e,v=r()(i),y=r()(g),k={fromDate:v.toDate(),toDate:y.toDate(),timeZone:l,daysToHide:n};"2"===o?k.fromDate=v.startOf("day").toDate():"3"===o?k.fromDate=v.startOf("day").add(1,"days").toDate():"4"===o&&f&&f instanceof Date&&(k.fromDate=r()(new Date(f)).add(1,"seconds").toDate()),"2"===a?k.toDate=y.endOf("day").toDate():"3"===a?k.toDate=y.endOf("day").add(-1,"days").toDate():"4"===a&&x&&x instanceof Date&&(k.toDate=r()(new Date(x)).add(-1,"seconds").toDate());const{issues:w,epicDetails:S}=await Me(t,k.fromDate,k.toDate,s);if(!w.length){u[`groupReport_${t}`]=null;continue}const{userwiseLog:b,userwiseLogArr:C}=Se(w,r()(k.fromDate),r()(k.toDate),null===h||void 0===h?void 0:h.toLowerCase(),s,S),{groupReport:N,flatWorklogs:T}=Re(e,b,k,s);m.addRange(T),u[`groupReport_${t}`]=N,C.forEach(e=>{const t=(0,j.J3)(e,!0);p[t]||(c.push(e),p[t]=!0)}),e.settings=k}u[`userGroup_${e}`]=Le(d,u,c,s)}u.reportLoaded=!0}catch(f){var p,m;console.error("Error pulling sprint report:",f);const{$message:t}=(0,g.WQ)("MessageService"),s=f.message||(null===(p=f.error)||void 0===p||null===(m=p.errorMessages)||void 0===m?void 0:m[0])||"Unknown error. Check the console for more details",i=f.message?"Worklog report":"Unknown error";e({errorTitle:i,errorMessage:s}),t.error(s,i)}finally{e(u)}}}(e,t)():await Te(e,t)()}},setStateValue:Fe,worklogAdded:function(e){return function(){e({showWorklogPopup:!1,worklogItem:null})}},hideWorklog:function(e){return function(){e({showWorklogPopup:!1,worklogItem:null})}},getSettingsToStore:function(e,t){return function(e){return me(t(),e)}},groupsChanged:function(e){return function(t){t&&Array.isArray(t)&&e({userGroups:t})}}},null,({isGadget:e,settings:t})=>{let s=null;if(e)s=null===t||void 0===t?void 0:t.reportSettings;else{const{$session:e}=(0,g.WQ)("SessionService");s=e.pageSettings.reports_WorklogReport}return async function(e,t={}){var s;const{$session:i,$usergroup:o}=(0,ee.WQ)("SessionService","UserGroupService"),{maxHours:a,projects:r,epicNameField:n,rapidViews:l}=i.CurrentUser,d=60*(a||8)*60,c=me(e);null===l||void 0===l||!l.length||null!==(s=c.sprintBoards)&&void 0!==s&&s.length||(c.sprintBoards=l);const h=ge(c);return{userGroups:e.userGroups||await o.getUserGroups(),...c,...h,maxHours:d,projects:r,epicField:null===n||void 0===n?void 0:n.id,sprintBoardsFromSettings:l,...t}}(s||{})});function as(){return`#${Math.floor(16777215*Math.random()).toString(16)}`}function rs(e){const{$userutils:t}=(0,ee.WQ)("UserUtils");return{responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{mode:"index",intersect:!0,filter:e=>!!e.raw,callbacks:{title:function(s){const i=s[0].parsed.x,o=e[i];return t.formatDate(o)},footer:e=>`Total: ${e.map(({raw:e})=>e).sum()} hours`}},legend:{title:{text:"Issues",fontColor:"red"},position:"bottom",labels:{color:"#495057"}}},scales:{x:{stacked:!0,ticks:{color:"#495057"},grid:{color:"#ebedef"},label:{display:!0,text:"Hours spent"}},y:{stacked:!0,ticks:{color:"#495057"},grid:{color:"#ebedef"},label:{display:!0,text:"Hours spent"}}}}}const ns=function({lastUpdated:e,setLoader:t,settings:{dateRange:s}}){const[i,a]=(0,o.useState)();return(0,o.useEffect)(()=>{null!==s&&void 0!==s&&s.fromDate&&(null===t||void 0===t||t(!0),async function(e){const{fromDate:t,toDate:s}=e,{$utils:i}=(0,ee.WQ)("UtilsService"),o=await async function(e){const{$worklog:t}=(0,ee.WQ)("WorklogService"),s=await t.getWorklogs(e);if(!s.length)return;const{fromDate:i}=e,o=r()(i),a=s.groupBy(e=>e.ticketNo).map(({key:e,values:t})=>{const s=t.reduce((e,t)=>{const s=Math.abs(o.diff(t.dateStarted,"days"));return e[s]=(e[s]||0)+t.totalMins,e},[]).map(e=>e?e/60:0);return{label:e,backgroundColor:as(),data:s}});return a}(e);if(!o)return!1;const a=i.getDateArray(t,s),n=a[0].getMonth()===a[a.length-1].getMonth();return{data:{labels:a.map(n?e=>e.getDate():(e,t)=>0===t||1===e.getDate()?e.format("MMM dd"):e.getDate()),datasets:o},options:rs(a)}}(function(e){let{fromDate:t,toDate:s,...i}=e;return"string"===typeof t&&(t=r()(t).toDate()),"string"===typeof s&&(s=r()(s).toDate()),{fromDate:t,toDate:s,...i}}(s)).then(a).finally(()=>null===t||void 0===t?void 0:t(!1)))},[s,e,a,t]),null!==s&&void 0!==s&&s.fromDate?i?(0,S.jsx)("div",{className:"worklog-bar-chart-gadget",children:(0,S.jsx)(Jt.t,{type:"bar",data:i.data,options:i.options})}):(0,S.jsx)("div",{className:"pad-15",children:"No worklog data available for the selected date range"}):(0,S.jsx)("div",{className:"pad-15",children:"Date range is not configured. Configure date range to visualize data"})};class ls extends m.Ay{constructor(e){super(e,"Worklog Bar Chart","fa-bar-chart"),this.refreshData=async()=>this.setState({lastUpdated:new Date}),this.dateSelected=e=>{this.settings.dateRange=e,e.toDate&&(this.refreshData(),e.auto||this.saveSettings())},(0,ee.WQ)(this,"WorklogService","UtilsService","MessageService")}executeEvent(e){e.type!==m.v8.AddWorklog&&e.type!==m.v8.DeletedWorklog&&e.type!==m.v8.WorklogModified||this.refreshData()}renderCustomActions(){return(0,S.jsx)(f.lr,{range:!0,value:this.settings.dateRange,onChange:this.dateSelected,style:{marginRight:"35px"}})}render(){var e;const{state:{isLoading:t,lastUpdated:s}}=this;return super.renderBase((0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ns,{lastUpdated:s,settings:this.settings,setLoader:this.setLoader}),(0,S.jsx)(M,{enabled:!t&&this.context.needReload,onChange:this.refreshData},null===(e=this.context.timerEntry)||void 0===e?void 0:e.key)]}))}}ls.contextType=L.dg;const ds=ls;class cs extends N.A{constructor(e){super(e,"Add Bookmark"),this.addBookmark=()=>{const{ticketsList:e}=this.state;e.length>0?(this.setState({isLoading:!0}),this.$bookmark.addBookmark(e).then(t=>{0===t.length?this.onHide(!0):(this.setState({isLoading:!1,ticketsList:t}),e.length===t.length?this.$message.warning("None of the ticket numbers provided are valid."):e.length>t.length&&this.$message.warning("Some of the ticket numbers provided are not valid."))})):this.onHide()},this.listChanged=e=>this.setState({ticketsList:e}),(0,ee.WQ)(this,"BookmarkService","MessageService"),this.style.width="380px",this.state.ticketsList=[]}getFooter(){return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(f.$n,{text:!0,type:"default",onClick:this.onHide,label:"Cancel",icon:"fa fa-times"}),(0,S.jsx)(f.$n,{type:"primary",onClick:this.addBookmark,label:"Save",icon:"fa fa-save"})]})}render(){const{state:{ticketsList:e}}=this;return super.renderBase((0,S.jsxs)("div",{className:"pad-22",children:[(0,S.jsx)(f.uq,{value:e,onChange:this.listChanged,className:"mb-2",minItemLength:4,useUpperCase:!0,placeholder:"Enter one or more ticket numbers"}),(0,S.jsx)("strong",{children:"Note:"})," Press enter key to add multiple items"]}))}}const hs=cs;var us=s(8615);class ps extends m.Ay{constructor(e){super(e,"My Bookmarks","fa-bookmark"),this.refreshData=()=>{this.setState({isLoading:!0,showAddPopup:!1}),this.$bookmark.getBookmarks().then(e=>{const{selAllChk:t}=this.state;e.forEach(e=>{e.ticketUrl=this.$userutils.getTicketUrl(e.ticketNo),e.selected=t,e.rowClass=this.$utils.getRowStatus(e)}),this.setState({isLoading:!1,bookmarksList:e})})},this.startTimer=()=>this.context.startTimer(this.selectedTicket.ticketNo),this.selectAll=e=>{let{bookmarksList:t}=this.state;t=[...t],t.forEach(t=>t.selected=e),this.setState({selAllChk:e,bookmarksList:t})},this.deleteSelection=()=>this.deleteBookmark(),this.showAddPopup=()=>this.setState({showAddPopup:!0}),this.hideAddPopup=e=>{e?this.refreshData():this.setState({showAddPopup:!1})},(0,g.WQ)(this,"JiraService","BookmarkService","UtilsService","UserUtilsService","MessageService"),this.contextMenu=[{label:"Select Bookmark",icon:"fa fa-check-square",command:()=>this.selectTicket(this.selectedTicket)},{label:"Add worklog",icon:"fa fa-clock",command:()=>this.addWorklogOn(this.selectedTicket.ticketNo)},{label:"Delete Bookmark",icon:"fa fa-trash",command:()=>this.deleteBookmark(this.selectedTicket.ticketNo)}],this.state.selAllBks=!1,this.state.bookmarksList=[]}selectTicket(e){e.selected=!e.selected;let{bookmarksList:t}=this.state;t=[...t],this.setState({bookmarksList:t})}componentDidMount(){super.componentDidMount(),this.refreshData()}showContext(e,t){this.selectedTicket=t;const s=[...this.contextMenu];try{const e=this.context.getElapsedTimeInSecs(),i=(null===e||void 0===e?void 0:e.key)===t.ticketNo,o=null===e||void 0===e?void 0:e.isRunning;i?(o?s.push({label:"Pause timer",icon:"fa fa-pause",command:this.context.pauseTimer}):s.push({label:"Resume timer",icon:"fa fa-play",command:this.context.resumeTimer}),s.push({label:"Stop timer",icon:"fa fa-stop",command:this.context.stopTimer})):s.push({label:"Start timer",icon:"fa fa-play",command:this.startTimer})}catch{}(0,v.O0)(e,s)}deleteBookmark(e){let t;t=e?[e]:this.state.bookmarksList.filter(e=>e.selected).map(e=>e.ticketNo),0!==t.length?us.A.confirmDelete("Are you sure to delete the selected bookmark(s)?","Confirm delete bookmark(s)").then(()=>{this.setState({isLoading:!0}),this.$bookmark.removeBookmark(t).then(e=>{this.setState({bookmarksList:e,isLoading:!1})})}):this.$message.info("Select the bookmarks to be deleted!")}executeEvent(e){e.type===i.v.TicketBookmarked&&this.refreshData()}renderCustomActions(){return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(f.$n,{text:!0,icon:"fa fa-plus",onClick:this.showAddPopup,title:"Add ticket to bookmarks"}),(0,S.jsx)(f.$n,{text:!0,type:"danger",icon:"fa fa-trash",onClick:this.deleteSelection,title:"Remove selected ticket(s) from bookmarks"})]})}render(){const{bookmarksList:e,selAllChk:t,showAddPopup:s}=this.state;return super.renderBase((0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(te.ew,{dataset:e,exportSheetName:"My bookmarks",children:[(0,S.jsx)(te.D1,{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)(te.VP,{className:"w40",noExport:!0,children:(0,S.jsx)(f.Sc,{checked:t,onChange:this.selectAll})}),(0,S.jsx)(te.VP,{sortBy:"ticketNo",children:"Ticket No"}),(0,S.jsx)(te.VP,{sortBy:"issuetype",children:"Type"}),(0,S.jsx)(te.VP,{sortBy:"summary",children:"Summary"}),(0,S.jsx)(te.VP,{sortBy:"assigneeName",children:"Assignee"}),(0,S.jsx)(te.VP,{sortBy:"reporter",children:"Reporter"}),(0,S.jsx)(te.VP,{sortBy:"priority",children:"Priority"}),(0,S.jsx)(te.VP,{sortBy:"status",children:"Status"}),(0,S.jsx)(te.VP,{sortBy:"resolution",children:"Resolution"}),(0,S.jsx)(te.VP,{sortBy:"createdSortable",children:"Created"}),(0,S.jsx)(te.VP,{sortBy:"updatedSortable",children:"Updated"})]})}),(0,S.jsx)(te.vc,{children:(e,t)=>(0,S.jsxs)("tr",{"data-test-id":e.ticketNo,onContextMenu:t=>this.showContext(t,e),className:e.rowClass,children:[(0,S.jsxs)("td",{className:"text-center",children:[e.selected&&(0,S.jsx)(f.Sc,{checked:!0,onChange:()=>this.selectTicket(e)}),!e.selected&&(0,S.jsx)("i",{className:"fa fa-ellipsis-v",onClick:t=>this.showContext(t,e)})]}),(0,S.jsx)("td",{children:(0,S.jsx)(w.A,{href:e.ticketUrl,className:"link strike",children:e.ticketNo})}),(0,S.jsxs)("td",{children:[e.issuetypeIcon&&(0,S.jsx)(f._V,{src:e.issuetypeIcon}),e.issuetype]}),(0,S.jsx)("td",{children:e.summary}),(0,S.jsx)("td",{children:e.assigneeName}),(0,S.jsx)("td",{children:e.reporterName}),(0,S.jsxs)("td",{children:[e.priorityIcon&&(0,S.jsx)(f._V,{src:e.priorityIcon}),e.priority]}),(0,S.jsxs)("td",{children:[e.statusIcon&&(0,S.jsx)(f._V,{src:e.statusIcon}),e.status]}),(0,S.jsxs)("td",{children:[e.resolutionIcon&&(0,S.jsx)(f._V,{src:e.resolutionIcon}),e.resolution]}),(0,S.jsx)("td",{children:e.created}),(0,S.jsx)("td",{children:e.updated})]},e.ticketNo)}),(0,S.jsx)(te.QC,{span:11,children:"You have not yet bookmarked any tickets. Bookmark your frequently used tickets"})]}),s&&(0,S.jsx)(hs,{onHide:this.hideAddPopup})]}))}}ps.contextType=L.dg;const ms=ps;class gs extends m.Ay{constructor(e){super(e,"My open tickets","fa-eye"),this.refreshData=async e=>{this.setState({isLoading:!0});try{const t=(await this.$jira.getOpenTickets(e)).map(e=>{const t=e.fields;return{ticketNo:e.key,ticketUrl:this.$userutils.getTicketUrl(e.key),issuetypeIcon:(t.issuetype||{}).iconUrl,issuetype:(t.issuetype||{}).name,summary:t.summary,reporter:(t.reporter||{}).displayName,priorityIcon:(t.priority||{}).iconUrl,priority:(t.priority||{}).name,statusIcon:(t.status||{}).iconUrl,status:(t.status||{}).name,resolutionIcon:(t.resolution||{}).iconUrl,resolution:(t.resolution||{}).name,createdSortable:t.created,updatedSortable:t.updated,created:this.$userutils.formatDateTime(t.created),updated:this.$userutils.formatDateTime(t.updated)}});this.setState({ticketList:t,isLoading:!1})}finally{this.setState({isLoading:!1})}},this.bookmarkAdded=()=>this.performAction(m.v8.TicketBookmarked),(0,g.WQ)(this,"JiraService","BookmarkService","UserUtilsService"),this.state.isLoading=!0,this.state.ticketList=[]}componentDidMount(){super.componentDidMount(),this.refreshData()}getHint(){return(0,S.jsxs)("ul",{className:"gadget-hint",children:[(0,S.jsx)("li",{children:"By default, unresolved ticket list assigned to you are shown in this gadget"}),(0,S.jsx)("li",{children:'You can control the list of tickets to be shown, by editing "Open tickets JQL" in Advanced Settings'}),(0,S.jsx)("li",{children:"Right click on any ticket to start time tracking or see more options"})]})}render(){const{ticketList:e}=this.state;return super.renderBase((0,S.jsxs)(te.ew,{dataset:e,exportSheetName:"My open tickets",children:[(0,S.jsx)(te.D1,{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)(te.VP,{sortBy:"ticketNo",children:"Ticket No"}),(0,S.jsx)(te.VP,{sortBy:"issuetype",children:"Type"}),(0,S.jsx)(te.VP,{sortBy:"summary",children:"Summary"}),(0,S.jsx)(te.VP,{sortBy:"reporter",children:"Reporter"}),(0,S.jsx)(te.VP,{sortBy:"priority",children:"Priority"}),(0,S.jsx)(te.VP,{sortBy:"status",children:"Status"}),(0,S.jsx)(te.VP,{sortBy:"resolution",children:"Resolution"}),(0,S.jsx)(te.VP,{sortBy:"createdSortable",children:"Created"}),(0,S.jsx)(te.VP,{sortBy:"updatedSortable",children:"Updated"})]})}),(0,S.jsx)(te.vc,{children:(e,t)=>(0,S.jsx)(fs,{ticket:e,onAddWorklog:this.addWorklogOn,onBookmark:this.bookmarkAdded},t)}),(0,S.jsx)(te.QC,{span:9,children:"No open tickets were assigned to you. Enjoy your day!"})]}))}showContext(e,t){this.selectedTicket=t,(0,v.O0)(e,this.contextMenu)}}class fs extends o.PureComponent{constructor(...e){super(...e),this.setRef=e=>this.keyCtr=e,this.showContext=e=>this.keyCtr.showContext(e)}render(){const{ticket:e,onAddWorklog:t,onBookmark:s}=this.props;return(0,S.jsxs)("tr",{onContextMenu:this.showContext,"data-test-id":e.ticketNo,children:[(0,S.jsx)(J.JA,{ref:this.setRef,value:e.ticketNo,onAddWorklog:t,onBookmark:s}),(0,S.jsxs)("td",{children:[(0,S.jsx)(f._V,{src:e.issuetypeIcon}),e.issuetype]}),(0,S.jsx)("td",{children:e.summary}),(0,S.jsx)("td",{children:e.reporter}),(0,S.jsxs)("td",{children:[(0,S.jsx)(f._V,{src:e.priorityIcon}),e.priority]}),(0,S.jsxs)("td",{children:[(0,S.jsx)(f._V,{src:e.statusIcon}),e.status]}),(0,S.jsxs)("td",{children:[e.resolutionIcon&&(0,S.jsx)(f._V,{src:e.resolutionIcon}),e.resolution]}),(0,S.jsx)("td",{children:e.created}),(0,S.jsx)("td",{children:e.updated})]})}}const xs=gs;class vs extends m.Ay{constructor(e){super(e,"My Reports","fa-filter"),this.refreshData=()=>{this.setState({isLoading:!0}),this.$report.getReportsList().then(e=>{const{selAllChk:t}=this.state;e.forEach(e=>{e.selected=t,e.displayDate=this.$userutils.formatDateTime(e.dateCreated),e.sortDate=e.dateCreated.getTime()}),this.setState({reportsList:e,isLoading:!1})})},this.deleteSelectedReports=()=>{const e=this.state.reportsList.filter(e=>e.selected).map(e=>e.id);0!==e.length?us.A.confirmDelete("Are you sure to delete the selected report(s)?","Confirm delete report(s)").then(()=>{this.setState({isLoading:!0}),this.$report.deleteSavedQuery(e).then(()=>this.refreshData())}):this.$message.info("Select the reports to be deleted!")},this.selectAll=()=>{let{reportsList:e,selAllChk:t}=this.state;t=!t,e.forEach(e=>e.selected=t),e=[...e],this.setState({reportsList:e,selAllChk:t,selReportsCount:t?e.length:null})},this.downloadReports=()=>{const e=this.state.reportsList.filter(e=>e.selected).map(e=>e.id);0!==e.length?this.$report.exportQueries(e):this.$message.info("Select the reports to be exported!")},this.fileSelected=()=>{const e=this.fileSelector,t=e.files[0];if(t){if(!t.name.endsWith(".jrd"))return this.$message.warning("Unknown file selected to import. Select a valid Jira Assist Report definition (*.jrd) file"),void(e.value="");const s=new FileReader;s.readAsText(t,"UTF-8"),s.onload=e=>{const t=e.target.result;try{const e=JSON.parse(t).reports;if(!e||!Array.isArray(e))return void this.$message.error("Selected file is invalid or is corrupted");e.forEach(e=>{e.oldName=e.queryName,e.selected=!0,e.status="Will import"}),this.setState({reportsToImport:e})}catch(s){this.$message.error("Selected file is invalid or is corrupted")}},s.onerror=e=>{this.$message.error("Selected file is invalid or is corrupted. Unable to load the file!")}}e.value=""},this.editReport=e=>{let t="customgrouped";"pivot"===e.reportType?t="pivot":e.advanced?t="advanced":e.isNew&&(t="custom"),this.context.navigate(`/reports/${t}/${e.id}`,!0)},this.hideImportPopup=e=>{e&&this.refreshData(),this.setState({reportsToImport:null})},this.setFileSelector=e=>this.fileSelector=e,this.chooseFileForImport=()=>this.fileSelector.click(),(0,g.WQ)(this,"ReportService","MessageService","UserUtils"),this.state.isLoading=!0}componentDidMount(){super.componentDidMount(),this.refreshData()}getReportType(e){return"pivot"===e.reportType?"Pivot report":e.isNew?"Custom report":e.advanced?"Advanced report":"Custom Report (Old)"}selectRowItem(e){e.selected=!e.selected;let{reportsList:t}=this.state;t=[...t];const s=t.count(e=>e.selected);this.setState({reportsList:t,selReportsCount:s})}renderCustomActions(){return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("input",{ref:this.setFileSelector,type:"file",className:"hide",accept:".jrd",onChange:this.fileSelected}),(0,S.jsx)(f.$n,{text:!0,icon:"fa fa-upload",onClick:this.chooseFileForImport,title:"Import reports shared by others"}),(0,S.jsx)(f.$n,{text:!0,icon:"fa fa-download",disabled:!this.state.selReportsCount,onClick:this.downloadReports,title:"Export reports to share with others"}),(0,S.jsx)(f.$n,{text:!0,type:"danger",icon:"fa fa-trash",onClick:this.deleteSelectedReports,title:"Delete selected report(s)"})]})}render(){const{reportsList:e,selAllChk:t,reportsToImport:s}=this.state;return super.renderBase((0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(te.ew,{dataset:e,exportSheetName:"My reports",children:[(0,S.jsx)(te.D1,{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)(te.VP,{className:"w40",children:(0,S.jsx)(f.Sc,{checked:t,onChange:this.selectAll})}),(0,S.jsx)(te.VP,{sortBy:"queryName",children:"Report name"}),(0,S.jsx)(te.VP,{sortBy:"sortDate",children:"Created On"}),(0,S.jsx)(te.VP,{sortBy:"advanced",children:"Report type"}),(0,S.jsx)(te.VP,{sortBy:"outputCount",children:"Output fields"}),(0,S.jsx)(te.VP,{children:"Options"})]})}),(0,S.jsx)(te.vc,{children:e=>(0,S.jsxs)("tr",{children:[(0,S.jsx)("td",{className:"text-center",children:(0,S.jsx)(f.Sc,{checked:e.selected,onChange:()=>this.selectRowItem(e)})}),(0,S.jsx)("td",{children:e.queryName}),(0,S.jsx)("td",{children:e.displayDate}),(0,S.jsx)("td",{children:this.getReportType(e)}),(0,S.jsx)("td",{children:e.outputCount}),(0,S.jsx)("td",{className:"text-center",children:(0,S.jsx)(f.$n,{icon:"fa fa-edit",onClick:()=>this.editReport(e),title:"Click to edit this report"})})]},e.id)}),(0,S.jsx)(te.QC,{span:7,children:"You have not yet created or imported any reports."})]}),s&&(0,S.jsx)(ks,{reportsToImport:s,onHide:this.hideImportPopup})]}))}}vs.contextType=L.BR;const ys=vs;class ks extends N.A{constructor(e){super(e,"Select reports to import"),this.selectAllReports=()=>{let{selectAll:e,reportsToImport:t}=this.state;e=!e,t=[...t],t.forEach(t=>{t.selected=!t.disabled&&e,this.updateReportStatus(t)}),this.setState({selectAll:e,reportsToImport:t,selReportsCount:this.getReportsCount(t)})},this.getReportsCount=e=>(e||this.state.reportsToImport).filter(e=>e.selected).length,this.importReports=()=>{const e=this.state.reportsToImport.filter(e=>e.selected),t=e.map(e=>{const t={...e};return delete t.selected,delete t.id,delete t.oldName,delete t.status,this.$report.saveQuery(t).then(t=>(e.selected=!1,e.disabled=!0,e.status="Imported",!0),()=>(e.status="Duplicate name",!1))});Promise.all(t).then(t=>{if(t.some(e=>!e)){this.$message.error("Some of the reports were not import!","Import failed");let{reportsToImport:e}=this.state;e=[...e],this.setState({selReportsCount:this.getReportsCount(e),reportsToImport:e})}else this.$message.success(`${e.length} selected reports were imported`,"Reports imported"),this.onHide(!0)})},(0,g.WQ)(this,"UserUtilsService","MessageService","ReportService"),this.style={width:"850px"},this.state.selectAll=!0,this.state.reportsToImport=this.props.reportsToImport,this.state.selReportsCount=this.getReportsCount()}reportSelected(e){e.selected=!e.selected,this.updateReportStatus(e),this.setState({selReportsCount:this.getReportsCount()})}updateReportStatus(e){e.selected?(e.queryName||(e.queryName=e.oldName),e.status="Will import"):e.status="Excluded"}reportNameChanged(e,t){e.queryName=t,e.queryName?e.status="Will import":e.status="Name required",this.forceUpdate()}getFooter(){const{selReportsCount:e}=this.state;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(f.$n,{text:!0,icon:"fa fa-times",onClick:this.onHide,label:"Cancel",type:"default"}),(0,S.jsx)(f.$n,{icon:"fa fa-check",disabled:!e,onClick:this.importReports,label:"Import",type:"primary"})]})}render(){const{reportsToImport:e,selectAll:t}=this.state;return super.renderBase((0,S.jsx)("div",{children:(0,S.jsxs)(te.ew,{dataset:e,children:[(0,S.jsx)("caption",{children:"Select all the reports which you would like to import and provide a name for the report to import."}),(0,S.jsx)(te.D1,{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{className:"no-min-width",children:(0,S.jsx)(f.Sc,{checked:t,onChange:this.selectAllReports})}),(0,S.jsx)("th",{children:"Report name"}),(0,S.jsx)("th",{children:"Report name (new)"}),(0,S.jsx)("th",{children:"Created date"}),(0,S.jsx)("th",{children:"Last modified date"}),(0,S.jsx)("th",{children:"Status"})]})}),(0,S.jsx)(te.vc,{children:(e,t)=>(0,S.jsxs)("tr",{children:[(0,S.jsx)("td",{className:"data-center",children:(0,S.jsx)(f.Sc,{checked:e.selected,disabled:e.disabled,onChange:t=>this.reportSelected(e,t)})}),(0,S.jsx)("td",{children:e.oldName}),(0,S.jsx)("td",{children:(0,S.jsx)(f.fI,{value:e.queryName,disabled:e.disabled||!e.selected,onChange:t=>this.reportNameChanged(e,t)})}),(0,S.jsx)("td",{children:this.$userutils.formatDateTime(e.dateCreated)}),(0,S.jsx)("td",{children:this.$userutils.formatDateTime(e.dateUpdated)}),(0,S.jsx)("td",{children:e.status})]},`${t}_${e.status}`)})]})}))}}class js extends m.Ay{constructor(e){super(e,"Worklog - [Pending upload]","fa-clock"),this.refreshData=()=>(this.state.isLoading||this.setState({isLoading:!0}),this.$worklog.getPendingWorklogs().then(e=>{const{selAllChk:t}=this.state;e.forEach(e=>{e.ticketUrl=this.$userutils.getTicketUrl(e.ticketNo),e.rowClass=this.$utils.getRowStatus(e),e.displayDate=this.$userutils.formatDateTime(e.dateStarted),e.selected=t,e.timeSpent=this.$utils.formatTs(e.overrideTimeSpent||e.timeSpent)}),this.setState({isLoading:!1,worklogs:e})})),this.selectAll=e=>{const{worklogs:t}=this.state;t.forEach(t=>t.selected=e),this.setState({worklogs:[...t],selAllChk:e})},(0,g.WQ)(this,"WorklogService","UtilsService","UserUtilsService","MessageService"),this.contextMenu=[{label:"Select worklog",icon:"fa fa-check-square",command:()=>this.selectRowItem(this.selectedItem)},{label:"Edit worklog",icon:"fa fa-edit",command:()=>this.editWorklogObj()},{label:"Copy worklog",icon:"fa fa-copy",command:()=>this.editWorklogObj(!0)},{label:"Upload worklog",icon:"fa fa-upload",command:()=>this.uploadWorklog([this.selectedItem])},{label:"Delete worklog",icon:"fa fa-trash",command:()=>this.deleteWorklog([this.selectedItem])}],this.state.selAllChk=!0,this.state.isLoading=!0}componentDidMount(){super.componentDidMount(),this.refreshData()}getHint(){return(0,S.jsxs)("ul",{className:"gadget-hint",children:[(0,S.jsx)("li",{children:"List of worklog entries created and yet to be uploaded to Jira are shown here"}),(0,S.jsx)("li",{children:"You can upload, edit or delete the entries from here or from worklog calendar"})]})}editWorklogObj(e){const t=Object.create(this.selectedItem);t.copy=e,this.addWorklog(t)}showContext(e,t){this.selectedItem=t,(0,v.O0)(e,this.contextMenu)}async uploadWorklog(e){e||(e=this.state.worklogs.filter(e=>e.selected));const t=e.map(e=>e.id);if(0!==t.length){this.setState({isLoading:!0});try{const e=await this.$worklog.uploadWorklogs(t);this.setState({isLoading:!1,worklogs:e}),super.performAction(m.v8.WorklogModified)}catch(s){(s.message||s.response)&&this.$message.error(s.message||s.response)}finally{this.refreshData()}}else this.$message.info("Select the worklogs to be uploaded!")}deleteWorklog(e){e||(e=this.state.worklogs.filter(e=>e.selected));const t=e.map(e=>e.id);0!==t.length?us.A.confirmDelete("Are you sure to delete the selected worklog(s)?","Confirm delete worklog(s)").then(()=>{this.setState({isLoading:!0}),this.$worklog.deleteWorklogs(t).then(e=>{this.refreshData(),this.performAction(m.v8.DeletedWorklog)})}):this.$message.info("Select the worklogs to be deleted!")}executeEvent(e){e.type!==m.v8.AddWorklog&&e.type!==m.v8.DeletedWorklog&&e.type!==m.v8.WorklogModified||this.refreshData()}selectRowItem(e){e.selected=!e.selected;const{worklogs:t}=this.state;this.setState({worklogs:[...t]})}renderCustomActions(){return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(f.$n,{text:!0,icon:"fa fa-upload",onClick:()=>this.uploadWorklog(),title:"Upload selected worklogs"}),(0,S.jsx)(f.$n,{text:!0,type:"danger",icon:"fa fa-trash",onClick:()=>this.deleteWorklog(),title:"Delete selected worklogs"})]})}render(){var e;const{worklogs:t,selAllChk:s,isLoading:i}=this.state;return super.renderBase((0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(te.ew,{dataset:t,exportSheetName:"Pending worklogs",children:[(0,S.jsx)(te.D1,{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)(te.VP,{className:"w40",noExport:!0,children:(0,S.jsx)(f.Sc,{checked:s,onChange:this.selectAll})}),(0,S.jsx)(te.VP,{sortBy:"ticketNo",children:"Ticket No"}),(0,S.jsx)(te.VP,{sortBy:"summary",children:"Summary"}),(0,S.jsx)(te.VP,{sortBy:"summary",children:"Assignee"}),(0,S.jsx)(te.VP,{sortBy:"dateStarted",children:"Log Time"}),(0,S.jsx)(te.VP,{sortBy:"timeSpent",children:"Time Spent"}),(0,S.jsx)(te.VP,{children:"Description"})]})}),(0,S.jsx)(te.vc,{children:e=>(0,S.jsxs)("tr",{onContextMenu:t=>this.showContext(t,e),className:e.rowClass,"data-test-id":e.ticketNo,children:[(0,S.jsxs)("td",{className:"text-center",children:[e.selected&&(0,S.jsx)(f.Sc,{checked:!0,onChange:()=>this.selectRowItem(e)}),!e.selected&&(0,S.jsx)("i",{className:"fa fa-ellipsis-v",onClick:t=>this.showContext(t,e)})]}),(0,S.jsx)("td",{children:(0,S.jsx)(w.A,{href:e.ticketUrl,className:"link strike",children:e.ticketNo})}),(0,S.jsx)("td",{children:e.summary}),(0,S.jsx)("td",{children:e.assignee}),(0,S.jsx)("td",{children:e.displayDate}),(0,S.jsx)("td",{children:e.timeSpent}),(0,S.jsx)("td",{children:e.description})]},e.id)}),(0,S.jsx)(te.QC,{span:7,children:"No worklog pending to be uploaded!"})]}),(0,S.jsx)(M,{enabled:!i&&this.context.needReload,onChange:this.refreshData},null===(e=this.context.timerEntry)||void 0===e?void 0:e.key)]}))}}js.contextType=L.dg;const ws=js;class Ss extends m.Ay{constructor(e){super(e,"Ticketwise worklog","fa-list-alt"),this.refreshData=()=>{const e=this.settings.dateRange;e&&e.fromDate&&(this.setState({isLoading:!0}),e.dateWise=!1,this.$worklog.getWorklogs(e).then(e=>{e.forEach(e=>{e.rowClass=this.$utils.getRowStatus(e),e.ticketUrl=this.$userutils.getTicketUrl(e.ticketNo),e.totalHours=this.$utils.formatTs(e.totalHours),e.uploaded=this.$utils.formatTs(e.uploaded),e.pendingUpload=this.$utils.formatTs(e.pendingUpload)}),this.setState({isLoading:!1,worklogs:e})}))},this.dateSelected=e=>{this.settings.dateRange=e,e.toDate&&(this.refreshData(),e.auto||this.saveSettings())},(0,ee.WQ)(this,"WorklogService","UserUtilsService","UtilsService","MessageService"),this.contextMenu=[{label:"Upload worklog",icon:"fa fa-clock",command:()=>this.uploadWorklog()},{label:"Add worklog",icon:"fa fa-bookmark",command:()=>this.addWorklog()}]}componentDidMount(){super.componentDidMount(),this.refreshData()}showContext(e,t){this.selectedTicket=t,(0,v.O0)(e,this.contextMenu)}renderCustomActions(){return(0,S.jsx)(f.lr,{range:!0,value:this.settings.dateRange,onChange:this.dateSelected,style:{marginRight:"35px"}})}getWorklogUrl(e,t){return this.$userutils.getWorklogUrl(e,t)}getTicketUrl(e){return this.$userutils.getTicketUrl(e)}async uploadWorklog(){const e=this.selectedTicket.logData.filter(e=>!e.worklogId).map(e=>e.id);if(e.length){this.setState({isLoading:!0});try{await this.$worklog.uploadWorklogs(e),this.refreshData(),super.performAction(i.v.WorklogModified)}catch(t){t.message&&this.$message.error(t.message)}finally{this.setState({isLoading:!1})}}}addWorklog(){const{ticketNo:e}=this.selectedTicket,t=a().subtract(1,"hours").toDate();super.addWorklog({ticketNo:e,startTime:t,timeSpent:"01:00",allowOverride:!0})}render(){const{worklogs:e}=this.state;return super.renderBase((0,S.jsxs)(te.ew,{dataset:e,exportSheetName:"Ticketwise worklog",children:[(0,S.jsx)(te.D1,{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)(te.VP,{sortBy:"ticketNo",style:{width:"100px"},children:"Ticket No"}),(0,S.jsx)(te.VP,{sortBy:"summary",children:"Summary"}),(0,S.jsx)(te.VP,{sortBy:"totalHours",children:"Total Hours"}),(0,S.jsx)(te.VP,{sortBy:"uploaded",children:"Uploaded"}),(0,S.jsx)(te.VP,{sortBy:"pendingUpload",children:"Pending Upload"}),(0,S.jsx)(te.VP,{sortBy:"parentKey",children:"Parent Ticket"}),(0,S.jsx)(te.VP,{children:"Dates Logged"}),(0,S.jsx)(te.VP,{style:{width:"400px"},children:"Description"})]})}),(0,S.jsx)(te.vc,{children:e=>(0,S.jsxs)("tr",{onContextMenu:t=>this.showContext(t,e),className:e.rowClass,children:[(0,S.jsx)("td",{children:(0,S.jsx)(w.A,{href:e.ticketUrl,className:"link strike",children:e.ticketNo})}),(0,S.jsx)("td",{children:e.summary}),(0,S.jsx)("td",{children:e.totalHours}),(0,S.jsx)("td",{children:e.uploaded}),(0,S.jsx)("td",{children:e.pendingUpload}),(0,S.jsx)("td",{children:e.parentKey?`${e.parentKey} - ${e.parentSumm}`:""}),(0,S.jsx)("td",{children:(0,S.jsx)("ul",{className:"tags",children:e.logData.map((t,s)=>(0,S.jsxs)("li",{children:[t.worklogId&&(0,S.jsxs)(w.A,{className:"link badge rounded-pill skin-bg-font",href:this.getWorklogUrl(e.ticketNo,t.worklogId),title:t.comments,children:[(0,S.jsx)("span",{className:"fa fa-clock"}),"  ",(0,S.jsx)(J.Hl,{tag:"span",value:t.dateLogged}),": ",t.uploaded]}),!t.worklogId&&(0,S.jsxs)("span",{className:"link badge rounded-pill skin-bg-font",onClick:()=>this.editWorklog(t.id),title:t.comments,children:[(0,S.jsx)("span",{className:"fa fa-clock"})," ",(0,S.jsx)(J.Hl,{tag:"span",value:t.dateLogged}),": ",t.uploaded]})]},s))})}),(0,S.jsx)("td",{children:e.description})]},e.ticketNo)}),(0,S.jsx)(te.QC,{span:8,children:"No records exists"})]}))}}const bs=Ss,Cs=[{id:"myOpenTickets",icon:"fa-eye",name:"My Open Tickets",details:"This gadget contains a list of unresolved issues assigned to you by default. You can further customize the list by configuring the Jira Query Language (JQL) from the Advanced Settings page."},{id:"myBookmarks",icon:"fa-bookmark",name:"Bookmarks",details:"The Bookmarks gadget holds a list of bookmarked issues. You can manage your bookmarks directly from this gadget, and please note that the bookmark list is shared across all dashboards."},{id:"dateWiseWorklog",icon:"fa-list-alt",name:"Logged Work - [Daywise]",details:"This gadget displays a list of your worklogs grouped by date. You have control over the date range, which can be adjusted within the gadget."},{id:"worklogBarChart",icon:"fa-bar-chart",name:"Worklog Bar Chart",details:"In this gadget, worklogs added by the current user are represented as a stacked bar chart. You can customize the date range directly within the gadget."},{id:"teamWorklogReport",icon:"fa-bar-chart",name:"Team Daywise Worklog",details:"This gadget presents worklogs for individual users on a daily basis in a table format. You can configure both the user list and date range from within the gadget."},{id:"pendingWorklog",icon:"fa-clock",name:"Worklog - [Pending Upload]",details:"Worklogs added by you in Jira Assistant that are awaiting upload to Jira are listed in this gadget. You can review, edit, or choose to upload them to Jira directly from this gadget."},{id:"ticketWiseWorklog",icon:"fa-list-alt",name:"Logged Work - [Ticketwise]",details:"This gadget provides a list of worklogs added by you, grouped by individual issues. You have the flexibility to adjust the date range within the gadget."},{id:"myFilters",icon:"fa-filter",name:"My Reports",details:"In the My Reports gadget, you will find a list of custom and advanced reports that you have built or imported. You can edit or delete these reports directly from this gadget."},{id:"agendaDay",icon:"fa-calendar",name:"Current Day Calendar",details:"This gadget displays a calendar for the current date, showing worklogs and meetings for the day."},{id:"agendaWeek",icon:"fa-calendar",name:"Current Week Calendar",details:"In this gadget, you can view a calendar for the current week, featuring worklogs and meetings."},{id:"listDay",icon:"fa-calendar",name:"Current Day Worklog List",details:"The Current Day Worklog List gadget provides a list view of your calendar for the current date, including worklogs and meetings."},{id:"listWeek",icon:"fa-calendar",name:"Current Week Worklog List",details:"This gadget offers a list view of your calendar for the current week, showing worklogs and meetings."},{id:"listMonth",icon:"fa-calendar",name:"Current Month Worklog List",details:"View your calendar as a list for the current month, including worklogs and meetings, in the Current Month Worklog List gadget."},{id:"sWiseTSpent",icon:"fa-list-alt",name:"Status Wise Time Spent",details:"The Status Wise Time Spent gadget provides a summary of time spent on each ticket, organized by individual status."}]},4353:(e,t,s)=>{s.d(t,{L:()=>n});var i=s(3302),o=s(4588),a=(s(764),s(374)),r=s(1219);class n{export(){this.format&&"XLSX"===this.format.toUpperCase()?this.exportToXlsx():this.format&&this.format===a.A.PDF?this.exportToPDF():this.exportToCsv()}exportToXlsx(){const e=i(this.element),t=new a.h(a.A.XLSX);e.find("table.exportable").each((e,s)=>t.addTable(s)),t.export(this.fileName)}exportToCsv(){let e=i(this.element);e.is("table")||(e=e.find("table.exportable")),this.exportTable(e,e.attr("export-sheet-name")||this.fileName||"download")}exportToPDF(){const e=i(this.element),t=e.is("table")?e:e.find("table.exportable"),s=t.attr("export-sheet-name")||this.fileName||"download",a=new o.default({orientation:"landscape",unit:"px",format:"a3"});a.autoTable({html:t.get(0)});const r=e.find(".exportable-image");r.length&&(a.addPage(),r.each((e,t)=>this.addImageToPdf(a,t))),a.save(`${s}.pdf`)}addImageToPdf(e,t){if(!t)return;const s=t.tagName?t.tagName.toLowerCase():null;let i=null;if("canvas"===s||"img"===s)i=t;else if("svg"===s){const e=(new XMLSerializer).serializeToString(t);i=new Image,i.src=`data:image/svg+xml;base64,${btoa(e)}`}if(i){"undefined"===typeof e.currentY&&(e.currentY=80);const s=e.internal.pageSize.getWidth(),o=e.internal.pageSize.getHeight(),a=80,r=s-2*a,n=t.width||t.clientWidth,l=t.height||t.clientHeight,d=Math.min(r/n,1),c=n*d,h=l*d;e.currentY+h>o-a&&(e.addPage(),e.currentY=a),e.addImage(i,"PNG",a,e.currentY,c,h),e.currentY+=h+10}else t.children&&t.children.length>0&&Array.from(t.children).forEach(t=>{this.addImageToPdf(e,t)})}exportTable(e,t){const s=[];let o=null;function a(e,t){const s=[];e.each((e,o)=>{i(o).children("th,td").each((o,a)=>{a=i(a);let r=s[e];for(r||(r=s[e]=[]);null!==r[o]&&void 0!==r[o];)o++;const n=t[o];n&&n.noExport||(t[o]={noExport:a.is("[no-export]")||a.is(":hidden")&&!a.is("[force-export]")}),r[o]=function(e){const t={encode:!0,trim:!0};let s=e.attr("export-option");s=s&&s.length>10?{...t,...JSON.parse(s)}:t;const i=e.find("[export-data]:first");let o=(e.attr("export-data")||i.attr("export-data")||i.text()||e.text()).replace(/\r?\n|\r/g," ");return s.trim&&(o=o.trim()),o.indexOf('"')>=0&&(o=o.replace(/"/g,'""')),s.encode&&o.indexOf(",")>=0&&(o=`"${o}"`),o}(a);let l=parseInt(a.attr("colspan"));for(;l>1;)r[o+l-1]="",l--;let d=parseInt(a.attr("rowspan"));for(;d>1;){let t=s[e+d-1];t||(t=s[e+d-1]=[]),t[o]="",d--}})});let o="";for(let i=0;i<s.length;i++){let e="";const r=s[i];for(let s=0;s<r.length;s++){var a;null!==(a=t[s])&&void 0!==a&&a.noExport||(e+=`,${r[s]||""}`)}o+=`${e.substring(1).replace(/\r?\n|\r/g," ")}\r\n`}return o}o="string"===typeof e?a(i(`#${e} thead:not([no-export]) tr:not([no-export]):visible`),s)+a(i(`#${e} tbody:visible tr:not([no-export]):visible`),s):a(e.find("thead:not([no-export]) tr:not([no-export]):visible"),s)+a(e.find("tbody:visible tr:not([no-export]):visible"),s),(0,r.z9)(o,t)}}},4432:()=>{},4452:(e,t,s)=>{s.d(t,{A:()=>j});var i=s(9950),o=s(8738),a=s.n(o),r=s(9051),n=s(6778),l=s(1427),d=s(530),c=s(4414);const h=(0,c.jsx)("span",{className:"empty-group-msg",children:"Drag and drop column here to group data"}),u=(0,c.jsx)("span",{children:"Drag and drop more columns here"});class p extends i.PureComponent{constructor(...e){super(...e),this.toggleSort=(e,t)=>{const{groupBy:s,foldable:i,onChange:o}=this.props,a=[...s];a[e]={...a[e],sortDesc:t},o(a,i,"sort")},this.changeSettings=(e,t)=>{const{groupBy:s,foldable:i,onChange:o}=this.props,a=[...s];a[e]={...a[e],settings:t},o(a,i,"settings")},this.removeGroup=e=>{const{groupBy:t,foldable:s,onChange:i}=this.props,o=[...t];o.splice(e,1),i(o,s,"remove")},this.toggleMode=e=>{const{groupBy:t,foldable:s,onChange:i}=this.props;!!s!==e&&i(t,e,"mode")},this.columnReordered=e=>{const{foldable:t,onChange:s}=this.props;s(e,t,"rearrange")}}render(){const{groupBy:e,foldable:t,toggleColumns:s,showColumns:i,allColumns:o,displayColumns:a}=this.props;let r=null;return a&&a.length<(null===o||void 0===o?void 0:o.length)?r=`${a.length} (${o.length})`:null!==o&&void 0!==o&&o.length&&(r=null===o||void 0===o?void 0:o.length),(0,c.jsxs)("div",{className:"group-bar",children:[(0,c.jsx)("span",{className:"fa group-mode-icon fa-columns"+(i?" active":""),onClick:s,title:"Click to choose what column to display",children:r&&(0,c.jsx)("span",{className:"badge bg-warning text-dark visible-cols",children:r})}),e.length>0&&(0,c.jsx)("span",{className:"fa group-mode-icon fa-th-list"+(t?"":" active"),onClick:()=>this.toggleMode(!1),title:"Display group values in columns"}),e.length>0&&(0,c.jsx)("span",{className:"fa group-mode-icon fa-indent"+(t?" active":""),onClick:()=>this.toggleMode(!0),title:"Display group values in foldable row"}),(0,c.jsx)("span",{className:"group-label",children:"Group by:"}),(0,c.jsx)("div",{className:"group-list-container",children:(0,c.jsx)(n.L1,{useDropRef:!0,className:"group-list",items:e,defaultItemType:"column",onChange:this.columnReordered,placeholder:e.length?u:h,children:(e,t,{droppable:s})=>(0,c.jsx)(g,{group:e,index:t,toggleSort:this.toggleSort,removeGroup:this.removeGroup,settingsChanged:this.changeSettings,dropProps:s},t)})})]})}}const m=p;class g extends i.PureComponent{constructor(...e){super(...e),this.removeGroup=()=>this.props.removeGroup(this.props.index),this.sortAsc=()=>this.props.toggleSort(this.props.index,!1),this.sortDesc=()=>this.props.toggleSort(this.props.index,!0),this.setRef=e=>{this.el=e;const{dropProps:{dropRef:t}={}}=this.props;t&&t(e)},this.changeSettings=({prop:e,type:t,value:s,default:i,aggregate:o})=>{const{settingsChanged:a,group:r,index:n}=this.props;let{settings:l}=r;if(l=l?{...l}:{},"check"===t){const t=void 0===l[e]?i:l[e];l[e]=!t}else l[e]=s;a(n,l)},this.showMenu=e=>{const{group:{groupOptions:t,settings:s}}=this.props,i=t.map(e=>{if(e.separator)return{separator:!0};const{label:t,type:i,prop:o,value:a="check"===i,default:r}=e,n=null===s||void 0===s?void 0:s[o];return{label:t,icon:`${"fa fa-"+(n===a||void 0===n&&r?"check-":"")}${"check"===i?"square":"circle"}`,command:()=>this.changeSettings(e)}});(0,d.O0)(e,i)}}render(){var e,t;const{group:s}=this.props;return(0,c.jsxs)("div",{ref:this.setRef,className:"group-list-item",onContextMenu:null!==(e=s.groupOptions)&&void 0!==e&&e.length?this.showMenu:void 0,children:[!s.sortDesc&&(0,c.jsx)("span",{className:"fa fa-sort-amount-desc sort-icon",onClick:this.sortDesc,title:"Click to sort desc"}),!!s.sortDesc&&(0,c.jsx)("span",{className:"fa fa-sort-amount-asc sort-icon",onClick:this.sortAsc,title:"Click to sort asc"}),s.displayText,!(null===(t=s.groupOptions)||void 0===t||!t.length)&&(0,c.jsx)("span",{className:"fa fa-wrench margin-l-5 pointer",onClick:this.showMenu,title:"Click to change settings"}),(0,c.jsx)("span",{className:"fa fa-times",onClick:this.removeGroup})]})}}class f extends i.PureComponent{constructor(e){super(e),this.hideColumns=()=>{let{columns:e}=this.state,t=e.filter(e=>e.selected);t=t.length===e.length?null:t.map(e=>e.id),e=null,this.props.onChange(t)},this.selectionChanged=(e,t)=>{let{columns:s}=this.state;s=[...s],s[e]={...s[e],selected:t},this.setState({columns:s})},this.state=this.getState(e)}getState(e){const{displayColumns:t}=e;return{columns:this.props.columns.map(({id:e,displayText:s})=>({id:e,displayText:s,selected:!t||!!~t.indexOf(e)}))}}render(){const{columns:e}=this.state;return(0,c.jsx)("div",{className:"columns-list-container",children:(0,c.jsxs)("div",{className:"columns-list",children:[(0,c.jsxs)("div",{className:"column-list-title",children:[(0,c.jsx)("span",{className:"fa fa-times",onClick:this.hideColumns}),(0,c.jsx)("span",{children:"Choose Columns"})]}),(0,c.jsx)("div",{className:"columns-list-items",children:e.map((e,t)=>(0,c.jsx)("div",{className:"column-list-item",children:(0,c.jsx)(n.Sc,{label:e.displayText,checked:e.selected,onChange:e=>this.selectionChanged(t,e)})},t))})]})})}}const x=f;var v=s(1219),y=s(8874);class k extends i.PureComponent{constructor(e){super(e),this.getGroupColumnRenderer=e=>(t,s)=>(0,c.jsx)("th",{rowSpan:e?2:void 0,className:"group-header foldable"},s),this.renderTableBody=(e,t)=>t&&t.length?this.getGroupRenderer(e,t):this.getRowRenderer(e),this.getCellRenderer=e=>(t,s)=>{if(!t.visible)return null;const{field:i,hasPath:o,format:a,type:r,viewComponent:n,props:l}=t;let d=o?(0,v.hI)(e,i):e[i];return a&&"function"===typeof a&&(d=a(d,e,i)),n?(0,c.jsx)(n,{value:d,...l},s):(0,c.jsx)("td",{exportType:r,children:d},s)},this.toggleGroupVisibility=e=>{},this.sortColumnChanged=(e,t)=>{const{groupBy:s,state:{groupFoldable:i,data:o},props:{displayColumns:a}}=this,r={groupFoldable:i},n=null===s||void 0===s?void 0:s.length;return n&&(r.data=this.sortGroupedData(o,s,e,t)),this.setState(r),this.props.onChange({groupBy:s,groupFoldable:i,displayColumns:a,sortField:e,isDesc:t}),n?r.data:void 0},this.onGroupChanged=(e,t,s)=>{const{data:i}=this.state,o={data:i,groupFoldable:t},{displayColumns:a,sortField:r,isDesc:n,groupBy:l}=this.props;"sort"===s&&(o.data=this.sortGroupedData(i,e,r,n)),e="mode"!==s?e.map(({id:e,field:t,fieldKey:s,sortDesc:i,settings:o})=>({id:e,field:t,fieldKey:s,sortDesc:i,settings:o})):l,this.setState(o),this.props.onChange({groupBy:e,displayColumns:a,groupFoldable:t,sortField:r,isDesc:n})},this.toggleColumns=()=>{this.setState({showColumns:!this.state.showColumns})},this.columnSelectionChanged=e=>{const{groupBy:t,groupFoldable:s,sortField:i,isDesc:o}=this.props;this.setState({showColumns:null},()=>this.props.onChange({groupBy:t,displayColumns:e,groupFoldable:s,sortField:i,isDesc:o}))},(0,y.WQ)(this,"UtilsService"),this.convertDate=this.$utils.convertDate,this.state=this.getNewState(e)}UNSAFE_componentWillReceiveProps(e){this.setState(this.getNewState(e))}getNewState(e){const{groupBy:t,columns:s,displayColumns:i,dataset:o,groupFoldable:a,sortField:r,isDesc:n}=e,l={...this.state,groupFoldable:a};this.columns===s&&i===this.displayColumns||(l.allColumns=this.getColumnSchema(e),l.columns=l.allColumns,this.columns=s,this.displayColumns=i);const d=this.groupBy!==t;if(d)if(l.groupBy=this.getGroupedColumnSchema(t,l.allColumns),this.groupBy=t,t&&t.length){const e=t.map(e=>"string"===typeof e?e:e.id||e.field);l.columns=l.allColumns.filter(t=>t.visible&&!~e.indexOf(t.id))}else l.columns=l.allColumns.filter(e=>e.visible);return(d||this.isDesc!==n||this.sortField!==r||this.dataset!==o)&&(l.data=this.prepareDataForRendering(o,l.groupBy,r,n),this.dataset=o,this.sortField=r,this.isDesc=n),l}getGroupedColumnSchema(e,t){let s=null;return Array.isArray(e)&&e.length&&(t=t.reduce((e,t)=>(e[t.id]=t,e),{}),s=e.map(e=>{let s,i=e,o=e,a=i,r=!1;if("object"===typeof e&&(i=e.field,o=e.id||i,a=e.fieldKey||e.groupKey||i,r=e.sortDesc,s=e.settings),!(e=t[o]))return null;const{displayText:n,allowSorting:l,groupOptions:d,type:c,viewComponent:h}=e;return{id:o,field:i,viewComponent:h,fieldKey:a,displayText:n,allowSorting:l,groupOptions:d,sortDesc:r,visible:!0,settings:s,type:c}}).filter(Boolean),s.length||(s=null)),s}getColumnSchema(e){const{columns:t,allowSorting:s=!0,allowGrouping:i=!0}=e;let{displayColumns:o}=e;Array.isArray(o)||(o=null);const a=!!o&&o.some(e=>e.startsWith("-"));return t.map(e=>{const{field:t,fieldKey:r=t,allowSorting:n=s,groupText:l,allowGrouping:d=i,groupOptions:c,format:h,type:u,viewComponent:p,props:m,sortValueFun:g,groupValueFunc:f}=e,x=e.id||t;return{id:x,field:e.field,fieldKey:r,hasPath:(null===t||void 0===t?void 0:t.indexOf("."))>0,displayText:e.displayText||t,visible:!o||(a?!o.includes(`-${x}`):o.includes(x)),allowSorting:n,groupText:l,allowGrouping:d,groupOptions:c,format:h,type:u,viewComponent:p,props:m,sortValueFun:g,groupValueFunc:f}})}prepareDataForRendering(e,t,s,i){return t&&t.length&&Array.isArray(e)&&e.length?this.groupData(e,t,s,i):s?e.sortBy(s,i):e}groupData(e,t,s,i,o){var a;if(o=o?`${o}_`:"",!t.length)return s?e.sortBy(s,i):e;const{0:{field:n,fieldKey:l,sortDesc:d,settings:c,type:h}}=t;t=t.slice(1);const u=l&&l!==n,p=(t,s=null)=>e.groupBy(t,null,u?n:s);let m=null===c||void 0===c?void 0:c.funcType;const g=this.convertDate;let f=null;if("date"===h||"datetime"===h){m=m||"yyyy-MM (MMMM)";let e=e=>{const t=g(e[n]);return t?t.format(m):t};"friendly"===m&&(e=e=>{const t=e[n];return t?r(t).fromNow():t}),f=p(e,(e,t)=>({text:t||"(no date)"}))}else if(!m||"number"!==h&&"seconds"!==h){switch(null===c||void 0===c?void 0:c.valueType){case"count":f=[{key:e.length,values:e}];break;case"distinct":f=[{key:null===(a=e.distinct(l||n))||void 0===a?void 0:a.length,values:e}];break;default:f=p(l||n)}}else switch(m){default:f=p(l||n);break;case"sum":f=[{key:e.sum(n),values:e}];break;case"avg":f=[{key:e.avg(n),values:e}];break;case"count":const t=e.count(e=>e[n]>0);f=[{key:t,keyObj:{text:`${t} has value`},values:e}]}return f.sortBy("key",d).map((e,a)=>({key:e.key,keyObj:e.keyObj,path:o+a,rowSpan:e.values.length,values:this.groupData(e.values,t,s,i,o+a)}))}getColumnGrouping(e){const t=e.groupBy("groupText",e=>e.visible).filter(({key:e})=>!!e);return t.length?t:void 0}getColGroupingLen(e){if(e)return e.reduce((e,t)=>(e[t.key]=t.values.length,e),{})}getGroupedRow(e){return e?(0,c.jsx)(l.lO,{children:e.map(e=>e.values.map(this.getColumnRenderer(!1)))}):null}getColumnRenderer(e,t){return(s,i)=>{if(!s.visible)return null;let o,a=!e&&s.allowSorting?s.fieldKey||s.field:void 0,r=s.allowGrouping,d=t?2:void 0,h=s.displayText;if(t&&s.groupText){if(h=s.groupText,o=t[h],!o)return null;delete t[h],d=void 0,a=void 0,r=!1}return!1===r?(0,c.jsx)(l.VP,{sortBy:a,rowSpan:d,colSpan:o,children:h},i):(0,c.jsx)(n.sx,{itemType:"column",item:s,children:({dragRef:e})=>(0,c.jsx)(l.VP,{rowSpan:d,colSpan:o,dragConnector:e,sortBy:a,children:h})},i)}}getRowRenderer(e){return(t,s)=>(0,c.jsx)("tr",{children:this.renderRowCells(e,t)},s)}renderRowCells(e,t){return e.map(this.getCellRenderer(t))}getGroupRenderer(e,t){const{groupFoldable:s}=this.state;return s?(s,i)=>this.renderFoldableGroupRow(s,i,e,t):(s,i)=>this.renderGroupRow(s,i,e,t)}renderFoldableGroupRow(e,t,s,o,a=0){var r;const n=o[0],l="value"!==((null===n||void 0===n||null===(r=n.settings)||void 0===r?void 0:r.valueType)||"value")?null:null===n||void 0===n?void 0:n.viewComponent,d=a>0&&[].init((e,t)=>(0,c.jsx)("td",{className:"group-indent-td"},t),a),h=o.length>0&&(0,c.jsxs)("tr",{children:[d,(0,c.jsx)("td",{className:"group-toggler-td",title:`Click to ${e.hidden?"expand":"collapse"} group`,"group-path":e.path,onClick:this.toggleGroupVisibility,children:(0,c.jsx)("span",{className:"fa fa-caret-"+(e.hidden?"right":"down")})}),(0,c.jsx)("td",{className:"group-name-td",colSpan:o.length+s.length,children:l?(0,c.jsx)(l,{tag:"span",count:e.rowSpan,value:e.keyObj||e.key,settings:n.settings}):e.key||""})]},e.key);let u=null;return o.length>0?u=e.values.map((e,t)=>this.renderFoldableGroupRow(e,t,s,o.slice(1),a+1)):(u=s.map(this.getCellRenderer(e)),u=(0,c.jsxs)("tr",{children:[d,u]},t)),(0,c.jsxs)(i.Fragment,{children:[h,u]},t)}renderGroupRow(e,t,s,o,a=null){var r;const n=o[0],l="value"!==((null===n||void 0===n||null===(r=n.settings)||void 0===r?void 0:r.valueType)||"value")?null:null===n||void 0===n?void 0:n.viewComponent;let d=o.length>0&&(0,c.jsx)("td",{rowSpan:e.rowSpan,children:l?(0,c.jsx)(l,{tag:"span",count:e.rowSpan,settings:null===n||void 0===n?void 0:n.settings,value:e.keyObj||e.key}):e.key||""});a&&d?d=(0,c.jsxs)(i.Fragment,{children:[a,d]}):a&&0===t&&(d=a);let h=null;return o.length>0?h=e.values.map((e,t)=>this.renderGroupRow(e,t,s,o.slice(1),0===t&&d)):(h=s.map(this.getCellRenderer(e)),h=(0,c.jsxs)("tr",{children:[d,h]},t)),h}sortGroupedData(e,t,s,i,o){if(o=o?`${o}_`:"",0===t.length)return s?e.sortBy(s,i):e;const{sortDesc:a}=t[0];return t=t.slice(1),e.sortBy("key",a).map((e,a)=>({...e,path:o+a,values:this.sortGroupedData(e.values,t,s,i,o+a)}))}render(){const{exportSheetName:e,noRowsMessage:t,sortField:s,isDesc:i,displayColumns:o,className:r,hideGroups:n}=this.props,{allColumns:d,columns:h,groupBy:u,groupFoldable:p,data:g,showColumns:f}=this.state,v=this.getColumnGrouping(h),y=this.getColGroupingLen(v);return(0,c.jsxs)("div",{className:a()("groupable-grid",n&&"groups-hidden"),children:[f&&(0,c.jsx)(x,{onChange:this.columnSelectionChanged,columns:d,displayColumns:o}),!n&&(0,c.jsx)(m,{groupBy:u||[],displayColumns:o,allColumns:d,foldable:p,showColumns:f,onChange:this.onGroupChanged,toggleColumns:this.toggleColumns}),(0,c.jsxs)(l.ew,{className:r,dataset:g,exportSheetName:e,sortBy:s,isDesc:i,onSort:this.sortColumnChanged,children:[(0,c.jsxs)(l.D1,{children:[(0,c.jsxs)(l.lO,{children:[!!p&&u&&u.map(this.getGroupColumnRenderer(y)),!p&&u&&u.map(this.getColumnRenderer(!0,y)),h.map(this.getColumnRenderer(!1,y))]}),this.getGroupedRow(v)]}),(0,c.jsx)(l.vc,{children:this.renderTableBody(h,u)}),(0,c.jsx)(l.QC,{span:h.length,children:t})]})]})}}const j=k},5073:(e,t,s)=>{s.d(t,{A:()=>r});s(9950);var i=s(8957),o=s(4414);class a extends i.A{renderControl(e){const{value:t}=this.props;if(!t)return e;const{value:s,child:{value:i}={}}=t;return(0,o.jsxs)(o.Fragment,{children:[s," - ",i," ",e]})}}const r=a},5459:(e,t,s)=>{s.d(t,{A:()=>l});var i=s(9950),o=s(6778),a=s(5006),r=s(4414);class n extends i.PureComponent{constructor(e){super(e),this.searchRapidView=e=>{e=(e||"").toLowerCase();const{state:{rapidViews:t},props:{value:s}}=this;return t.filter(t=>(t.name.toLowerCase().indexOf(e)>=0||t.id.toString().startsWith(e))&&(!s||!s.some(e=>e.id===t.id)))},this.setValue=e=>{this.props.onChange(e)},(0,a.WQ)(this,"JiraService"),this.state={},this.init()}init(){return this.$jira.getRapidViews().then(e=>{const t=e.orderBy(e=>e.name).map(e=>({name:e.name,id:e.id}));let{value:s}=this.props;if(s&&Array.isArray(s)&&s.length){const e=s.map(e=>e.id);s=t.filter(t=>!!~e.indexOf(t.id)),this.setValue(s)}this.setState({rapidViews:t})})}render(){const{state:{rapidViews:e},props:{value:t,placeholder:s,multiple:i}}=this;return i?(0,r.jsx)(o.j9,{value:t,onChange:this.setValue,dataset:this.searchRapidView,dropdown:!0,multiple:i,displayField:"name",placeholder:s||"start typing the board name here",size:35,maxLength:25,styleclass:"autocomplete-350",scrollHeight:"300px",disabled:!e||0===e.length}):(0,r.jsx)(o.aL,{value:t,dataset:e,displayField:"name",onChange:this.setValue})}}const l=n},6631:(e,t,s)=>{s.d(t,{A:()=>d});var i=s(9950),o=s(8922),a=s(8874),r=s(4414);const n="Selected file is invalid or is corrupted. Unable to load the file!";class l extends i.PureComponent{constructor(e){super(e),this.setFileSelector=e=>this.fileSelector=e,this.chooseFileForImport=e=>this.fileSelector.click(),this.fileSelected=()=>{const e=this.fileSelector,t=e.files[0];if(t){if(!t.name.endsWith(".jab"))return this.$message.warning("Unknown file selected to import. Select a valid Jira Assist Backup (*.jab) file"),void(e.value="");const s=new FileReader;s.readAsText(t,"UTF-8"),s.onload=async e=>{const t=e.target.result;let s;try{const e=(0,o.xS)(t);s=!0;const i=await this.$backup.importBackup(null===e||void 0===e?void 0:e.value,void 0,this.props.cleanImport);console.log("Import logs:",i),this.props.onImport&&this.props.onImport(),this.$message.success("Settings imported successfully. Check console logs for more details.")}catch(i){console.error("Backup import failed",i),s?this.$message.error(i.message):this.$message.error(n)}},s.onerror=e=>{this.$message.error(n)}}else this.$message.warning("Import operation cancelled");e.value=""},(0,a.WQ)(this,"BackupService","MessageService"),this.state={}}render(){return(0,r.jsxs)(r.Fragment,{children:[this.props.children(this.chooseFileForImport),(0,r.jsx)("input",{ref:this.setFileSelector,type:"file",className:"hide",accept:".jab",onChange:this.fileSelected})]})}}const d=l},6904:(e,t,s)=>{s.d(t,{pL:()=>r,Hl:()=>c,Ek:()=>g,EI:()=>x,mG:()=>y,ue:()=>j,qM:()=>S,Kb:()=>N,JA:()=>W,g4:()=>U,n_:()=>I,qm:()=>R,YP:()=>F,vL:()=>B,AZ:()=>z,s2:()=>J});var i=s(1219),o=s(8957);class a extends o.A{renderControl(){var e,t,s;let{value:i}=this.props;return"number"===typeof(null===(e=i)||void 0===e?void 0:e.maxResults)?`${i.maxResults} comments`:(Array.isArray(null===(t=i)||void 0===t?void 0:t.comments)&&(i=i.comments),null!==(s=i)&&void 0!==s&&s.length?`${i.length} comments`:null)}}const r=a;s(9950);var n=s(5006),l=s(4414);class d extends o.A{constructor(e){super(e),(0,n.WQ)(this,"UserUtilsService")}renderControl(e){const{value:t,date:s=t,quick:i,format:o,dateOnly:a}=this.props;if(!s)return e;if(null!==t&&void 0!==t&&t.text)return(0,l.jsxs)(l.Fragment,{children:[t.text," ",e]});const r=a?this.$userutils.formatDate:this.$userutils.formatDateTime;return(0,l.jsxs)("span",{title:i?r(s):null,children:[i&&"about "," ",r(s,i?"quick":o)]})}}const c=d;var h=s(8874),u=s(6778),p=s(5674);class m extends o.A{constructor(e){super(),e.getTicketUrl?this.getTicketUrl=e.getTicketUrl:((0,h.WQ)(this,"UserUtilsService"),this.getTicketUrl=this.$userutils.getTicketUrl)}renderControl(e){var t,s;const{value:i,issue:o=i,title:a,className:r,iconClass:n,style:d,settings:c}=this.props;if(!o)return e;if("string"===typeof o)return(0,l.jsxs)(p.A,{href:this.getTicketUrl(o),className:`link ${r}`,children:[o," ",e]});const h=o.key,m=o.fields,g=null===m||void 0===m?void 0:m.issuetype,f=null===m||void 0===m?void 0:m.summary,x=null===g||void 0===g?void 0:g.iconUrl,v=null===g||void 0===g?void 0:g.name,y=(null===m||void 0===m?void 0:m.status)||{};let k=y.name;const j="done"===(null===(t=y.statusCategory)||void 0===t?void 0:t.key)||"done"===(null===(s=k)||void 0===s?void 0:s.toLowerCase());k=!!k&&!1!==(null===c||void 0===c?void 0:c.showStatus)&&`(${k})`;const w=null===c||void 0===c?void 0:c.valueType;let S=h||"Unknown";return"summary"===w?S=f:"both"===w&&(S=(0,l.jsxs)(l.Fragment,{children:[S," - ",f]})),(0,l.jsxs)(p.A,{href:this.getTicketUrl(h),title:a,className:`link${j?" strike-out":""} ${r}`,style:d,children:[!!x&&(0,l.jsx)(u._V,{src:x,className:n,title:v}),(0,l.jsxs)("span",{title:f,children:[S," ",k]}),e]})}}const g=m;class f extends o.A{constructor(){super(),(0,h.WQ)(this,"UserUtilsService")}renderControl(){const{value:e}=this.props;if(null===e||void 0===e||!e.length)return null;const t=this.$userutils.getTicketUrl;return(0,l.jsx)("ul",{className:"tags",children:e.map((e,s)=>{const i=e.type,o=i&&(e.inwardIssue?i.inward:i.outward);return(0,l.jsx)("li",{children:(0,l.jsx)(g,{tag:"span",issue:i?e.inwardIssue||e.outwardIssue:e,title:o,getTicketUrl:t,className:"badge rounded-pill skin-bg-font"})},s)})})}}const x=f;class v extends o.A{renderControl(e){const{value:t,textField:s="name",iconField:i="iconUrl"}=this.props;return t?(0,l.jsxs)(l.Fragment,{children:[!!i&&(0,l.jsx)(u._V,{src:t[i]}),t[s]," ",e]}):e}}const y=v;class k extends o.A{renderControl(){const{value:e,progress:t=e}=this.props;return null!==t&&void 0!==t&&t.percent?`${t.percent}%`:null}}const j=k;class w extends o.A{renderControl(e){var t;const{value:s,project:i=s,settings:o}=this.props;if(!i)return e;if("string"===typeof i)return i;const a=null===(t=i.avatarUrls)||void 0===t?void 0:t["16x16"],r=null===o||void 0===o?void 0:o.valueType;let n=i.key;return"name"===r?n=i.name:"both"===r&&(n=(0,l.jsxs)(l.Fragment,{children:[i.name," (",i.key,")"]})),(0,l.jsxs)(l.Fragment,{children:[!!a&&(0,l.jsx)(u._V,{src:a}),n,e]})}}const S=w,b=/^com\..*\[.*\].*$/;class C extends o.A{getRepeator(e){const{tagProp:t="name",titleProp:s,iconClass:o,hrefProp:a,hideZero:r}=this.props,n=!!o&&(0,l.jsx)("span",{className:`fa ${o}`});return a?(i,o)=>{const d="string"===typeof i?i:i[t];if(0===d&&r)return null;const c=(0,l.jsxs)(p.A,{href:i[a]||void 0,title:s?i[s]:void 0,className:"link badge skin-bg-font",children:[n," ",d]});return e?c:(0,l.jsx)("li",{children:c},o)}:(o,a)=>{let d=o;if("string"===typeof o)b.test(o)&&(d=(o=(0,i.$Z)(o))[t||"name"]||d);else if(d=o[t],0===d&&r)return null;const c=(0,l.jsxs)("span",{title:s?o[s]:void 0,className:"badge skin-bg-font",children:[n," ",d]});return e?c:(0,l.jsx)("li",{children:c},a)}}renderControl(){const{value:e}=this.props;return e?Array.isArray(e)?(0,l.jsx)("ul",{className:"tags",children:e.map(this.getRepeator())}):"object"===typeof e?this.getRepeator(!0)(e,0):void 0:null}}const N=C;var T=s(530),D=s(4692);class $ extends o.A{constructor(e){super(e),this.startTimer=()=>this.context.startTimer(this.props.value),this.showContext=e=>{const t=[...this.contextMenu];try{const e=this.context.getElapsedTimeInSecs(),s=(null===e||void 0===e?void 0:e.key)===this.props.value,i=null===e||void 0===e?void 0:e.isRunning;s?(i?t.push({label:"Pause timer",icon:"fa fa-pause",command:this.context.pauseTimer}):t.push({label:"Resume timer",icon:"fa fa-play",command:this.context.resumeTimer}),t.push({label:"Stop timer",icon:"fa fa-stop",command:this.context.stopTimer})):t.push({label:"Start timer",icon:"fa fa-play",command:this.startTimer})}catch{}(0,T.O0)(e,t)},(0,h.WQ)(this,"UserUtilsService","BookmarkService"),this.contextMenu=[!e.hideWorklog&&{label:"Add worklog",icon:"fa fa-clock",command:this.addWorklog.bind(this)},{label:"Bookmark",icon:"fa fa-bookmark",command:()=>this.addBookmark()}].filter(Boolean)}renderControl(e){const{value:t,url:s=this.$userutils.getTicketUrl(t),hideContext:i}=this.props;return t?(0,l.jsxs)(l.Fragment,{children:[!i&&(0,l.jsx)("i",{className:"fa fa-ellipsis-v margin-r-8",onClick:this.showContext}),(0,l.jsx)(p.A,{href:s,className:"link strike",children:t}),e]}):e}addWorklog(){const{onAddWorklog:e,value:t}=this.props;e?e(t):console.error("Add worklog function is not yet implemented")}addBookmark(){const{value:e,onBookmark:t}=this.props;this.$bookmark.addBookmark([e],!t).then(t)}}$.contextType=D.dg;const W=$;class A extends o.A{constructor(e){super(e),(0,h.WQ)(this,"UtilsService")}renderControl(e){var t;const{value:s,inputType:i="secs",format:o=!0,days:a,converter:r}=this.props;let{timespent:n=s}=this.props;if(r&&(n=r(n)),!n)return e;if("days"===i){const e=24*n*60;n=60*parseInt(e),!n&&e&&(n={text:"< 1m"})}else"ticks"===i&&n>500&&(n=parseInt(n/1e3));return n=null!==(t=n)&&void 0!==t&&t.text?n.text:!1===o?this.$utils.convertSecs(n,{showZeroSecs:!0}):this.$utils.formatSecs(n,void 0,void 0,a),(0,l.jsxs)("span",{children:[n," ",e]})}}const U=A;class L extends o.A{renderControl(){const{value:e}=this.props;if(!e)return null;const{remainingEstimate:t,timeSpent:s}=e;return s||t?(0,l.jsxs)("span",{children:[s," (",t," remaining)"]}):null}}const I=L;class M extends o.A{renderControl(e){var t;let{value:s}=this.props;return s?(s=(null===(t=s)||void 0===t?void 0:t.text)||s,"object"!==typeof s?(0,l.jsxs)(l.Fragment,{children:[s," ",e]}):Array.isArray(s)?s.length?this.getTagRenderer(s[0],s):null:this.getTagRenderer(s,s)):e}getTagRenderer(e,t){return"string"===typeof e?(0,l.jsx)(N,{value:t,tagProp:"",tag:"span"}):e.value?"string"!==typeof e.value||Array.isArray(t)?(0,l.jsx)(N,{value:t,tagProp:"value",tag:"span"}):e.value:e.name?(0,l.jsx)(N,{value:t,tagProp:"name",tag:"span"}):JSON.stringify(e)}}const R=M;class E extends o.A{renderControl(e){var t,s;const{value:i,user:o=i,settings:a,imgClassName:r="img-x32"}=this.props;if(!o)return e;if("string"===typeof o)return o;const n=!(null===a||void 0===a||!a.showImage)&&((null===(t=o.avatarUrls)||void 0===t?void 0:t["32x32"])||(null===(s=o.avatarUrls)||void 0===s?void 0:s["48x48"])),d=null===a||void 0===a?void 0:a.valueType;let c=o.displayName;return"email"===d?c=o.emailAddress:"both"===d&&(c=(0,l.jsxs)(l.Fragment,{children:[o.displayName," (",o.emailAddress,")"]})),(0,l.jsxs)(l.Fragment,{children:[!!n&&(0,l.jsx)(u._V,{className:`${r} rounded-circle me-2`,src:n}),c,e]})}}const F=E;var P=s(5073);function B(e){switch(e){case"ageindays":return{Component:c,props:{quick:!0}};case"date":return{Component:c,props:{dateOnly:!0}};case"datetime":return{Component:c};case"parent":return{Component:g,props:{settings:{valueType:"both"}}};case"issuekey":return{Component:g};case"progress":return{Component:j};case"project":return{Component:S,props:{settings:{valueType:"both"}}};case"timespent":return{Component:U};case"timetracking":return{Component:I};case"comments-page":case"comment":return{Component:r};case"user":return{Component:F};case"votes":return{Component:N,props:{tagProp:"votes"}};case"attachment":return{Component:N,props:{tagProp:"filename",hrefProp:"content",iconClass:"fa-paperclip"}};case"issuetype":case"status":case"resolution":case"priority":return{Component:y};case"option-with-child":return{Component:P.A};default:return{Component:R}}}const V=["number","string","date","datetime","parent","progress","project","timespent","timetracking","comments-page","user","votes","issuekey"],G=["issuetype","status","resolution","priority"],O={parent:"id",project:"key",user:i.J3},H={timespent:["number"],issuekey:["string"]};function z(e){return J(e,O,"id")}function J(e,t,s){const{schema:i,key:o}=e,{type:a=o,system:r}=i||{type:e.type||o};return"number"===a&&r&&(r.endsWith("timespent")||r.endsWith("estimate"))?{type:"timespent",compatibleTypes:H.timespent}:!r||V.includes(a)?{type:a,keyField:t[a],compatibleTypes:H[a]}:G.includes(a)?{type:a,knownObject:!0,keyField:s}:"array"===a?{type:i.items,isArray:!0}:a}},7342:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Xe});var i=s(9950),o=s(8615),a=s(975),r=s(8874),n=s(530),l=s(1219),d=s(4692),c=s(5620),h=s(7375),u=s(6778),p=s(9786);const m=p.A.modules.dashboards&&i.lazy(()=>Promise.all([s.e(751),s.e(434)]).then(s.bind(s,4434))),g=p.A.modules.calendar&&i.lazy(()=>s.e(523).then(s.bind(s,9523))),f=p.A.modules.importWorklog&&i.lazy(()=>Promise.all([s.e(847),s.e(116)]).then(s.bind(s,6116))),x=p.A.modules.importIssues&&i.lazy(()=>Promise.all([s.e(847),s.e(775)]).then(s.bind(s,1775))),v=p.A.modules.pivotReport&&i.lazy(()=>Promise.all([s.e(390),s.e(495)]).then(s.bind(s,6495))),y=p.A.modules.sayDoRatioReport&&i.lazy(()=>s.e(923).then(s.bind(s,5923))),k=p.A.modules.customReport&&i.lazy(()=>Promise.all([s.e(751),s.e(151)]).then(s.bind(s,9151))),j=p.A.modules.estimateVsActual&&i.lazy(()=>s.e(191).then(s.bind(s,8191))),w=p.A.modules.sprintReport&&i.lazy(()=>s.e(871).then(s.bind(s,6871))),S=p.A.modules.worklogReport&&i.lazy(()=>s.e(550).then(s.bind(s,9550))),b=p.A.modules.generalSettings&&i.lazy(()=>s.e(671).then(s.bind(s,3052))),C=p.A.modules.userGroups&&i.lazy(()=>Promise.resolve().then(s.bind(s,7630))),N=p.A.modules.advancedSettings&&i.lazy(()=>s.e(431).then(s.bind(s,2812))),T=p.A.modules.contactUs&&i.lazy(()=>s.e(208).then(s.bind(s,4208))),D=p.A.modules.contribute&&i.lazy(()=>s.e(753).then(s.bind(s,8753))),$=(document.location.href.indexOf("?quick=true"),[m&&{path:"/dashboard/:index",component:m},m&&{path:"/dashboard",component:m},g&&{path:"/calendar",component:g},S&&{path:"/reports/worklog",component:S},v&&{path:"/reports/pivot",component:v},v&&{path:"/reports/pivot/:reportId",component:v},y&&{path:"/reports/say-do-ratio",component:y},j&&{path:"/reports/estimateactual",component:j},w&&{path:"/reports/sprint",component:w},k&&{path:"/reports/custom/:reportId",component:k},k&&{path:"/reports/custom",component:k},f&&{path:"/import/worklog",component:f},x&&{path:"/import/issue",component:x},b&&{path:"/settings/general",component:b},C&&{path:"/settings/usergroups",component:C},N&&{path:"/settings/global",component:N},D&&{path:"/contribute",component:D},T&&{path:"/contact-us",component:T}].filter(Boolean));var W=s(2636),A=s(4414);function U(e){return(0,A.jsx)(u.QP,{children:(0,A.jsx)("main",{className:"main",children:(0,A.jsx)("div",{className:"container-fluid",children:(0,A.jsx)(i.Suspense,{fallback:e.loader(),children:(0,A.jsx)(h.BV,{children:$.map((e,t)=>{const s=(0,W.y)(e.component);return(0,A.jsx)(h.qh,{path:e.path,exact:e.exact||!1,name:e.name,element:(0,A.jsx)(s,{})},t)})})})})})})}const L=i.memo(U);var I=s(8738),M=s.n(I),R=s(4190);const E=function(){const e=i.useMemo(()=>{const{$userutils:e}=(0,r.WQ)(this,"UserUtilsService");return e.formatDateTime(R.Eg)},[]);return(0,A.jsxs)("span",{className:"build-date",children:["Build: ",e]})},F=(0,A.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",role:"presentation",children:(0,A.jsx)("path",{d:"M8.292 10.293a1.009 1.009 0 000 1.419l2.939 2.965c.218.215.5.322.779.322s.556-.107.769-.322l2.93-2.955a1.01 1.01 0 000-1.419.987.987 0 00-1.406 0l-2.298 2.317-2.307-2.327a.99.99 0 00-1.406 0z",fill:"currentColor",fillRule:"evenodd"})}),P=(0,A.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 320 512",children:(0,A.jsx)("path",{d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z",fill:"currentColor"})}),B=(0,A.jsx)("svg",{width:"24",height:"24",viewBox:"5 1 24 24",role:"presentation",children:(0,A.jsx)("path",{d:"M10.294 9.698a.988.988 0 010-1.407 1.01 1.01 0 011.419 0l2.965 2.94a1.09 1.09 0 010 1.548l-2.955 2.93a1.01 1.01 0 01-1.42 0 .988.988 0 010-1.407l2.318-2.297-2.327-2.307z",fill:"currentColor",fillRule:"evenodd"})}),V=(0,A.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",role:"presentation",children:(0,A.jsx)("path",{d:"M11.701 16.7a5.002 5.002 0 110-10.003 5.002 5.002 0 010 10.004m8.368-3.117a1.995 1.995 0 01-1.346-1.885c0-.876.563-1.613 1.345-1.885a.48.48 0 00.315-.574 8.947 8.947 0 00-.836-1.993.477.477 0 00-.598-.195 2.04 2.04 0 01-1.29.08 1.988 1.988 0 01-1.404-1.395 2.04 2.04 0 01.076-1.297.478.478 0 00-.196-.597 8.98 8.98 0 00-1.975-.826.479.479 0 00-.574.314 1.995 1.995 0 01-1.885 1.346 1.994 1.994 0 01-1.884-1.345.482.482 0 00-.575-.315c-.708.2-1.379.485-2.004.842a.47.47 0 00-.198.582A2.002 2.002 0 014.445 7.06a.478.478 0 00-.595.196 8.946 8.946 0 00-.833 1.994.48.48 0 00.308.572 1.995 1.995 0 011.323 1.877c0 .867-.552 1.599-1.324 1.877a.479.479 0 00-.308.57 8.99 8.99 0 00.723 1.79.477.477 0 00.624.194c.595-.273 1.343-.264 2.104.238.117.077.225.185.302.3.527.8.512 1.58.198 2.188a.473.473 0 00.168.628 8.946 8.946 0 002.11.897.474.474 0 00.57-.313 1.995 1.995 0 011.886-1.353c.878 0 1.618.567 1.887 1.353a.475.475 0 00.57.313 8.964 8.964 0 002.084-.883.473.473 0 00.167-.631c-.318-.608-.337-1.393.191-2.195.077-.116.185-.225.302-.302.772-.511 1.527-.513 2.125-.23a.477.477 0 00.628-.19 8.925 8.925 0 00.728-1.793.478.478 0 00-.314-.573",fill:"currentColor",fillRule:"evenodd"})}),G=(0,A.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",role:"presentation",children:(0,A.jsx)("path",{d:"M6.485 17.669a2 2 0 002.829 0l-2.829-2.83a2 2 0 000 2.83zm4.897-12.191l-.725.725c-.782.782-2.21 1.813-3.206 2.311l-3.017 1.509c-.495.248-.584.774-.187 1.171l8.556 8.556c.398.396.922.313 1.171-.188l1.51-3.016c.494-.988 1.526-2.42 2.311-3.206l.725-.726a5.048 5.048 0 00.64-6.356 1.01 1.01 0 10-1.354-1.494c-.023.025-.046.049-.066.075a5.043 5.043 0 00-2.788-.84 5.036 5.036 0 00-3.57 1.478z",fill:"currentColor",fillRule:"evenodd"})}),O=(0,A.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",role:"presentation",children:(0,A.jsx)("path",{d:"M10.922 14.517L5.87 12.68l-.932-.339C4.418 12.151 4 11.552 4 11c0-.556.42-1.153.938-1.341l9.124-3.318c.52-.19.938.105.938.654v8.01c0 .54-.42.842-.938.654l-3.14-1.142zM6 14.227l2 .728V17c0 .552-.405 1.202-.895 1.447l-.21.106C6.4 18.8 6 18.549 6 18.009v-3.782zm11.224-4.78a.5.5 0 11-.448-.894l2-1a.5.5 0 11.448.894l-2 1zm-.448 4a.5.5 0 01.448-.894l2 1a.5.5 0 01-.448.894l-2-1zM17 11.5a.5.5 0 110-1h3a.5.5 0 110 1h-3z",fill:"currentColor"})}),H=(0,A.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",role:"presentation",children:(0,A.jsxs)("g",{fill:"currentColor",children:[(0,A.jsx)("path",{d:"M21 17H4.995C4.448 17 4 16.548 4 15.991V6a1 1 0 10-2 0v9.991A3.004 3.004 0 004.995 19H21a1 1 0 000-2zm-3-8v3a1 1 0 002 0V8a1 1 0 00-1-1h-4a1 1 0 000 2h3z"}),(0,A.jsx)("path",{d:"M13.293 13.707a1 1 0 001.414 0l4-4a1 1 0 10-1.414-1.414L14 11.586l-2.293-2.293a1 1 0 00-1.414 0l-4 4a1 1 0 001.414 1.414L11 11.414l2.293 2.293z"})]})}),z=(0,A.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",role:"presentation",children:(0,A.jsxs)("g",{fill:"currentColor",children:[(0,A.jsx)("path",{d:"M4 18h16.008C20 18 20 6 20 6H3.992C4 6 4 18 4 18zM2 5.994C2 4.893 2.898 4 3.99 4h16.02C21.108 4 22 4.895 22 5.994v12.012A1.997 1.997 0 0120.01 20H3.99A1.994 1.994 0 012 18.006V5.994z"}),(0,A.jsx)("path",{d:"M8 6v12h2V6zm6 0v12h2V6z"})]})}),J=(0,A.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",role:"presentation",children:(0,A.jsxs)("g",{fillRule:"evenodd",children:[(0,A.jsx)("circle",{fill:"currentColor",cx:"12",cy:"12",r:"10"}),(0,A.jsx)("circle",{fill:"inherit",cx:"12",cy:"18",r:"1"}),(0,A.jsx)("path",{d:"M15.89 9.05a3.975 3.975 0 00-2.957-2.942C10.321 5.514 8.017 7.446 8 9.95l.005.147a.992.992 0 00.982.904c.552 0 1-.447 1.002-.998a2.004 2.004 0 014.007-.002c0 1.102-.898 2-2.003 2H12a1 1 0 00-1 .987v2.014a1.001 1.001 0 002.004 0v-.782c0-.217.145-.399.35-.472A3.99 3.99 0 0015.89 9.05",fill:"inherit"})]})}),_={angleDown:F,angleLeft:P,angleRight:B,announcement:O,chartUpTrend:H,columns:z,config:V,layout:(0,A.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",role:"presentation",children:(0,A.jsxs)("g",{fill:"currentColor",children:[(0,A.jsx)("path",{d:"M4 18h16.008C20 18 20 6 20 6H3.992C4 6 4 18 4 18zM2 5.994C2 4.893 2.898 4 3.99 4h16.02C21.108 4 22 4.895 22 5.994v12.012A1.997 1.997 0 0120.01 20H3.99A1.994 1.994 0 012 18.006V5.994z"}),(0,A.jsx)("path",{d:"M7 5v14h2V5z"}),(0,A.jsx)("path",{d:"M7 11h14V9H7z"})]})}),notification:G,question:J,team:(0,A.jsxs)("svg",{viewBox:"0 0 24 24",role:"presentation",style:{fill:"#FFFFFF"},children:[(0,A.jsx)("path",{d:"M17.25 7.5C17.25 7.08579 16.9142 6.75 16.5 6.75C16.0858 6.75 15.75 7.08579 15.75 7.5V10.5C15.75 10.9142 16.0858 11.25 16.5 11.25C16.9142 11.25 17.25 10.9142 17.25 10.5V7.5Z",fill:"currentColor"}),(0,A.jsx)("path",{d:"M18 8.25H15C14.5858 8.25 14.25 8.58579 14.25 9C14.25 9.41421 14.5858 9.75 15 9.75H18C18.4142 9.75 18.75 9.41421 18.75 9C18.75 8.58579 18.4142 8.25 18 8.25Z",fill:"currentColor"}),(0,A.jsx)("path",{fillRule:"evenodd","clip-rule":"evenodd",d:"M10.7118 10.958H13.6C14.3735 10.958 15 11.5848 15 12.3747V15.0168C15 15.9447 13.6882 16.4711 12.2 16.5964V14.4969C12.1993 13.9338 11.9777 13.394 11.5839 12.9961C11.1902 12.5982 10.6565 12.3747 10.1 12.3747H9.8522C10.2723 12 10.5717 11.5065 10.7118 10.958ZM10.7979 10.1278C11.2054 10.2741 11.6477 10.2896 12.0642 10.172C12.4807 10.0545 12.8513 9.80973 13.1252 9.47112C13.3991 9.13252 13.563 8.71661 13.5946 8.28019C13.6261 7.84378 13.5238 7.40814 13.3015 7.03279C13.0793 6.65743 12.7479 6.36066 12.3527 6.18301C11.9576 6.00536 11.5178 5.95549 11.0936 6.04021C10.6693 6.12494 10.2813 6.34012 9.98243 6.65638C9.68357 6.97264 9.48848 7.37454 9.4238 7.8072C9.82614 8.0471 10.1627 8.38516 10.4027 8.79051C10.6427 9.19587 10.7786 9.65561 10.7979 10.1278Z",fill:"currentColor"}),(0,A.jsx)("path",{fillRule:"evenodd","clip-rule":"evenodd",d:"M4.5 14.4997C4.5 13.717 5.1209 13.083 5.9 13.083H10.1C10.8735 13.083 11.5 13.7099 11.5 14.4997V17.1419C11.5 19.286 4.5 19.286 4.5 17.1419V14.4997Z",fill:"currentColor"}),(0,A.jsx)("path",{d:"M8 12.3747C9.1598 12.3747 10.1 11.4232 10.1 10.2496C10.1 9.07596 9.1598 8.12454 8 8.12454C6.8402 8.12454 5.9 9.07596 5.9 10.2496C5.9 11.4232 6.8402 12.3747 8 12.3747Z",fill:"currentColor"})]}),brightSun:(0,A.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-sun light-mode",children:[(0,A.jsx)("circle",{cx:"12",cy:"12",r:"5"}),(0,A.jsx)("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),(0,A.jsx)("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),(0,A.jsx)("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),(0,A.jsx)("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),(0,A.jsx)("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),(0,A.jsx)("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),(0,A.jsx)("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),(0,A.jsx)("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),nightLight:(0,A.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-moon dark-mode",children:(0,A.jsx)("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),bellNotification:(0,A.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-bell",children:[(0,A.jsx)("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),(0,A.jsx)("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),youtube:(0,A.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 24 24",children:(0,A.jsx)("path",{fill:"red",d:"m10 15l5.19-3L10 9v6m11.56-7.83c.13.47.22 1.1.28 1.9c.07.8.1 1.49.1 2.09L22 12c0 2.19-.16 3.8-.44 4.83c-.25.9-.83 1.48-1.73 1.73c-.47.13-1.33.22-2.65.28c-1.3.07-2.49.1-3.59.1L12 19c-4.19 0-6.8-.16-7.83-.44c-.9-.25-1.48-.83-1.73-1.73c-.13-.47-.22-1.1-.28-1.9c-.07-.8-.1-1.49-.1-2.09L2 12c0-2.19.16-3.8.44-4.83c.25-.9.83-1.48 1.73-1.73c.47-.13 1.33-.22 2.65-.28c1.3-.07 2.49-.1 3.59-.1L12 5c4.19 0 6.8.16 7.83.44c.9.25 1.48.83 1.73 1.73Z"})})};function Q({onLogout:e,menus:t,location:{pathname:s}}){const[o,a]=i.useState(!0),[r,n]=i.useState(!1),l=i.useCallback(()=>{a(e=>!e),n(!1)},[a,n]),d=i.useCallback(()=>n(!0),[n]),c=i.useCallback(()=>n(!1),[n]),h=M()("sidebar-container",{open:o,hover:r,closed:!o&&!r});return(0,A.jsxs)("div",{className:h,onMouseLeave:c,children:[(0,A.jsx)("div",{className:"sidebar-placeholder"}),(0,A.jsx)("div",{className:"sidebar-toggler",onMouseEnter:r?d:void 0,children:(0,A.jsx)("button",{tabIndex:0,title:o?"Collapse":"Expand",onClick:l,children:o?_.angleLeft:_.angleRight})}),(0,A.jsxs)("nav",{onMouseEnter:d,children:[(0,A.jsx)("div",{className:"sidebar-content",children:t.map((e,t)=>(0,A.jsx)(Y,{section:e,title:e.name,pathname:s},t))}),(0,A.jsx)("div",{className:"build-info",children:(0,A.jsx)(E,{})})]})]})}function Y({section:e,pathname:t}){const[s,o]=i.useState(!0),a=i.useCallback(()=>o(e=>!e),[o]);return(0,A.jsxs)("div",{className:"nav-section"+(s?" expanded":" collapsed"),children:[(0,A.jsxs)("span",{className:"section",children:[(0,A.jsx)("span",{className:"toggle-icon",onClick:a,children:s?_.angleDown:_.angleRight}),(0,A.jsx)("div",{className:"section-name",children:e.name})]}),s&&e.items.map((e,s)=>(0,A.jsx)(q,{menu:e,pathname:t},s))]})}function q({menu:e,pathname:t}){const s=e.url===t;return(0,A.jsx)("span",{className:"menu"+(s?" selected":""),children:(0,A.jsx)(u.N_,{href:e.url,newTab:e.external||!1,"data-testid":e.id,children:(0,A.jsxs)("span",{className:"wrapper",children:[(0,A.jsx)("span",{className:`icon ${e.icon}`}),(0,A.jsx)("span",{className:"menu-text",children:e.name}),e.badge&&(0,A.jsx)("span",{className:`badge bg-${e.badge.variant}`,children:e.badge.text})]})})})}const Z=i.memo(Q);var K=s(5674);class X extends i.PureComponent{constructor(e){super(e),(0,r.WQ)(this,"UserUtilsService")}getDescription(e,t){let s,i=e;return"object"===typeof e&&(s=e.id,i=e.text),(0,A.jsxs)("li",{children:[!!s&&(0,A.jsxs)(K.A,{href:`https://github.com/shridhar-tl/jira-assistant/issues/${s}`,children:["#",s," - "]}),i]},t)}render(){const{updates:e}=this.props;return(0,A.jsx)("div",{className:"release-history",children:e.map((e,t)=>(0,A.jsxs)("div",{className:"release",children:[(0,A.jsx)("span",{className:"version-no",children:e.version}),e.publishDate&&(0,A.jsxs)("span",{children:[" (published: ",(0,A.jsx)("b",{children:this.$userutils.formatDate(e.publishDate)}),")"]}),!e.publishDate&&e.expectedOn&&(0,A.jsxs)("span",{children:[" (expected: ",(0,A.jsx)("b",{children:this.$userutils.formatDate(e.expectedOn)}),")"]}),e.availableNow&&(0,A.jsx)("span",{className:"badge bg-"+(e.isBeta?"warning text-dark":"success"),title:"Download this version from web store",children:"now available"}),(0,A.jsx)("span",{className:"changelog-header",children:"Changelog:"}),(0,A.jsx)("ul",{className:"changelogs",children:e.whatsnew.map(this.getDescription)}),e.bugs&&e.bugs.length>0&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("span",{className:"changelog-header",children:"Bugs:"}),(0,A.jsx)("ul",{className:"changelogs",children:e.bugs.map(this.getDescription)})]})]},t))})}}const ee=X;var te=s(1445);class se extends i.PureComponent{constructor(e){super(e),this.showEditor=()=>this.setState({showEditor:!0}),this.hideDialog=()=>this.setState({showEditor:!1}),this.trackerUpdated=e=>{this.context.setUpdates(e),this.hideDialog()},(0,r.WQ)(this,"UserUtilsService"),this.state={showEditor:!1}}render(){const e=this.context.getElapsedTimeInSecs();return e?(0,A.jsxs)("div",{className:"timer-ctl",children:[(0,A.jsx)(K.A,{className:"ticket-no link",href:this.$userutils.getTicketUrl(e.key),children:e.key}),(0,A.jsx)(oe,{isRunning:e.isRunning,lapse:e.lapse,title:e.description},`${e.key}_${e.isRunning?"R":"S"}`),!e.isRunning&&(0,A.jsx)("span",{className:"fa fa-play",title:"Resume time tracking",onClick:this.context.resumeTimer}),e.isRunning&&(0,A.jsx)("span",{className:"fa fa-pause",title:"Pause time tracking",onClick:this.context.pauseTimer}),(0,A.jsx)("span",{className:"fa fa-stop",title:"Stop time tracking and create worklog entry",onClick:this.context.stopTimer}),(0,A.jsx)("span",{className:"fa fa-edit",title:"Edit working comment",onClick:this.showEditor}),this.state.showEditor&&(0,A.jsx)(te.A,{editTracker:!0,onDone:this.trackerUpdated,onHide:this.hideDialog})]}):null}}se.contextType=d.dg;const ie=se;class oe extends i.PureComponent{constructor(e){super(e),this.state=this.getDisplayTime(e)}componentDidMount(){this.props.isRunning&&(this.token=setInterval(()=>this.setState(this.getDisplayTime),1e3))}getDisplayTime(e){let{lapse:t}=e;t+=1;const s=Math.floor(t/3600),i=Math.floor(t%3600/60),o=Math.floor(t%60);let a;return a=s?`${s.pad(2)}:${i.pad(2)}:${o.pad(2)}`:i?`${i.pad(2)}:${o.pad(2)}`:`${o.pad(2)}s`,{lapse:t,display:a}}componentWillUnmount(){this.token&&clearInterval(this.token)}render(){return(0,A.jsx)("span",{className:"time-lapsed",title:this.props.title,children:this.state.display})}}var ae=s(9051),re=s.n(ae),ne=s(2813);const le=!1!==p.A.features.header.shareWithOthers?ne.Jb:void 0;const de=function({showVersionInfo:e,versionNumber:t}){return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(K.A,{href:le,className:"navbar-brand",children:(0,A.jsxs)("span",{className:"navbar-brand-full",children:["Jira Assistant ",(0,A.jsx)("span",{className:"v-info badge bg-success",onClick:e,children:t})]})}),(0,A.jsx)("button",{className:"navbar-toggler quick-view-show",children:(0,A.jsx)(K.A,{href:c.zM?"/":"/index.html",title:"Open in new tab",children:(0,A.jsx)("span",{className:"fa fa-external-link"})})})]})};var ce=s(3493),he=s(4922);function ue(){const e=i.useRef(),t=i.useCallback(t=>{e.current.show(t),function(){const{$analytics:e}=(0,r.WQ)("AnalyticsService");e.trackEvent("Share option viewed",he.hB.HeaderActions)}()},[e]),{ratingUrl:s,gMailShare:o,linkedInShare:a,facebookShare:n,twitterShare:l}=i.useMemo(me,[]);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("li",{className:"nav-item quick-view-hide",children:(0,A.jsx)("span",{className:"fa fa-share-alt drop-icon",onClick:t,title:"Click to rate or share Jira Assistant"})}),(0,A.jsx)(ce.j,{ref:e,className:"share-items-op drop-op",children:(0,A.jsxs)("div",{className:"share-items-container drop-op-container",children:[(0,A.jsx)("div",{className:"title text-center",children:(0,A.jsx)("strong",{children:"Share or rate this tool"})}),(0,A.jsxs)("div",{className:"drop-op-body share-items",children:[(0,A.jsx)(K.A,{href:s,title:"Click to rate this tool or add a comment in chrome web store",children:(0,A.jsx)("i",{className:"fa fa-star float-start"})}),(0,A.jsx)(K.A,{href:o,title:"Share with Gmail",children:(0,A.jsx)("i",{className:"fa fa-envelope float-start"})}),(0,A.jsx)(K.A,{href:a,title:"Share with Linked in",children:(0,A.jsx)("i",{className:"fa-brands fa-linkedin float-start"})}),(0,A.jsx)(K.A,{href:n,title:"Share with Facebook",children:(0,A.jsx)("i",{className:"fa-brands fa-facebook-square float-start"})}),(0,A.jsx)(K.A,{href:l,title:"Share with Twitter",children:(0,A.jsx)("i",{className:"fa-brands fa-twitter-square float-start"})})]})]})})]})}const pe=i.memo(ue);function me(){const{$jaBrowserExtn:e}=(0,r.WQ)("AppBrowserService"),t=e.getStoreUrl(!0),s=e.getStoreUrl(),i=encodeURIComponent('Check out "Jira Assistant" in web store'),o=encodeURIComponent(`Check out "Jira Assistant", a open source extension / add-on for your browser from below url:\n\nChrome users: ${ne.GY}?utm_source%3Dgmail#\n\nFirefox users: ${ne.dC}\n\nEdge users: ${ne._Y}\n\nOpera users: ${ne.Uh}\n\nUse Web version: ${ne.V5}\n\nJira Cloud App: ${ne.UZ}\n\nFor source code or to know more about the extension visit: ${ne.Jb}\n\n\nThis would help you to track your worklog and generate reports from Jira easily with lots of customizations. Also has lot more features like Calendar integration, Jira comment & meeting + worklog notifications, Worklog, Sprint and custom report generations, etc..`),a=encodeURIComponent(s);return{ratingUrl:t,gMailShare:`https://mail.google.com/mail/u/0/?view=cm&tf=1&fs=1&su=${i}&body=${o}`,linkedInShare:`https://www.linkedin.com/shareArticle?mini=true&url=${a}&title=${i}&summary=${o}&source=`,facebookShare:`https://www.facebook.com/sharer/sharer.php?u=${a}&title=${i}&description=${o}`,twitterShare:`https://twitter.com/intent/tweet?text=${o}`}}var ge=s(640);const fe=[{videoId:"xNYNXWUgCeA",module:"Dashboard",route:"dashboard"},{videoId:"Ihz4Dm5oiRk",module:"Worklog Timer",route:"~"},{videoId:"hJBM5X24sPQ",module:"Worklog Calendar",route:"calendar"},{videoId:"WQOHrPBZZiI",module:"Worklog report - Sprint wise",route:"reports/worklog"},{videoId:"4hFigSvXatM",module:"Pivot report - Worklog sample",route:"reports/pivot"},{videoId:"TxNH1HQtiX0",module:"Worklog report",route:"userdaywise"},{videoId:"6hAOtUm1lUk",module:"Worklog import",route:"import/worklog"},{videoId:"EFgXFqrGuTI",module:"Issue import",route:"import/issue"},{videoId:"HMyBkaZ09Xw",module:"Report builder",route:"advanced"}],xe=[{startAt:713,videoId:"f2aBSXzbYuA",module:"Custom report",route:"customgrouped"},{startAt:1069,videoId:"f2aBSXzbYuA",module:"Settings",route:"settings"},{startAt:1147,videoId:"f2aBSXzbYuA",module:"Feedback",route:"feedback"}];class ve extends ge.A{constructor(e){super(e),this.playPrev=()=>{let{index:e}=this.state;e-=1;const t=this.getVideoUrl(this.videoList[e],"Video view previous");this.setState({url:t,index:e})},this.playNext=()=>{let{index:e}=this.state;e+=1;const t=this.getVideoUrl(this.videoList[e],"Video view next");this.setState({url:t,index:e})},this.style={width:"87vw",height:"95vh"},this.className="video-help",this.videoList=[...fe],this.setVideoUrl()}setVideoUrl(){const e=this.props.location.pathname.substring(2);let t=fe.first(t=>~e.indexOf(t.route));t||(t=xe.first(t=>~e.indexOf(t.route)),t||(t=xe[0]),this.videoList.push(t)),this.state.url=this.getVideoUrl(t),this.state.index=this.videoList.indexOf(t)}getVideoUrl(e,t){return this.$analytics.trackEvent(t||"Video help viewed",he.hB.HeaderActions,`Video Help: ${e.module}`),`https://www.youtube.com/embed/${e.videoId}?rel=0&autoplay=1&showinfo=0&cc_load_policy=1&start=${e.startAt||0}`}render(){const{url:e,index:t}=this.state;return super.renderBase((0,A.jsxs)("div",{className:"video-help",children:[t>0&&(0,A.jsx)("div",{className:"nav-icon left",onClick:this.playPrev,children:(0,A.jsx)("span",{className:"fa fa-angle-left",title:"Play previous video"})}),(0,A.jsx)("iframe",{src:e,id:"ifVideoHelp",title:"Video Help",style:{width:"87vw",height:"95vh"},frameBorder:0,allowFullScreen:!0}),t+1<this.videoList.length&&(0,A.jsx)("div",{className:"nav-icon right",onClick:this.playNext,children:(0,A.jsx)("span",{className:"fa fa-angle-right",title:"Play next video"})})]}))}}const ye=(0,W.y)(ve),ke="skin-dark";const je=function(){const[e,t]=i.useState(!1);i.useEffect(()=>{!async function(){t(await async function(){const{$settings:e}=(0,r.WQ)("SettingsService","AnalyticsService");return"skin-dark"===await e.get("skin")}())}()},[]);const s=i.useCallback(()=>{t(e=>(function(e){const{$settings:t,$analytics:s}=(0,r.WQ)("SettingsService","AnalyticsService"),i=document.body.classList;i.remove(ke),e&&i.add(ke);t.set("skin",e?ke:""),s.trackEvent("Skin changed",he.hB.HeaderActions,e?"skin-dark":"skin-light")}(!e),!e))},[t]);return e?(0,A.jsx)("li",{className:"nav-item pointer dark-mode",onClick:s,title:"Switch to light theme",children:_.nightLight}):(0,A.jsx)("li",{className:"nav-item pointer light-mode",onClick:s,title:"Switch to dark mode",children:_.brightSun})};var we=s(5006),Se=s(2122);function be({message:e}){return function(e){if(!e||"string"!==typeof e)return e;const t=[];let s=null,i=0;for(;s=Ne.exec(e);){const o=s[0],a=s.index;t.push(e.substring(i,a));const r=o.startsWith("#")?(0,Se.MN)(o):o;t.push((0,A.jsx)(K.A,{href:r,children:o})),i=a+o.length}i<e.length&&t.push(e.substring(i));return t.length?t:e}(e)}const Ce=i.memo(be),Ne=/#\d+|(https?):\/\/(www\.)?[a-z0-9.:].*?(?<!\.\.?)(?=\s|[.]$|$)/g;class Te extends i.PureComponent{constructor(e){super(e),this.setRef=e=>this.op=e,this.readMessage=e=>{let t=e.message,s=null;"versionInfo"===e.type?(s={width:"90vw",maxWidth:"1000px"},t=(0,A.jsx)(ee,{updates:this.state.updates_info})):t=(0,A.jsx)(Ce,{message:t});const i=()=>this.markRead(e,!0);o.A.alert(t,e.title,s).then(i,i)},this.markRead=(e,t)=>{e.read||(!function(e,t){if(!e.read){const{$noti:s}=(0,we.WQ)("NotificationService");e.read=!0,s.markRead(e);!function(e,t){const{$analytics:s}=(0,we.WQ)("AnalyticsService");s.trackEvent(("versionInfo"===e.type?"Update Info: ":"Message: ")+t,"Messages",`Message Id: ${e.id}`)}(e,t?"Viewed":"Mark as read")}}(e,t),this.setState(e=>({unread:(e.unread||1)-1})))},this.viewList=e=>{this.op.show(e),function({total:e,unread:t}){const{$analytics:s}=(0,we.WQ)("AnalyticsService");s.trackEvent("Messages: List viewed","Messages",`Messages: Total: ${e}, Unread: ${t}`)}(this.state)},(0,we.WQ)(this,"NotificationService","AnalyticsService","UserUtilsService","UtilsService");const{updates_info:t,list:s,total:i,unread:a}=e.notifications;this.state={updates_info:t,list:s,total:i,unread:a}}render(){const{list:e,total:t,unread:s}=this.state;return e&&e.length?(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("li",{className:"nav-item",children:(0,A.jsxs)("span",{className:"notification-icon pointer",title:"Announcement / updates from developer",onClick:this.viewList,children:[_.announcement,s>0&&(0,A.jsx)("span",{className:"badge bg-danger",children:s})]})}),(0,A.jsx)(ce.j,{ref:this.setRef,className:"notification-op drop-op",children:(0,A.jsxs)("div",{className:"message-container drop-op-container",children:[(0,A.jsx)("div",{className:"title text-center",children:(0,A.jsxs)("strong",{children:["You have ",s||t," ",s?"unread":""," messages"]})}),(0,A.jsx)("div",{className:"drop-op-body messages",children:e.map((e,t)=>(0,A.jsx)($e,{message:e,onOpen:this.readMessage,onRead:this.markRead,cut:this.$utils.cut},t))})]})})]}):null}}const De=Te;function $e({message:e,onOpen:t,onRead:s,cut:o}){const a=i.useCallback(()=>t(e),[e,t]),r=i.useCallback(()=>s(e),[e,s]);return(0,A.jsxs)("div",{className:"message",title:"Click to view this message",children:[!e.read&&(0,A.jsx)("small",{className:"float-end mt-0",onClick:r,title:"Click to mark this message as read",children:(0,A.jsx)("span",{className:"fa fa-eye mark-read"})}),(0,A.jsxs)("div",{className:"message-title text-truncate"+(e.read?"":" fw-bold"),onClick:a,children:[e.important&&(0,A.jsx)("span",{className:"fa fa-exclamation text-danger"})," ",e.title]}),(0,A.jsx)("div",{className:"small text-muted message-text",onClick:a,children:(0,A.jsx)(Ce,{message:o(e.message,175,!0)})})]})}var We=s(6904);const Ae=function(){const e=i.useRef(),[t,s]=i.useState({}),{list:o,total:a,ticketCount:r}=t,n=i.useCallback(t=>{e.current.show(t),function(e){const{$analytics:t}=(0,we.WQ)("AnalyticsService");t.trackEvent("Jira Updates: List viewed","Updates",`Updates: Total: ${e}`)}(a)},[e,a]),{$utils:l}=(0,we.WQ)("UtilsService");return i.useEffect(()=>{(async function(){const{$jupdates:e}=(0,we.WQ)("JiraUpdatesService");return await e.getRescentUpdates()})().then(s)},[]),o&&o.length?(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("li",{className:"nav-item",children:[(0,A.jsx)("span",{className:"drop-icon",onClick:n,title:"Notification updates from Jira",children:_.bellNotification}),a>0&&(0,A.jsx)("span",{className:"badge bg-warning text-dark",children:a>99?"99+":a})]}),(0,A.jsx)(ce.j,{ref:e,className:"drop-op",children:(0,A.jsxs)("div",{className:"jira-notifications drop-op-container",children:[(0,A.jsx)("div",{className:"title text-center",children:(0,A.jsxs)("strong",{children:["You have ",a," updates on ",r," issues"]})}),(0,A.jsx)("div",{className:"drop-op-body noti-messages",children:o.map((e,t)=>(0,A.jsx)(Ue,{message:e,cut:l.cut},t))})]})})]}):null};function Ue({message:e,cut:t}){return(0,A.jsxs)(u.N_,{className:"drop-item",title:"Click to view this ticket in jira",href:e.href,children:[(0,A.jsxs)("div",{className:"text-truncate fw-bold",title:e.summary,children:[e.key," - ",t(e.summary,100,!0)]}),e.updates.map(({date:e,author:t,field:s,fromString:i,toString:o},a)=>(0,A.jsxs)("div",{className:"small text-muted message-text",children:[(0,A.jsx)(We.YP,{tag:"span",className:"user-display",user:t}),(0,A.jsxs)("span",{children:[" updated ",s," from ",i," to ",o," "]}),(0,A.jsx)(We.Hl,{tag:"span",className:"date-display",date:e,quick:!0})]},a))]})}const Le=c.zM?{btnText:"Extn",btnTooltip:"Go back to extension",launchText:"Launch Extension",switchText:"Switch back",launchTooltip:"Launch Jira Assistant extension once",switchTooltip:"Switch back to Jira Assistant extension"}:{btnText:"Web",btnTooltip:"Checkout Jira Assistant Web",launchText:"Launch JA Web",switchText:"Switch to JA Web",launchTooltip:"Launch latest Jira Assistant Web version once",switchTooltip:"Switch to Web version. You can come back later any time."};class Ie extends i.PureComponent{constructor(e){super(e),this.switchToWeb=async e=>{!1!==e&&await this.$settings.set("useWebVersion",!c.zM||null),window.location.href=this.getLaunchPath()},this.showMenus=e=>{const t=[{label:"Use Jira Assistant Web",items:[{label:Le.launchText,icon:"fa fa-external-link",command:()=>this.switchToWeb(!1)},{label:Le.switchText,icon:"fa fa-plug",command:this.switchToWeb}]}];(0,n.O0)(e,t)},this.state={switched:!1},(0,r.WQ)(this,"SettingsService","AppBrowserService")}async componentDidMount(){if(this.usingExtn=c.zM&&"1"===localStorage.getItem("authType"),c.zM){const e=await this.$jaBrowserExtn.getLaunchUrl("index.html");this.setState({launchUrl:e})}else this.setState({launchUrl:ne.S1});const e=await this.$settings.get("useWebVersion");this.setState({switched:e})}getLaunchPath(){const e=this.props.location.pathname;return`${this.state.launchUrl}#${e}`}showOptions(){const{switched:e,launchUrl:t}=this.state;return!!t&&(c.eD||this.usingExtn&&e)}render(){return this.showOptions()?(0,A.jsx)("li",{className:"nav-item",children:(0,A.jsx)(u.$n,{type:"success",className:"web-try",icon:"fa fa-external-link",title:Le.btnTooltip,onClick:this.showMenus,label:Le.btnText})}):null}}const Me=(0,W.y)(Ie);var Re=s(6631),Ee=s(8922),Fe=s(1427);class Pe extends ge.A{constructor(e){super(e,"Export Settings"),this.setValue=(e,t,s)=>{let{settings:i}=this.state;i={...i};const o={...i[s.id]};e?o[t]=e:delete o[t],Object.keys(o).length?i[s.id]=o:delete i[s.id];const a=Object.keys(i).length>0;this.setState({settings:i,hasSelection:a})},this.export=async()=>{const{settings:e,exportAll:t}=this.state,s=await this.$backup.exportBackup(t||e),i=(0,Ee.cR)(s),o=`JA_Backup_${(new Date).format("yyyyMMdd")}.jab`;(0,l.RG)(i,"jab",o),this.$analytics.trackEvent("Settings exported",he.hB.UserActions),this.onHide()},this.toggleAll=e=>this.setState({exportAll:e}),(0,r.WQ)(this,"UserService","BackupService"),this.state.settings={},this.state.exportAll=!0,this.init()}async init(){const e=await this.$user.getAllUsers();this.setState({users:e})}getFooter(){const{hasSelection:e,exportAll:t}=this.state;return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(u.Sc,{checked:t,onChange:this.toggleAll,label:"Export all settings",className:"float-start"}),(0,A.jsx)(u.$n,{text:!0,icon:"fa fa-times",label:"Cancel",onClick:this.onHide}),(0,A.jsx)(u.$n,{type:"primary",icon:"fa fa-download",label:"Export",onClick:this.export,disabled:!t&&!e})]})}render(){const{users:e,settings:t,exportAll:s}=this.state;return e?super.renderBase((0,A.jsxs)(Fe.ew,{children:[(0,A.jsx)(Fe.D1,{children:(0,A.jsxs)(Fe.lO,{children:[(0,A.jsx)("th",{children:"Instance"}),(0,A.jsx)("th",{children:"Reports"}),(0,A.jsx)("th",{children:"User Groups"}),(0,A.jsx)("th",{children:"Settings"})]})}),(0,A.jsx)(Fe.vc,{children:e.map((e,i)=>{var o,a,r;return(0,A.jsxs)(Fe.lO,{children:[(0,A.jsx)("td",{children:e.id===R.gq?"General":e.jiraUrl}),(0,A.jsx)("td",{children:e.id>R.gq&&(0,A.jsx)(u.Sc,{checked:s||(null===(o=t[e.id])||void 0===o?void 0:o.reports)||!1,field:"reports",args:e,onChange:this.setValue,disabled:s})}),(0,A.jsx)("td",{children:e.id>R.gq&&(0,A.jsx)(u.Sc,{checked:s||(null===(a=t[e.id])||void 0===a?void 0:a.groups)||!1,field:"groups",args:e,onChange:this.setValue,disabled:s||e.id===R.gq})}),(0,A.jsx)("td",{children:(0,A.jsx)(u.Sc,{checked:s||(null===(r=t[e.id])||void 0===r?void 0:r.settings)||!1,field:"settings",args:e,onChange:this.setValue,disabled:s})})]},i)})})]})):super.renderBase((0,A.jsx)("span",{children:"Loading..."}))}}const Be=Pe;const Ve=function({onLogout:e}){const t=i.useRef(),[s,o]=i.useState([]);i.useEffect(()=>{(async function(){const{$session:e,$user:t}=(0,we.WQ)("SessionService","UserService"),s=e.CurrentUser.userId,i=await t.getUsersList();return i.filter(e=>e.id!==s)})().then(o)},[]);const[a,r]=i.useState(!1),n=i.useCallback(()=>r(!0),[r]),l=i.useCallback(()=>r(!1),[r]),d=i.useMemo(Oe,[]),{name:c,instanceUrl:h,imageUrl:u}=d,p=i.useCallback(e=>{t.current.show(e)},[]);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("li",{className:"user-box",children:(0,A.jsxs)("button",{className:"box",onClick:p,children:[(0,A.jsxs)("div",{className:"profile-info",children:[(0,A.jsx)("span",{className:"name",children:c}),(0,A.jsx)("span",{className:"role",children:h})]}),(0,A.jsx)("figure",{className:"profile-picture",children:(0,A.jsx)("img",{src:u,alt:c,className:"rounded-circle"})})]})}),a&&(0,A.jsx)(Be,{onDone:l,onHide:l}),(0,A.jsx)(ce.j,{ref:t,className:"user-options",children:(0,A.jsx)(Re.A,{children:t=>(0,A.jsx)(Ge,{users:s,user:d,showSettings:n,importSettings:t,onLogout:e})})})]})};function Ge({user:e,users:t,showSettings:s,importSettings:o,onLogout:a}){const r=i.useContext(d.BR),n=i.useCallback(e=>{const t=parseInt(e.currentTarget.attributes["data-user-id"].value);r.switchUser(t);const{$analytics:s}=(0,we.WQ)("AnalyticsService");s.trackEvent("Instance switched",he.hB.Instance)},[r]),{name:h,instanceUrl:p,image_x48:m,imageUrl:g,profileUrl:f}=e;return(0,A.jsxs)("div",{className:"options-container",children:[(0,A.jsxs)("div",{className:"option-block blue-bg",children:[(0,A.jsx)("div",{className:"title",children:"Account"}),(0,A.jsx)("div",{className:"user-box",children:(0,A.jsxs)("span",{className:"box",children:[(0,A.jsxs)("div",{className:"profile-info",children:[(0,A.jsx)("span",{className:"name",children:h}),(0,A.jsx)("span",{className:"role",children:p})]}),(0,A.jsx)("figure",{className:"profile-picture",children:(0,A.jsx)("img",{src:m||g,alt:h,className:"rounded-circle"})})]})}),(0,A.jsxs)(u.N_,{href:f,className:"menu",children:[(0,A.jsx)("span",{className:"icon fa fa-user"}),(0,A.jsx)("span",{className:"text",children:"View Jira profile"})]})]}),(0,A.jsxs)("div",{className:"option-block",children:[(0,A.jsx)("div",{className:"title",children:"Switch Instance"}),t&&t.length>0&&t.map(e=>(0,A.jsxs)("button",{className:"menu","data-user-id":e.id,onClick:n,title:e.email,children:[(0,A.jsx)("span",{className:"icon fa fa-external-link"}),(0,A.jsxs)("span",{className:"text",children:[(0,l.UW)(e.jiraUrl)," (",e.userId,")"]})]},e.id)),(0,A.jsxs)("a",{className:"menu",href:c.zM?"/integrate":"/index.html#/integrate",children:[(0,A.jsx)("span",{className:"icon fa fa-plug"}),(0,A.jsx)("span",{className:"text",children:"Integrate with new instance"})]})]}),(0,A.jsxs)("div",{className:"option-block",children:[(0,A.jsx)("div",{className:"title",children:"Settings"}),(0,A.jsxs)("button",{className:"menu",onClick:o,children:[(0,A.jsx)("span",{className:"icon fa fa-upload"}),(0,A.jsx)("span",{className:"text",children:"Import Settings"})]}),(0,A.jsxs)("button",{className:"menu",onClick:s,children:[(0,A.jsx)("span",{className:"icon fa fa-download"}),(0,A.jsx)("span",{className:"text",children:"Export Settings"})]})]}),(0,A.jsx)("div",{className:"option-block",children:(0,A.jsxs)("button",{className:"menu",onClick:a,children:[(0,A.jsx)("span",{className:"icon fa fa-lock"}),(0,A.jsx)("span",{children:"Logout"})]})})]})}function Oe(){const{$session:e,$userutils:t,$utils:s}=(0,we.WQ)("SessionService","UserUtilsService","UtilsService"),i=e.CurrentUser,{jiraUrl:o,jiraUser:{displayName:a,emailAddress:r,key:n,avatarUrls:d}={}}=i,c=t.getProfileUrl();return{name:s.cut(a,27),instanceUrl:s.cut((0,l.UW)(o),32),login:n,emailAddress:r,profileUrl:c,imageUrl:(d||{})["24x24"],image_x48:(d||{})["48x48"]}}const He=!1!==p.A.features.header.shareWithOthers,ze=!1!==p.A.features.common.allowWebVersion,Je=!1!==p.A.features.header.youtubeHelp,_e=!1!==p.A.modules.contactUs;const Qe=function(e){const{showYoutubeVideo:t,notifications:s,showVersionInfo:i,disableJiraUpdates:o,disableNotification:a,showYoutubeHelp:r,userId:n,hideYoutube:l,onLogout:d,isQuickView:u}=e,{version:p,isBeta:m}=(null===s||void 0===s?void 0:s.updatesAvailable)||{};return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("ul",{className:"navbar-nav",style:{marginLeft:"auto"},children:[ze&&!c.A$&&!u&&(0,A.jsx)(Me,{}),!!p&&(0,A.jsxs)("span",{className:"update-available badge p-1 px-2 pointer bg-"+(m?"warning text-dark":"success"),title:`Jira Assist ${m?"BETA ":""}v${p} is now available. Click to know more.`,onClick:i,children:[(0,A.jsx)("i",{className:"fa fa-download"})," Updates available"]}),!o&&(0,A.jsx)(Ae,{}),!a&&s&&(0,A.jsx)(De,{notifications:s}),Je&&(0,A.jsx)("li",{className:"nav-item d-md-down-none",children:(0,A.jsx)("span",{className:"nav-link pointer",onClick:r,title:"Click to watch YouTube help video for current page",children:_.youtube})}),(0,A.jsx)(je,{}),He&&(0,A.jsx)(pe,{}),_e&&(0,A.jsx)("li",{className:"nav-item d-md-down-none",children:(0,A.jsx)(h.k2,{to:`/${n}/contact-us`,className:"nav-link",children:(0,A.jsx)("i",{className:"fa fa-phone",title:"Contact us"})})}),!u&&!c.mx&&(0,A.jsx)(Ve,{onLogout:d})]}),Je&&t&&(0,A.jsx)(ye,{onHide:l})]})},Ye=!!p.A.modules.contribute;class qe extends i.PureComponent{constructor(e){var t,s,i,a;super(e),this.showYoutubeHelp=()=>this.setState({showYoutubeVideo:!0}),this.hideYoutube=()=>this.setState({showYoutubeVideo:!1}),this.showVersionInfo=e=>{var t;e.preventDefault();const s=null===(t=this.state.notifications)||void 0===t?void 0:t.updates_info;s&&o.A.alert((0,A.jsx)(ee,{updates:s}),"Updates info",{width:"90vw",maxWidth:"1000px"},{acceptLabel:"Close"}).then()},(0,r.WQ)(this,"AppBrowserService","SessionService","NotificationService","AnalyticsService","SettingsService");const n=this.$session.CurrentUser;this.disableNotification=!(null!==(t=p.A.features)&&void 0!==t&&null!==(s=t.header)&&void 0!==s&&s.devUpdates)||n.disableDevNotification,this.disableJiraUpdates=!1===(null===(i=p.A.features)||void 0===i||null===(a=i.header)||void 0===a?void 0:a.jiraUpdates)||n.disableJiraUpdates,this.userId=n.userId,this.currentJiraInstance=(0,l.UW)(n.jiraUrl),this.state={},this.versionNumber=c.zM?"WEB":`v ${R.z2}`}componentDidMount(){this.disableNotification||this.$noti.getNotifications().then(e=>this.setState({notifications:e}),e=>{console.error("Error fetching notifications: ",e)}),this.$session.CurrentUser.hideDonateMenu&&document.body.classList.add("no-donation"),this.validateTimezone()}async validateTimezone(){if(await this.$settings.getSetting(this.userId,he.wh.General,"ignoreTimezone"))return;const e=re().tz.guess(!0),t=this.$session.CurrentUser.jiraUser.timeZone,s=re().utc(),i=re().tz.zone(e).offset(s),a=re().tz.zone(t).offset(s),r=e=>{const t=e>0;return(e=Math.abs(e))?`GMT ${t?"-":"+"} ${e=parseFloat((e/60).toFixed(2))} hours`:"GMT"};if(i!==a){const s=(e,t)=>(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(u.$n,{type:"danger",icon:"fa fa-times",label:"Ok, Do not check again",onClick:e,waitFor:5}),(0,A.jsx)(u.$n,{type:"primary",icon:"fa fa-check",label:"Ok, I will update Jira profile",onClick:t})]});o.A.custom((0,A.jsxs)("span",{children:["Your system timezone mismatches with Jira profile timezone. This would cause differences in date or time while worklog is being pulled. Ensure you update your Jira profile to match with your local timezone. ",(0,A.jsx)("br",{}),(0,A.jsx)("br",{}),(0,A.jsxs)("strong",{children:["Jira Profile Timezone: ",t," (",r(a),")",(0,A.jsx)("br",{}),"Your System Timezone: ",e," (",r(i),")"]}),(0,A.jsx)("br",{}),(0,A.jsx)("br",{}),"Any worklogs you already added directly from within Jira would continue to remain same and new worklogs would start using new timezone.",(0,A.jsx)("br",{}),(0,A.jsx)("br",{})]}),"Timezone mismatch",s,{maxWidth:"80vw",width:"700px"},"dlgTimezoneDiff").then(()=>this.$settings.saveSetting(this.userId,he.wh.General,"ignoreTimezone",!0))}}render(){const{state:{showYoutubeVideo:e,notifications:t}}=this;return(0,A.jsxs)("header",{className:"app-header navbar",children:[(0,A.jsx)(de,{showVersionInfo:this.showVersionInfo,versionNumber:this.versionNumber}),Ye&&(0,A.jsx)(h.k2,{to:`/${this.userId}/contribute`,className:"btn-donate",title:"Would you like to contribute / compensate us for the effort we put in development of this tool? Click to know more",children:(0,A.jsx)("img",{src:"/assets/donate.png",width:"145",className:"margin-r-5",alt:"Donate us"})}),(0,A.jsx)(ie,{}),(0,A.jsx)(Qe,{showYoutubeVideo:e,notifications:t,onLogout:this.props.onLogout,currentJiraInstance:this.currentJiraInstance,showVersionInfo:this.showVersionInfo,disableJiraUpdates:this.disableJiraUpdates,disableNotification:this.disableNotification,showYoutubeHelp:this.showYoutubeHelp,userId:this.userId,hideYoutube:this.hideYoutube,isQuickView:this.props.isQuickView})]})}}const Ze=qe;class Ke extends i.PureComponent{constructor(){super(),this.loadTracker=()=>this.$wltimer.getCurrentTimer().then(e=>{var t;const s=null===(t=this.state.timerEntry)||void 0===t?void 0:t.key;this.setTimer(e,s&&s!==(null===e||void 0===e?void 0:e.key))}),this.loading=()=>(0,A.jsx)("div",{className:"animated fadeIn pt-1 text-center",children:"Loading..."}),this.signOut=e=>{e.preventDefault(),this.$cache.clear(),this.$settings.set("CurrentUserId"),c.zM?(0,c.Tp)():this.props.navigate("/integrate")},this.setTimer=(e,t=!1)=>{this.worklogContextProps={...this.worklogContextProps,needReload:t,timerEntry:e},this.setState({timerEntry:e})},this.worklogContextProps={getElapsedTimeInSecs:()=>{const{timerEntry:e}=this.state;if(!e)return null;const{key:t,started:s,lapse:i,description:o}=e,a=(new Date).getTime();if(s>=a)return this.$message.error("System time has changed since timer has started. Please stop and restart the timer.","Time mismatch"),{key:t,lapse:0,description:o,isRunning:!1,hasError:!0};const r=(s>0?a-s:0)+(i||0);return{key:t,lapse:Math.round(r/1e3),description:o,isRunning:s>0}},setUpdates:this.setTimer,startTimer:async(e,t)=>{t||(t=this.$session.userId);try{var s;let r=await this.$wltimer.startTimer(t,e);var i,a;if(null!==(s=r)&&void 0!==s&&s.isActive)o.A.yesNo((0,A.jsxs)(A.Fragment,{children:['Already timer is running for "',null===(i=r)||void 0===i||null===(a=i.entry)||void 0===a?void 0:a.key,'".',(0,A.jsx)("br",{}),(0,A.jsx)("br",{}),"Would you like to stop it and start new timer?"]}),"Timer running").then(async()=>{r=await this.$wltimer.startTimer(t,e,null,!0),this.setTimer(r,!0)});else this.setTimer(r)}catch(r){this.$message.error(r.message)}},resumeTimer:async()=>this.setTimer(await this.$wltimer.resumeTimer()),pauseTimer:async()=>this.setTimer(await this.$wltimer.pauseTimer()),stopTimer:async()=>this.setTimer(!await this.$wltimer.stopTimer(),!0)},(0,r.WQ)(this,"DashboardService","SessionService","SettingsService","CacheService","WorklogTimerService","MessageService","AppBrowserService");const{userId:e}=this.$session;this.state={menus:this.getMenus(e),userId:e},document.location.href.indexOf("?quick=true")>-1&&(this.$session.isQuickView=!0,this.isQuickView=!0)}componentDidMount(){const{userId:e}=this.state;(0,l.Yz)(this.$session.CurrentUser.startOfWeek),this.$jaBrowserExtn.connectAndKeepAlive(this.loadTracker),this.loadTracker(),window.addEventListener("focus",this.loadTracker),this.$dashboard.onChange(()=>this.setState({menus:this.getMenus(e)})),this.initBody()}async initBody(){const e=document.body.classList;this.$session.isQuickView&&e.add("quick-view");const t=await this.$settings.get("skin",!0)||"skin-blue";e.add(t)}componentWillUnmount(){this.$dashboard.onChange(()=>{}),window.removeEventListener("focus",this.loadTracker)}getMenus(e){const t=a.A.map(t=>{const{items:s,...i}=t;return i.items=s.map(t=>{const s={...t};return s.external||(s.url=`/${e}${s.url}`),s}),i}),s=this.$dashboard.getDashboards();return null!==s&&void 0!==s&&s.length&&t[0].items.splice(0,1,...s.map((t,s)=>(0,a.m)(t,s,e))),t}render(){const{menus:e}=this.state;return(0,A.jsx)(d._m,{value:this.worklogContextProps,children:(0,A.jsxs)("div",{className:"app",children:[(0,A.jsx)(Ze,{onLogout:this.signOut,isQuickView:this.isQuickView}),(0,A.jsxs)("div",{className:"app-body",children:[!this.isQuickView&&(0,A.jsx)(Z,{onLogout:this.signOut,menus:e,navigate:this.props.navigate,location:this.props.location}),(0,A.jsx)(L,{loader:this.loading})]}),(0,A.jsx)(n.tz,{})]})})}}const Xe=(0,W.y)(Ke)},7426:(e,t,s)=>{s.d(t,{Ay:()=>j,IJ:()=>v,v8:()=>p.v});var i=s(9950),o=s(8670),a=s(4967),r=s(8981),n=s(6778),l=s(8738),d=s.n(l),c=s(530),h=s(4353),u=s(374),p=s(2285),m=s(5006),g=s(4922),f=s(5620),x=(s(4432),s(4414));const v=new r.EventEmitter;let y=0;class k extends i.PureComponent{constructor(e,t){super(e),this.eventReceived=e=>this.executeEvent(e),this.toggleFullScreen=()=>{let{isFullScreen:e}=this.state;e=!e,this.$analytics.trackEvent("Toggle full screen",g.hB.GadgetActions,this.title,e),e?document.body.classList.add("fs-layout"):document.body.classList.remove("fs-layout"),this.columnResizeMode=e?"fit":"expand",this.setState({isFullScreen:e})},this.addWorklogOn=e=>{this.addWorklog({ticketNo:e})},this.removeGadget=()=>{this.$analytics.trackEvent("Gadget removed",g.hB.GadgetActions,this.title),this.performAction(p.v.RemoveGadget)},this.setLoader=e=>this.setState({isLoading:e}),this.exportData=e=>{const t=new h.L;t.fileName=this.title,t.format=e||this.exportFormat,t.element=this.el,this.$analytics.trackEvent("Export data",g.hB.GadgetActions,t.format),t.export()},this.showGadgetContextMenu=e=>(0,c.O0)(e,this.getContextMenu()),this.getHeader=()=>{const{title:e,subTitle:t,isGadget:s,props:{draggableHandle:i}}=this,o="gadget-header"+(i?" movable":"");return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{ref:i,className:o,onContextMenu:s?this.showGadgetContextMenu:null,onDoubleClick:this.toggleFullScreen,children:[e," ",t&&(0,x.jsxs)("span",{children:[" - ",t]}),(0,x.jsxs)("div",{className:"float-end",children:[this.getTooltipElement(),this.renderCustomActions&&this.renderCustomActions(s),!this.hideRefresh&&this.getRefreshButton(),!this.hideMenu&&(0,x.jsx)(n.$n,{text:!0,icon:"fa fa-wrench",onClick:e=>(0,c.O0)(e,this.getContextMenu())})]})]}),(0,x.jsx)("div",{className:"clearfix"})]})},this.setRef=e=>{this.el=e;const{dropProps:{dropRef:t}={}}=this.props;t&&t(e)},(0,m.WQ)(this,"AnalyticsService"),this.instanceId=++y,this.title=t,this.isGadget=!1!==e.isGadget,this.settings=e.settings||{fullWidth:!1,fullHeight:!1};const{fullWidth:s=!1,fullHeight:i=!1}=this.settings;this.state={fullWidth:s,fullHeight:i}}getContextMenu(){const{isFullScreen:e,fullWidth:t,fullHeight:s}=this.state,i=this.isGadget?[{separator:!0},{label:"Full width",icon:`fa fa-${t?"check-":""}circle fs-16 margin-r-5`,command:()=>this.setSizeOptions(!t,s)},{label:"Full height",icon:`fa fa-${s?"check-":""}circle fs-16 margin-r-5`,command:()=>this.setSizeOptions(t,!s)},{separator:!0},{label:"Remove",icon:"fa fa-remove",command:()=>this.removeGadget()}]:[],o=[];return this.hideExport||(o.push({separator:!0}),this.hideCSVExport||o.push({label:"Export to CSV",icon:"fa fa-file-text",disabled:!this.exportData,command:()=>this.exportData(u.A.CSV)}),this.hideXLSXExport||o.push({label:"Export to Excel",icon:"fa fa-file-excel",disabled:!this.exportData,command:()=>this.exportData(u.A.XLSX)}),this.hidePDFExport||o.push({label:"Export to PDF",icon:"fa fa-file-pdf",disabled:!this.exportData,command:()=>this.exportData(u.A.PDF)})),[{label:"Toggle full screen",icon:"fa fa-"+(e?"compress":"expand"),command:()=>this.toggleFullScreen()},...o,...i]}componentDidMount(){this.isGadget&&(v.on("change",this.eventReceived),this.$analytics.trackEvent("Gadget loaded",g.hB.GadgetActions,this.title)),this._isMounted=!0}componentWillUnmount(){v.off("change",this.eventReceived)}setSizeOptions(e,t){const{settings:s}=this;s.fullWidth=e,s.fullHeight=t,this.setState({fullWidth:e,fullHeight:t}),this.saveSettings()}UNSAFE_componentWillReceiveProps(e){if(this.settings!==e.settings){this.settings=e.settings||{};const{fullWidth:t,fullHeight:s}=this.settings;this.setState({fullWidth:t,fullHeight:s})}}performAction(e,t){const{onAction:s}=this.props;s&&s({type:e,data:t},this.props.model,this.props.index)}addWorklog(e){this.performAction(p.v.AddWorklog,e)}editWorklog(e){this.performAction(p.v.AddWorklog,{id:e})}saveSettings(){this.performAction(p.v.SettingsChanged,this.settings)}executeEvent(e){}getFullScreenButton(){if(this.isGadget)return null;const{state:{isFullScreen:e}}=this;return(0,x.jsx)(n.$n,{text:!0,icon:e?"fa fa-compress":"fa fa-expand",onClick:this.toggleFullScreen,title:"Toggle full screen"})}getRefreshButton(e){const{disableRefresh:t,isLoading:s}=this.state;return(0,x.jsx)(n.$n,{text:!0,icon:"fa fa-refresh",disabled:t||s,onClick:e||this.refreshData,title:"Refresh data"})}getTooltipElement(){return this.getHint?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(a.m,{target:`.icon-hint-${this.instanceId}`,children:this.getHint()}),(0,x.jsx)("i",{className:`fa fa-info-circle icon-hint icon-hint-${this.instanceId}`,"data-pr-position":"bottom"})]}):null}renderBase(e){const{fullWidth:t,fullHeight:s,isLoading:i,isFullScreen:a}=this.state,{isGadget:r,props:{tabLayout:l,gadgetType:c}}=this;if(l)return(0,x.jsxs)(x.Fragment,{children:[e,this.renderFooter&&this.renderFooter()]});const h=t||!r,u=s||!r,p=d()("gadget",this.className,{docked:!r,"full-width":h&&!a,"full-height":u&&!a,"half-width":!h&&!a,"half-height":!u&&!a,"full-screen":a});return(0,x.jsxs)("div",{ref:this.setRef,className:p,"data-test-id":c,children:[i&&(0,x.jsx)(n.aH,{}),(0,x.jsxs)(o.Z,{header:this.getHeader(),children:[e,this.renderFooter&&this.renderFooter()]})]})}render(){return(0,x.jsx)("div",{ref:this.setRef,className:"gadget half-width half-height",children:(0,x.jsx)(o.Z,{header:"Gadget Unavailable",children:(0,x.jsxs)("div",{className:"pad-22",children:["This section contains an un-known gadget.",f.eD&&"You could have added a new Gadget from Web version which is not yet available in extension. ",f.eD&&"If not, please report about this issue to have it fixed!",!f.eD&&"Please report about this issue to have it fixed!"]})})})}}const j=k},7630:(e,t,s)=>{s.r(t),s.d(t,{default:()=>b});var i=s(9950),o=s(1427),a=s(9051),r=s.n(a),n=s(5006),l=s(4922),d=s(6778),c=s(1219),h=s(5674),u=s(4414);class p extends i.PureComponent{constructor(e){super(e),this.timeZoneChanged=e=>{const{user:t}=this.props;t.timeZone=e,this.setState({timeZone:e})},this.costChanged=e=>{const{user:t}=this.props;t.costPerHour=e||0,this.setState({costPerHour:e})},this.onRemove=()=>{this.props.onRemove(this.props.index)},(0,n.WQ)(this,"UserUtilsService");const{user:{timeZone:t,costPerHour:s=0}}=e;this.state={timeZone:t||"",costPerHour:s}}render(){const{timeZoneChanged:e,costChanged:t,onRemove:s,props:{user:i,userTimezones:o}}=this,a=!1!==i.active;return(0,u.jsxs)("tr",{title:!a&&"User is inactive",children:[(0,u.jsx)("td",{children:(0,u.jsxs)("div",{className:"group-user",children:[(0,u.jsx)("img",{src:i.avatarUrls["32x32"]||i.avatarUrls["48x48"],alt:"",height:32,width:32,className:"float-start"}),(0,u.jsx)(h.A,{href:this.$userutils.getProfileUrl(i),className:a?"link":"link strike-out",children:i.displayName})]})}),(0,u.jsx)("td",{children:i.emailAddress}),(0,u.jsx)("td",{children:(0,c.J3)(i)}),(0,u.jsx)("td",{children:(0,u.jsx)(d.aL,{dataset:o,value:i.timeZone,displayField:"label",valueField:"value",onChange:e,className:"width-perc-100",filter:!0})}),(0,u.jsx)("td",{children:(0,u.jsx)(d.fI,{value:i.costPerHour,onChange:t,keyfilter:"num"})}),(0,u.jsx)("td",{children:(0,u.jsx)(d.$n,{type:"danger",icon:"fa fa-times",onClick:s,style:{marginTop:0}})})]})}}const m=p;class g extends i.PureComponent{constructor(e){super(e),this.setEditMode=e=>this.setState({editMode:e,groupName:this.props.group.name}),this.beginEdit=()=>this.setEditMode(!0),this.endEdit=()=>this.setEditMode(!1),this.setGroupName=e=>this.setState({groupName:e}),this.updateGroupName=()=>{const{props:{group:e,hasGroupWithName:t}}=this;let{groupName:s}=this.state;s=s.trim(),t(s,e)?this.$message.warning(`The group with the name '${s}' already exists!`,"Group already exists"):(this.props.group.name=s,this.endEdit())},(0,n.WQ)(this,"MessageService"),this.state={editMode:!1}}render(){const{endEdit:e,setGroupName:t,updateGroupName:s,state:{editMode:i,groupName:o},props:{group:a}}=this;let{beginEdit:r}=this;return a.isJiraGroup&&(r=void 0),i?(0,u.jsxs)("div",{className:"ui-inputgroup",children:[(0,u.jsx)(d.fI,{value:o,maxLength:40,onChange:t}),(0,u.jsx)(d.$n,{type:"success",icon:"fa fa-check",onClick:s}),(0,u.jsx)(d.$n,{type:"danger",icon:"fa fa-undo",onClick:e})]}):(0,u.jsxs)("div",{onClick:r,children:[(0,u.jsxs)("span",{style:{fontWeight:600,fontSize:17},children:[a.name," "]}),"(",a.users.length," users) ",!a.isJiraGroup&&(0,u.jsx)("i",{className:"fa fa-edit"})]})}}const f=g;class x extends i.PureComponent{constructor(e){super(e),this.usersSelected=e=>this.setState({selectedUsers:e,users:this.props.group.users}),this.clearSelection=()=>this.usersSelected([]),this.searchUsers=e=>this.$jira.searchUsers(e),this.removeUser=e=>{const{group:t}=this.props;let{users:s}=t;s.splice(e,1),s=[...s],t.users=s,this.setState({users:s})},this.usernameEntered=e=>{let{selectedUsers:t}=this.state;t&&e&&!t.some(t=>(0,c.J3)(t,!0)===e.toLowerCase())&&this.$jira.getUserDetails(e).then(e=>{t=[...t],t.push(e),this.setState({selectedUsers:t})},()=>{})},this.onRemove=()=>{this.props.onRemove(this.props.index)},this.setTimezone=e=>{this.props.group.timeZone=e,this.setState({timeZone:e})},(0,n.WQ)(this,"JiraService");const{group:{users:t=[],timeZone:s}}=e;this.usersFromProps=t,this.state={selectedUsers:[],users:t,timeZone:s||""}}UNSAFE_componentWillReceiveProps(e){var t;const s=null===(t=e.group)||void 0===t?void 0:t.users;s&&this.usersFromProps!==s&&(this.setState({users:s}),this.usersFromProps=s)}addUsersToGroup(){const{props:{group:e},state:{selectedUsers:t}}=this,{users:s}=e,i=s.map(e=>(0,c.J3)(e,!0));t.removeAll(e=>i.indexOf((0,c.J3)(e,!0))>-1),t.forEach(e=>{const{accountId:t,avatarUrls:i,displayName:o,emailAddress:a,timeZone:r,locale:n,name:l}=e;s.push({accountId:t,avatarUrls:i,displayName:o,emailAddress:a,timeZone:r,locale:n,name:l})}),e.users=s.orderBy(e=>e.displayName),this.clearSelection()}render(){const{onRemove:e,setTimezone:t,props:{group:s,groupTimezones:i,userTimezones:o,hasGroupWithName:a},state:{selectedUsers:r,users:n,timeZone:l}}=this;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{children:(0,u.jsx)(f,{group:s,hasGroupWithName:a})}),!s.isJiraGroup&&(0,u.jsxs)("td",{colSpan:2,children:[(0,u.jsx)(d.j9,{value:r,onChange:this.usersSelected,displayField:"displayName",multiple:!0,minLength:2,forceselection:!0,placeholder:"Add one or more users",onCustomValue:this.usernameEntered,dataset:this.searchUsers,style:{width:"80%"}}),(0,u.jsx)(d.$n,{type:"danger",icon:"fa fa-close",onClick:this.clearSelection}),(0,u.jsx)(d.$n,{type:"success",icon:"fa fa-user-plus",onClick:()=>this.addUsersToGroup(s)})]}),!!s.isJiraGroup&&(0,u.jsx)("td",{colSpan:2,children:"(Users pulled from Jira)"}),(0,u.jsx)("td",{children:(0,u.jsx)(d.aL,{dataset:i,displayField:"label",valueField:"value",value:l||"",onChange:t,className:"width-perc-100",filter:!0})}),(0,u.jsx)("td",{}),(0,u.jsx)("td",{children:(0,u.jsx)(d.$n,{type:"danger",icon:"fa fa-trash",label:s.isJiraGroup?"Remove Group":"Delete group",onClick:e})})]}),(!n||0===n.length)&&(0,u.jsx)("tr",{children:(0,u.jsx)("td",{colSpan:5,children:"No users were available under this group"})}),n&&n.map((e,t)=>(0,u.jsx)(m,{user:e,index:t,userTimezones:o,onRemove:this.removeUser},(0,c.J3)(e)))]})}}const v=x;class y extends i.PureComponent{constructor(e){super(e),this.addNewGroup=()=>{this.props.addNewGroup(this.state.groupName,this.state.isJiraGroup&&this.state.groupId)&&this.endAdd()},this.setGroupName=e=>this.setState({groupName:e}),this.setAddMode=e=>this.setState({editMode:e,groupName:""}),this.beginAdd=()=>this.setAddMode(!0),this.endAdd=()=>this.setAddMode(!1),this.toggleJiraGroup=e=>this.setState({isJiraGroup:e,groupId:null,groupName:""}),this.searchGroups=e=>this.$jira.searchGroups(e),this.groupSelected=e=>{const{groupId:t,name:s}=e||{};t&&this.setState({groupId:t,groupName:s})},(0,n.WQ)(this,"JiraService"),this.state={}}render(){const{endAdd:e,addNewGroup:t,setGroupName:s,toggleJiraGroup:i,props:{isPlugged:o,saveGroups:a,onDone:r,onReset:n},state:{editMode:l,groupName:c,isJiraGroup:h}}=this;return(0,u.jsx)("tfoot",{children:(0,u.jsx)("tr",{children:(0,u.jsx)("td",{colSpan:6,children:(0,u.jsxs)("div",{style:{height:30,paddingTop:4},children:[(0,u.jsxs)("div",{className:"float-start",children:[(0,u.jsxs)("div",{className:"ui-inputgroup",hidden:l,children:[(0,u.jsx)(d.$n,{text:!0,type:"success",icon:"fa fa-plus",label:"Add group",onClick:this.beginAdd}),o&&(0,u.jsx)("span",{className:"link margin-l-5 pad-b-5 inline-block",onClick:n,title:"Click to clear local changes and pull data from user groups",children:"Reset local changes"})]}),(0,u.jsxs)("div",{className:"ui-inputgroup",hidden:!l,children:[(0,u.jsx)(d.Sc,{checked:h,onChange:i,label:"Add Jira Group"}),h?(0,u.jsx)(d.j9,{value:c,onChange:this.groupSelected,displayField:"name",multiple:!1,minLength:2,forceselection:!0,placeholder:"Select Jira Group",dataset:this.searchGroups,style:{width:"185px"}}):(0,u.jsx)(d.fI,{value:c,onChange:s,maxLength:40,placeholder:"Name of new group",onKey_Enter:t}),(0,u.jsx)(d.$n,{text:!0,type:"success",icon:"fa fa-check",disabled:!c,onClick:t}),(0,u.jsx)(d.$n,{text:!0,type:"danger",icon:"fa fa-close",onClick:e})]})]}),(0,u.jsxs)("div",{className:"float-end",children:[o&&(0,u.jsxs)("span",{className:"margin-r-8",children:[(0,u.jsx)("strong",{children:"Note:"})," To permanently save the changes, go to Settings -> User groups from menu."]}),!o&&(0,u.jsx)(d.$n,{type:"primary",icon:"fa fa-save",label:"Save Changes",onClick:a}),o&&(0,u.jsx)(d.$n,{type:"primary",icon:"fa fa-save",label:"Apply for now (not saved)",onClick:r})]})]})})})})}}const k=y;var j=s(6631),w=s(8922);class S extends i.PureComponent{constructor(e){super(e),this.loadGroups=async()=>{const e=await this.$usergroup.getUserGroups();this.setState({groups:e})},this.addNewGroup=async(e,t)=>{var s;if(!(e=null===(s=e)||void 0===s?void 0:s.trim()))return;const{groups:i}=this.state;if(this.hasGroupWithName(e))return this.$message.warning(`The group with the name '${e}' already exists!`,"Group already exists"),!1;{const s={name:e,timeZone:"",users:[],isJiraGroup:!!t,id:t};if(s.isJiraGroup)try{await this.$usergroup.fillJiraGroupMembers([s])}catch(r){if(console.error("Error fetching user list from group:",r),403===r.status)this.$message.error("You do not have required privilege to pull user list from group","Unauthorized Access");else{var o,a;const e=(null===(o=r.error)||void 0===o||null===(a=o.errorMessages)||void 0===a?void 0:a[0])||"Unable to pull user list from group. Look at console log for more details";this.$message.error(e,"Unknown error")}return}else delete s.isJiraGroup,delete s.id;return this.setState({groups:i.concat(s)}),!0}},this.hasGroupWithName=(e,t)=>(e=e.toLowerCase(),this.state.groups.some(s=>s.name.toLowerCase()===e&&s!==t)),this.deleteGroup=e=>{let{groups:t}=this.state;t.splice(e,1),t=[...t],this.setState({groups:t})},this.saveGroups=()=>{this.setState({saveInProg:!0}),this.$usergroup.saveUserGroups(this.state.groups).then(e=>{this.setState({saveInProg:!1}),this.$analytics.trackEvent("User groups saved",l.hB.UserActions),this.$message.success("Changes saved successfully!","Group saved")})},this.done=()=>{this.props.onDone&&(this.$analytics.trackEvent("User groups modified",l.hB.UserActions),this.props.onDone(this.state.groups))},this.exportGroups=async()=>{try{const e=await this.$backup.exportBackup({[this.$session.userId]:{groups:!0}}),t=(0,w.cR)(e),s=`JA_Groups_${(new Date).format("yyyyMMdd")}.jab`;(0,c.RG)(t,"jab",s),this.$analytics.trackEvent("Groups exported",l.hB.UserActions)}catch(e){this.$message.error(e.message)}},(0,n.WQ)(this,"SessionService","MessageService","UserGroupService","JiraService","AnalyticsService","BackupService");const{groups:t}=e,s=r().tz.names().map(e=>({label:e,value:e}));this.groupTimezones=[{label:"My local time zone",value:""}].union([s]),this.userTimezones=[{label:"My local time zone",value:""},{label:"Use group's time zone",value:"GRP_TZ"}].union([s]),this.state={groups:t}}componentDidMount(){this.state.groups||this.loadGroups()}render(){const{userTimezones:e,props:{isPlugged:t},state:{groups:s}}=this;return(0,u.jsxs)(o.ew,{dataset:s,children:[!t&&(0,u.jsxs)("caption",{children:["User groups",(0,u.jsxs)("div",{className:"float-end",children:[(0,u.jsx)(d.$n,{text:!0,icon:"fa fa-download",title:"Click to export groups list",onClick:this.exportGroups}),(0,u.jsx)(j.A,{onImport:this.loadGroups,children:e=>(0,u.jsx)(d.$n,{text:!0,icon:"fa fa-upload",title:"Click to import groups list",onClick:e})})]})]}),(0,u.jsx)(o.D1,{children:(0,u.jsxs)("tr",{children:[(0,u.jsx)("th",{style:{minWidth:215},children:"Group / User Name"}),(0,u.jsx)("th",{children:"User Email"}),(0,u.jsx)("th",{children:"User Login"}),(0,u.jsx)("th",{children:"Timezone"}),(0,u.jsx)("th",{children:"Cost per hour"}),(0,u.jsx)("th",{style:{width:150},children:"Options"})]})}),(0,u.jsx)(o.vc,{children:(t,s)=>(0,u.jsx)(v,{group:t,index:s,hasGroupWithName:this.hasGroupWithName,groupTimezones:this.groupTimezones,userTimezones:e,onRemove:this.deleteGroup},t.name)}),(0,u.jsx)(o.QC,{span:5,children:"No groups available"}),(0,u.jsx)(k,{isPlugged:t,saveGroups:this.saveGroups,onDone:this.done,addNewGroup:this.addNewGroup,onReset:this.loadGroups})]})}}const b=S},8855:(e,t,s)=>{s.d(t,{A:()=>r});var i=s(9950),o=s(6778),a=s(4414);const r=function({jql:e,field:t,plugged:s,onChange:r}){const[n,l]=i.useState(e||"");i.useEffect(()=>{l(e||"")},[e]);const d=i.useCallback(e=>l(e),[l]),[c,h]=i.useState(!s),u=i.useCallback(()=>h(!0),[h]);return(0,a.jsxs)("div",{className:"jql-editor"+(s?" plugged":""),children:[c&&(0,a.jsx)(o.fI,{className:"jql-query",multiline:!0,autoFocus:!0,placeholder:"JQL query to fetch data",value:n,onChange:s?d:r}),!c&&!!e&&(0,a.jsx)("div",{className:"jql-query-text",onClick:u,children:e}),!c&&!e&&(0,a.jsx)("span",{className:"jql-query-text unavailable",onClick:u,children:"Provide JQL query text here"}),s&&c&&(0,a.jsx)(o.$n,{icon:"fa fa-check",onClick:()=>{r(null===n||void 0===n?void 0:n.trim(),t),l(null===n||void 0===n?void 0:n.trim()),h(!1)}}),s&&c&&(0,a.jsx)(o.$n,{icon:"fa fa-times",onClick:()=>{l(e||""),h(!1)}})]})}},8957:(e,t,s)=>{s.d(t,{A:()=>r});var i=s(9950),o=s(4414);class a extends i.PureComponent{render(){const{tag:e="td",tagProps:t,className:s,settings:i,count:a}=this.props,r=!!a&&!(null===i||void 0===i||!i.showGroupCount)&&(0,o.jsxs)("span",{className:"badge bg-info margin-l-5",title:`Total issues in group: ${a}`,children:["(",a,")"]});return null===e?this.renderControl(r):(0,o.jsx)(e,{className:s,...t,children:this.renderControl(r)})}}const r=a}}]);